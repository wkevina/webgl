!function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:n})},r.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},r.t=function(t,e){if(1&e&&(t=r(t)),8&e)return t;if(4&e&&"object"==typeof t&&t&&t.__esModule)return t;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:t}),2&e&&"string"!=typeof t)for(var i in t)r.d(n,i,function(e){return t[e]}.bind(null,i));return n},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=261)}([,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.registerContext=function(t){e.gl=n=t},e.gl=void 0;var n={};e.gl=n},function(t,e,r){"use strict";r.r(e);var n={};r.r(n),r.d(n,"EPSILON",function(){return f}),r.d(n,"ARRAY_TYPE",function(){return _}),r.d(n,"RANDOM",function(){return p}),r.d(n,"setMatrixArrayType",function(){return d}),r.d(n,"toRadian",function(){return v}),r.d(n,"equals",function(){return b});var i={};r.r(i),r.d(i,"create",function(){return g}),r.d(i,"clone",function(){return x}),r.d(i,"copy",function(){return A}),r.d(i,"identity",function(){return w}),r.d(i,"fromValues",function(){return B}),r.d(i,"set",function(){return E}),r.d(i,"transpose",function(){return M}),r.d(i,"invert",function(){return S}),r.d(i,"adjoint",function(){return T}),r.d(i,"determinant",function(){return I}),r.d(i,"multiply",function(){return P}),r.d(i,"rotate",function(){return C}),r.d(i,"scale",function(){return R}),r.d(i,"fromRotation",function(){return F}),r.d(i,"fromScaling",function(){return D}),r.d(i,"str",function(){return L}),r.d(i,"frob",function(){return O}),r.d(i,"LDU",function(){return k}),r.d(i,"add",function(){return U}),r.d(i,"subtract",function(){return z}),r.d(i,"exactEquals",function(){return j}),r.d(i,"equals",function(){return V}),r.d(i,"multiplyScalar",function(){return N}),r.d(i,"multiplyScalarAndAdd",function(){return q}),r.d(i,"mul",function(){return G}),r.d(i,"sub",function(){return W});var o={};r.r(o),r.d(o,"create",function(){return Y}),r.d(o,"clone",function(){return X}),r.d(o,"copy",function(){return K}),r.d(o,"identity",function(){return H}),r.d(o,"fromValues",function(){return J}),r.d(o,"set",function(){return Z}),r.d(o,"invert",function(){return Q}),r.d(o,"determinant",function(){return $}),r.d(o,"multiply",function(){return tt}),r.d(o,"rotate",function(){return et}),r.d(o,"scale",function(){return rt}),r.d(o,"translate",function(){return nt}),r.d(o,"fromRotation",function(){return it}),r.d(o,"fromScaling",function(){return ot}),r.d(o,"fromTranslation",function(){return st}),r.d(o,"str",function(){return at}),r.d(o,"frob",function(){return ut}),r.d(o,"add",function(){return ct}),r.d(o,"subtract",function(){return lt}),r.d(o,"multiplyScalar",function(){return mt}),r.d(o,"multiplyScalarAndAdd",function(){return ht}),r.d(o,"exactEquals",function(){return ft}),r.d(o,"equals",function(){return _t}),r.d(o,"mul",function(){return pt}),r.d(o,"sub",function(){return dt});var s={};r.r(s),r.d(s,"create",function(){return yt}),r.d(s,"fromMat4",function(){return vt}),r.d(s,"clone",function(){return bt}),r.d(s,"copy",function(){return gt}),r.d(s,"fromValues",function(){return xt}),r.d(s,"set",function(){return At}),r.d(s,"identity",function(){return wt}),r.d(s,"transpose",function(){return Bt}),r.d(s,"invert",function(){return Et}),r.d(s,"adjoint",function(){return Mt}),r.d(s,"determinant",function(){return St}),r.d(s,"multiply",function(){return Tt}),r.d(s,"translate",function(){return It}),r.d(s,"rotate",function(){return Pt}),r.d(s,"scale",function(){return Ct}),r.d(s,"fromTranslation",function(){return Rt}),r.d(s,"fromRotation",function(){return Ft}),r.d(s,"fromScaling",function(){return Dt}),r.d(s,"fromMat2d",function(){return Lt}),r.d(s,"fromQuat",function(){return Ot}),r.d(s,"normalFromMat4",function(){return kt}),r.d(s,"projection",function(){return Ut}),r.d(s,"str",function(){return zt}),r.d(s,"frob",function(){return jt}),r.d(s,"add",function(){return Vt}),r.d(s,"subtract",function(){return Nt}),r.d(s,"multiplyScalar",function(){return qt}),r.d(s,"multiplyScalarAndAdd",function(){return Gt}),r.d(s,"exactEquals",function(){return Wt}),r.d(s,"equals",function(){return Yt}),r.d(s,"mul",function(){return Xt}),r.d(s,"sub",function(){return Kt});var a={};r.r(a),r.d(a,"create",function(){return Ht}),r.d(a,"clone",function(){return Jt}),r.d(a,"copy",function(){return Zt}),r.d(a,"fromValues",function(){return Qt}),r.d(a,"set",function(){return $t}),r.d(a,"identity",function(){return te}),r.d(a,"transpose",function(){return ee}),r.d(a,"invert",function(){return re}),r.d(a,"adjoint",function(){return ne}),r.d(a,"determinant",function(){return ie}),r.d(a,"multiply",function(){return oe}),r.d(a,"translate",function(){return se}),r.d(a,"scale",function(){return ae}),r.d(a,"rotate",function(){return ue}),r.d(a,"rotateX",function(){return ce}),r.d(a,"rotateY",function(){return le}),r.d(a,"rotateZ",function(){return me}),r.d(a,"fromTranslation",function(){return he}),r.d(a,"fromScaling",function(){return fe}),r.d(a,"fromRotation",function(){return _e}),r.d(a,"fromXRotation",function(){return pe}),r.d(a,"fromYRotation",function(){return de}),r.d(a,"fromZRotation",function(){return ye}),r.d(a,"fromRotationTranslation",function(){return ve}),r.d(a,"fromQuat2",function(){return be}),r.d(a,"getTranslation",function(){return ge}),r.d(a,"getScaling",function(){return xe}),r.d(a,"getRotation",function(){return Ae}),r.d(a,"fromRotationTranslationScale",function(){return we}),r.d(a,"fromRotationTranslationScaleOrigin",function(){return Be}),r.d(a,"fromQuat",function(){return Ee}),r.d(a,"frustum",function(){return Me}),r.d(a,"perspective",function(){return Se}),r.d(a,"perspectiveFromFieldOfView",function(){return Te}),r.d(a,"ortho",function(){return Ie}),r.d(a,"lookAt",function(){return Pe}),r.d(a,"targetTo",function(){return Ce}),r.d(a,"str",function(){return Re}),r.d(a,"frob",function(){return Fe}),r.d(a,"add",function(){return De}),r.d(a,"subtract",function(){return Le}),r.d(a,"multiplyScalar",function(){return Oe}),r.d(a,"multiplyScalarAndAdd",function(){return ke}),r.d(a,"exactEquals",function(){return Ue}),r.d(a,"equals",function(){return ze}),r.d(a,"mul",function(){return je}),r.d(a,"sub",function(){return Ve});var u={};r.r(u),r.d(u,"create",function(){return Ne}),r.d(u,"clone",function(){return qe}),r.d(u,"length",function(){return Ge}),r.d(u,"fromValues",function(){return We}),r.d(u,"copy",function(){return Ye}),r.d(u,"set",function(){return Xe}),r.d(u,"add",function(){return Ke}),r.d(u,"subtract",function(){return He}),r.d(u,"multiply",function(){return Je}),r.d(u,"divide",function(){return Ze}),r.d(u,"ceil",function(){return Qe}),r.d(u,"floor",function(){return $e}),r.d(u,"min",function(){return tr}),r.d(u,"max",function(){return er}),r.d(u,"round",function(){return rr}),r.d(u,"scale",function(){return nr}),r.d(u,"scaleAndAdd",function(){return ir}),r.d(u,"distance",function(){return or}),r.d(u,"squaredDistance",function(){return sr}),r.d(u,"squaredLength",function(){return ar}),r.d(u,"negate",function(){return ur}),r.d(u,"inverse",function(){return cr}),r.d(u,"normalize",function(){return lr}),r.d(u,"dot",function(){return mr}),r.d(u,"cross",function(){return hr}),r.d(u,"lerp",function(){return fr}),r.d(u,"hermite",function(){return _r}),r.d(u,"bezier",function(){return pr}),r.d(u,"random",function(){return dr}),r.d(u,"transformMat4",function(){return yr}),r.d(u,"transformMat3",function(){return vr}),r.d(u,"transformQuat",function(){return br}),r.d(u,"rotateX",function(){return gr}),r.d(u,"rotateY",function(){return xr}),r.d(u,"rotateZ",function(){return Ar}),r.d(u,"angle",function(){return wr}),r.d(u,"str",function(){return Br}),r.d(u,"exactEquals",function(){return Er}),r.d(u,"equals",function(){return Mr}),r.d(u,"sub",function(){return Sr}),r.d(u,"mul",function(){return Tr}),r.d(u,"div",function(){return Ir}),r.d(u,"dist",function(){return Pr}),r.d(u,"sqrDist",function(){return Cr}),r.d(u,"len",function(){return Rr}),r.d(u,"sqrLen",function(){return Fr}),r.d(u,"forEach",function(){return Dr});var c={};r.r(c),r.d(c,"create",function(){return Lr}),r.d(c,"clone",function(){return Or}),r.d(c,"fromValues",function(){return kr}),r.d(c,"copy",function(){return Ur}),r.d(c,"set",function(){return zr}),r.d(c,"add",function(){return jr}),r.d(c,"subtract",function(){return Vr}),r.d(c,"multiply",function(){return Nr}),r.d(c,"divide",function(){return qr}),r.d(c,"ceil",function(){return Gr}),r.d(c,"floor",function(){return Wr}),r.d(c,"min",function(){return Yr}),r.d(c,"max",function(){return Xr}),r.d(c,"round",function(){return Kr}),r.d(c,"scale",function(){return Hr}),r.d(c,"scaleAndAdd",function(){return Jr}),r.d(c,"distance",function(){return Zr}),r.d(c,"squaredDistance",function(){return Qr}),r.d(c,"length",function(){return $r}),r.d(c,"squaredLength",function(){return tn}),r.d(c,"negate",function(){return en}),r.d(c,"inverse",function(){return rn}),r.d(c,"normalize",function(){return nn}),r.d(c,"dot",function(){return on}),r.d(c,"lerp",function(){return sn}),r.d(c,"random",function(){return an}),r.d(c,"transformMat4",function(){return un}),r.d(c,"transformQuat",function(){return cn}),r.d(c,"str",function(){return ln}),r.d(c,"exactEquals",function(){return mn}),r.d(c,"equals",function(){return hn}),r.d(c,"sub",function(){return fn}),r.d(c,"mul",function(){return _n}),r.d(c,"div",function(){return pn}),r.d(c,"dist",function(){return dn}),r.d(c,"sqrDist",function(){return yn}),r.d(c,"len",function(){return vn}),r.d(c,"sqrLen",function(){return bn}),r.d(c,"forEach",function(){return gn});var l={};r.r(l),r.d(l,"create",function(){return xn}),r.d(l,"identity",function(){return An}),r.d(l,"setAxisAngle",function(){return wn}),r.d(l,"getAxisAngle",function(){return Bn}),r.d(l,"multiply",function(){return En}),r.d(l,"rotateX",function(){return Mn}),r.d(l,"rotateY",function(){return Sn}),r.d(l,"rotateZ",function(){return Tn}),r.d(l,"calculateW",function(){return In}),r.d(l,"slerp",function(){return Pn}),r.d(l,"invert",function(){return Cn}),r.d(l,"conjugate",function(){return Rn}),r.d(l,"fromMat3",function(){return Fn}),r.d(l,"fromEuler",function(){return Dn}),r.d(l,"str",function(){return Ln}),r.d(l,"clone",function(){return On}),r.d(l,"fromValues",function(){return kn}),r.d(l,"copy",function(){return Un}),r.d(l,"set",function(){return zn}),r.d(l,"add",function(){return jn}),r.d(l,"mul",function(){return Vn}),r.d(l,"scale",function(){return Nn}),r.d(l,"dot",function(){return qn}),r.d(l,"lerp",function(){return Gn}),r.d(l,"length",function(){return Wn}),r.d(l,"len",function(){return Yn}),r.d(l,"squaredLength",function(){return Xn}),r.d(l,"sqrLen",function(){return Kn}),r.d(l,"normalize",function(){return Hn}),r.d(l,"exactEquals",function(){return Jn}),r.d(l,"equals",function(){return Zn}),r.d(l,"rotationTo",function(){return Qn}),r.d(l,"sqlerp",function(){return $n}),r.d(l,"setAxes",function(){return ti});var m={};r.r(m),r.d(m,"create",function(){return ei}),r.d(m,"clone",function(){return ri}),r.d(m,"fromValues",function(){return ni}),r.d(m,"fromRotationTranslationValues",function(){return ii}),r.d(m,"fromRotationTranslation",function(){return oi}),r.d(m,"fromTranslation",function(){return si}),r.d(m,"fromRotation",function(){return ai}),r.d(m,"fromMat4",function(){return ui}),r.d(m,"copy",function(){return ci}),r.d(m,"identity",function(){return li}),r.d(m,"set",function(){return mi}),r.d(m,"getReal",function(){return hi}),r.d(m,"getDual",function(){return fi}),r.d(m,"setReal",function(){return _i}),r.d(m,"setDual",function(){return pi}),r.d(m,"getTranslation",function(){return di}),r.d(m,"translate",function(){return yi}),r.d(m,"rotateX",function(){return vi}),r.d(m,"rotateY",function(){return bi}),r.d(m,"rotateZ",function(){return gi}),r.d(m,"rotateByQuatAppend",function(){return xi}),r.d(m,"rotateByQuatPrepend",function(){return Ai}),r.d(m,"rotateAroundAxis",function(){return wi}),r.d(m,"add",function(){return Bi}),r.d(m,"multiply",function(){return Ei}),r.d(m,"mul",function(){return Mi}),r.d(m,"scale",function(){return Si}),r.d(m,"dot",function(){return Ti}),r.d(m,"lerp",function(){return Ii}),r.d(m,"invert",function(){return Pi}),r.d(m,"conjugate",function(){return Ci}),r.d(m,"length",function(){return Ri}),r.d(m,"len",function(){return Fi}),r.d(m,"squaredLength",function(){return Di}),r.d(m,"sqrLen",function(){return Li}),r.d(m,"normalize",function(){return Oi}),r.d(m,"str",function(){return ki}),r.d(m,"exactEquals",function(){return Ui}),r.d(m,"equals",function(){return zi});var h={};r.r(h),r.d(h,"create",function(){return ji}),r.d(h,"clone",function(){return Vi}),r.d(h,"fromValues",function(){return Ni}),r.d(h,"copy",function(){return qi}),r.d(h,"set",function(){return Gi}),r.d(h,"add",function(){return Wi}),r.d(h,"subtract",function(){return Yi}),r.d(h,"multiply",function(){return Xi}),r.d(h,"divide",function(){return Ki}),r.d(h,"ceil",function(){return Hi}),r.d(h,"floor",function(){return Ji}),r.d(h,"min",function(){return Zi}),r.d(h,"max",function(){return Qi}),r.d(h,"round",function(){return $i}),r.d(h,"scale",function(){return to}),r.d(h,"scaleAndAdd",function(){return eo}),r.d(h,"distance",function(){return ro}),r.d(h,"squaredDistance",function(){return no}),r.d(h,"length",function(){return io}),r.d(h,"squaredLength",function(){return oo}),r.d(h,"negate",function(){return so}),r.d(h,"inverse",function(){return ao}),r.d(h,"normalize",function(){return uo}),r.d(h,"dot",function(){return co}),r.d(h,"cross",function(){return lo}),r.d(h,"lerp",function(){return mo}),r.d(h,"random",function(){return ho}),r.d(h,"transformMat2",function(){return fo}),r.d(h,"transformMat2d",function(){return _o}),r.d(h,"transformMat3",function(){return po}),r.d(h,"transformMat4",function(){return yo}),r.d(h,"rotate",function(){return vo}),r.d(h,"angle",function(){return bo}),r.d(h,"str",function(){return go}),r.d(h,"exactEquals",function(){return xo}),r.d(h,"equals",function(){return Ao}),r.d(h,"len",function(){return wo}),r.d(h,"sub",function(){return Bo}),r.d(h,"mul",function(){return Eo}),r.d(h,"div",function(){return Mo}),r.d(h,"dist",function(){return So}),r.d(h,"sqrDist",function(){return To}),r.d(h,"sqrLen",function(){return Io}),r.d(h,"forEach",function(){return Po});const f=1e-6;let _="undefined"!=typeof Float32Array?Float32Array:Array;const p=Math.random;function d(t){_=t}const y=Math.PI/180;function v(t){return t*y}function b(t,e){return Math.abs(t-e)<=f*Math.max(1,Math.abs(t),Math.abs(e))}function g(){let t=new _(4);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function x(t){let e=new _(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function A(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function w(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t}function B(t,e,r,n){let i=new _(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function E(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function M(t,e){if(t===e){let r=e[1];t[1]=e[2],t[2]=r}else t[0]=e[0],t[1]=e[2],t[2]=e[1],t[3]=e[3];return t}function S(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=r*o-i*n;return s?(s=1/s,t[0]=o*s,t[1]=-n*s,t[2]=-i*s,t[3]=r*s,t):null}function T(t,e){let r=e[0];return t[0]=e[3],t[1]=-e[1],t[2]=-e[2],t[3]=r,t}function I(t){return t[0]*t[3]-t[2]*t[1]}function P(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*a+o*u,t[1]=i*a+s*u,t[2]=n*c+o*l,t[3]=i*c+s*l,t}function C(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=n*u+o*a,t[1]=i*u+s*a,t[2]=n*-a+o*u,t[3]=i*-a+s*u,t}function R(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=r[0],u=r[1];return t[0]=n*a,t[1]=i*a,t[2]=o*u,t[3]=s*u,t}function F(t,e){let r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t}function D(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t}function L(t){return"mat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function O(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2))}function k(t,e,r,n){return t[2]=n[2]/n[0],r[0]=n[0],r[1]=n[1],r[3]=n[3]-t[2]*r[1],[t,e,r]}function U(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function z(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function j(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function V(t,e){let r=t[0],n=t[1],i=t[2],o=t[3],s=e[0],a=e[1],u=e[2],c=e[3];return Math.abs(r-s)<=f*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-a)<=f*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=f*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=f*Math.max(1,Math.abs(o),Math.abs(c))}function N(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function q(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}const G=P,W=z;function Y(){let t=new _(6);return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function X(t){let e=new _(6);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e}function K(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t}function H(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t}function J(t,e,r,n,i,o){let s=new _(6);return s[0]=t,s[1]=e,s[2]=r,s[3]=n,s[4]=i,s[5]=o,s}function Z(t,e,r,n,i,o,s){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=s,t}function Q(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=r*o-n*i;return u?(u=1/u,t[0]=o*u,t[1]=-n*u,t[2]=-i*u,t[3]=r*u,t[4]=(i*a-o*s)*u,t[5]=(n*s-r*a)*u,t):null}function $(t){return t[0]*t[3]-t[1]*t[2]}function tt(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=r[0],l=r[1],m=r[2],h=r[3],f=r[4],_=r[5];return t[0]=n*c+o*l,t[1]=i*c+s*l,t[2]=n*m+o*h,t[3]=i*m+s*h,t[4]=n*f+o*_+a,t[5]=i*f+s*_+u,t}function et(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=Math.sin(r),l=Math.cos(r);return t[0]=n*l+o*c,t[1]=i*l+s*c,t[2]=n*-c+o*l,t[3]=i*-c+s*l,t[4]=a,t[5]=u,t}function rt(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=r[0],l=r[1];return t[0]=n*c,t[1]=i*c,t[2]=o*l,t[3]=s*l,t[4]=a,t[5]=u,t}function nt(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=r[0],l=r[1];return t[0]=n,t[1]=i,t[2]=o,t[3]=s,t[4]=n*c+o*l+a,t[5]=i*c+s*l+u,t}function it(t,e){let r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=-r,t[3]=n,t[4]=0,t[5]=0,t}function ot(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=e[1],t[4]=0,t[5]=0,t}function st(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=1,t[4]=e[0],t[5]=e[1],t}function at(t){return"mat2d("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+")"}function ut(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+1)}function ct(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t}function lt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t}function mt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t}function ht(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t}function ft(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]}function _t(t,e){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=e[0],c=e[1],l=e[2],m=e[3],h=e[4],_=e[5];return Math.abs(r-u)<=f*Math.max(1,Math.abs(r),Math.abs(u))&&Math.abs(n-c)<=f*Math.max(1,Math.abs(n),Math.abs(c))&&Math.abs(i-l)<=f*Math.max(1,Math.abs(i),Math.abs(l))&&Math.abs(o-m)<=f*Math.max(1,Math.abs(o),Math.abs(m))&&Math.abs(s-h)<=f*Math.max(1,Math.abs(s),Math.abs(h))&&Math.abs(a-_)<=f*Math.max(1,Math.abs(a),Math.abs(_))}const pt=tt,dt=lt;function yt(){let t=new _(9);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function vt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[4],t[4]=e[5],t[5]=e[6],t[6]=e[8],t[7]=e[9],t[8]=e[10],t}function bt(t){let e=new _(9);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e}function gt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function xt(t,e,r,n,i,o,s,a,u){let c=new _(9);return c[0]=t,c[1]=e,c[2]=r,c[3]=n,c[4]=i,c[5]=o,c[6]=s,c[7]=a,c[8]=u,c}function At(t,e,r,n,i,o,s,a,u,c){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=u,t[8]=c,t}function wt(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Bt(t,e){if(t===e){let r=e[1],n=e[2],i=e[5];t[1]=e[3],t[2]=e[6],t[3]=r,t[5]=e[7],t[6]=n,t[7]=i}else t[0]=e[0],t[1]=e[3],t[2]=e[6],t[3]=e[1],t[4]=e[4],t[5]=e[7],t[6]=e[2],t[7]=e[5],t[8]=e[8];return t}function Et(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],m=l*s-a*c,h=-l*o+a*u,f=c*o-s*u,_=r*m+n*h+i*f;return _?(_=1/_,t[0]=m*_,t[1]=(-l*n+i*c)*_,t[2]=(a*n-i*s)*_,t[3]=h*_,t[4]=(l*r-i*u)*_,t[5]=(-a*r+i*o)*_,t[6]=f*_,t[7]=(-c*r+n*u)*_,t[8]=(s*r-n*o)*_,t):null}function Mt(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8];return t[0]=s*l-a*c,t[1]=i*c-n*l,t[2]=n*a-i*s,t[3]=a*u-o*l,t[4]=r*l-i*u,t[5]=i*o-r*a,t[6]=o*c-s*u,t[7]=n*u-r*c,t[8]=r*s-n*o,t}function St(t){let e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8];return e*(c*o-s*u)+r*(-c*i+s*a)+n*(u*i-o*a)}function Tt(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],m=e[8],h=r[0],f=r[1],_=r[2],p=r[3],d=r[4],y=r[5],v=r[6],b=r[7],g=r[8];return t[0]=h*n+f*s+_*c,t[1]=h*i+f*a+_*l,t[2]=h*o+f*u+_*m,t[3]=p*n+d*s+y*c,t[4]=p*i+d*a+y*l,t[5]=p*o+d*u+y*m,t[6]=v*n+b*s+g*c,t[7]=v*i+b*a+g*l,t[8]=v*o+b*u+g*m,t}function It(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],m=e[8],h=r[0],f=r[1];return t[0]=n,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=h*n+f*s+c,t[7]=h*i+f*a+l,t[8]=h*o+f*u+m,t}function Pt(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],m=e[8],h=Math.sin(r),f=Math.cos(r);return t[0]=f*n+h*s,t[1]=f*i+h*a,t[2]=f*o+h*u,t[3]=f*s-h*n,t[4]=f*a-h*i,t[5]=f*u-h*o,t[6]=c,t[7]=l,t[8]=m,t}function Ct(t,e,r){let n=r[0],i=r[1];return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=i*e[3],t[4]=i*e[4],t[5]=i*e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t}function Rt(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=1,t[5]=0,t[6]=e[0],t[7]=e[1],t[8]=1,t}function Ft(t,e){let r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=-r,t[4]=n,t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Dt(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=e[1],t[5]=0,t[6]=0,t[7]=0,t[8]=1,t}function Lt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=0,t[3]=e[2],t[4]=e[3],t[5]=0,t[6]=e[4],t[7]=e[5],t[8]=1,t}function Ot(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=r+r,a=n+n,u=i+i,c=r*s,l=n*s,m=n*a,h=i*s,f=i*a,_=i*u,p=o*s,d=o*a,y=o*u;return t[0]=1-m-_,t[3]=l-y,t[6]=h+d,t[1]=l+y,t[4]=1-c-_,t[7]=f-p,t[2]=h-d,t[5]=f+p,t[8]=1-c-m,t}function kt(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],m=e[9],h=e[10],f=e[11],_=e[12],p=e[13],d=e[14],y=e[15],v=r*a-n*s,b=r*u-i*s,g=r*c-o*s,x=n*u-i*a,A=n*c-o*a,w=i*c-o*u,B=l*p-m*_,E=l*d-h*_,M=l*y-f*_,S=m*d-h*p,T=m*y-f*p,I=h*y-f*d,P=v*I-b*T+g*S+x*M-A*E+w*B;return P?(P=1/P,t[0]=(a*I-u*T+c*S)*P,t[1]=(u*M-s*I-c*E)*P,t[2]=(s*T-a*M+c*B)*P,t[3]=(i*T-n*I-o*S)*P,t[4]=(r*I-i*M+o*E)*P,t[5]=(n*M-r*T-o*B)*P,t[6]=(p*w-d*A+y*x)*P,t[7]=(d*g-_*w-y*b)*P,t[8]=(_*A-p*g+y*v)*P,t):null}function Ut(t,e,r){return t[0]=2/e,t[1]=0,t[2]=0,t[3]=0,t[4]=-2/r,t[5]=0,t[6]=-1,t[7]=1,t[8]=1,t}function zt(t){return"mat3("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+")"}function jt(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2))}function Vt(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t}function Nt(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t}function qt(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t}function Gt(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t}function Wt(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]}function Yt(t,e){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],m=e[0],h=e[1],_=e[2],p=e[3],d=e[4],y=e[5],v=e[6],b=e[7],g=e[8];return Math.abs(r-m)<=f*Math.max(1,Math.abs(r),Math.abs(m))&&Math.abs(n-h)<=f*Math.max(1,Math.abs(n),Math.abs(h))&&Math.abs(i-_)<=f*Math.max(1,Math.abs(i),Math.abs(_))&&Math.abs(o-p)<=f*Math.max(1,Math.abs(o),Math.abs(p))&&Math.abs(s-d)<=f*Math.max(1,Math.abs(s),Math.abs(d))&&Math.abs(a-y)<=f*Math.max(1,Math.abs(a),Math.abs(y))&&Math.abs(u-v)<=f*Math.max(1,Math.abs(u),Math.abs(v))&&Math.abs(c-b)<=f*Math.max(1,Math.abs(c),Math.abs(b))&&Math.abs(l-g)<=f*Math.max(1,Math.abs(l),Math.abs(g))}const Xt=Tt,Kt=Nt;function Ht(){let t=new _(16);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Jt(t){let e=new _(16);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function Zt(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function Qt(t,e,r,n,i,o,s,a,u,c,l,m,h,f,p,d){let y=new _(16);return y[0]=t,y[1]=e,y[2]=r,y[3]=n,y[4]=i,y[5]=o,y[6]=s,y[7]=a,y[8]=u,y[9]=c,y[10]=l,y[11]=m,y[12]=h,y[13]=f,y[14]=p,y[15]=d,y}function $t(t,e,r,n,i,o,s,a,u,c,l,m,h,f,_,p,d){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=u,t[8]=c,t[9]=l,t[10]=m,t[11]=h,t[12]=f,t[13]=_,t[14]=p,t[15]=d,t}function te(t){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ee(t,e){if(t===e){let r=e[1],n=e[2],i=e[3],o=e[6],s=e[7],a=e[11];t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=r,t[6]=e[9],t[7]=e[13],t[8]=n,t[9]=o,t[11]=e[14],t[12]=i,t[13]=s,t[14]=a}else t[0]=e[0],t[1]=e[4],t[2]=e[8],t[3]=e[12],t[4]=e[1],t[5]=e[5],t[6]=e[9],t[7]=e[13],t[8]=e[2],t[9]=e[6],t[10]=e[10],t[11]=e[14],t[12]=e[3],t[13]=e[7],t[14]=e[11],t[15]=e[15];return t}function re(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],m=e[9],h=e[10],f=e[11],_=e[12],p=e[13],d=e[14],y=e[15],v=r*a-n*s,b=r*u-i*s,g=r*c-o*s,x=n*u-i*a,A=n*c-o*a,w=i*c-o*u,B=l*p-m*_,E=l*d-h*_,M=l*y-f*_,S=m*d-h*p,T=m*y-f*p,I=h*y-f*d,P=v*I-b*T+g*S+x*M-A*E+w*B;return P?(P=1/P,t[0]=(a*I-u*T+c*S)*P,t[1]=(i*T-n*I-o*S)*P,t[2]=(p*w-d*A+y*x)*P,t[3]=(h*A-m*w-f*x)*P,t[4]=(u*M-s*I-c*E)*P,t[5]=(r*I-i*M+o*E)*P,t[6]=(d*g-_*w-y*b)*P,t[7]=(l*w-h*g+f*b)*P,t[8]=(s*T-a*M+c*B)*P,t[9]=(n*M-r*T-o*B)*P,t[10]=(_*A-p*g+y*v)*P,t[11]=(m*g-l*A-f*v)*P,t[12]=(a*E-s*S-u*B)*P,t[13]=(r*S-n*E+i*B)*P,t[14]=(p*b-_*x-d*v)*P,t[15]=(l*x-m*b+h*v)*P,t):null}function ne(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=e[4],a=e[5],u=e[6],c=e[7],l=e[8],m=e[9],h=e[10],f=e[11],_=e[12],p=e[13],d=e[14],y=e[15];return t[0]=a*(h*y-f*d)-m*(u*y-c*d)+p*(u*f-c*h),t[1]=-(n*(h*y-f*d)-m*(i*y-o*d)+p*(i*f-o*h)),t[2]=n*(u*y-c*d)-a*(i*y-o*d)+p*(i*c-o*u),t[3]=-(n*(u*f-c*h)-a*(i*f-o*h)+m*(i*c-o*u)),t[4]=-(s*(h*y-f*d)-l*(u*y-c*d)+_*(u*f-c*h)),t[5]=r*(h*y-f*d)-l*(i*y-o*d)+_*(i*f-o*h),t[6]=-(r*(u*y-c*d)-s*(i*y-o*d)+_*(i*c-o*u)),t[7]=r*(u*f-c*h)-s*(i*f-o*h)+l*(i*c-o*u),t[8]=s*(m*y-f*p)-l*(a*y-c*p)+_*(a*f-c*m),t[9]=-(r*(m*y-f*p)-l*(n*y-o*p)+_*(n*f-o*m)),t[10]=r*(a*y-c*p)-s*(n*y-o*p)+_*(n*c-o*a),t[11]=-(r*(a*f-c*m)-s*(n*f-o*m)+l*(n*c-o*a)),t[12]=-(s*(m*d-h*p)-l*(a*d-u*p)+_*(a*h-u*m)),t[13]=r*(m*d-h*p)-l*(n*d-i*p)+_*(n*h-i*m),t[14]=-(r*(a*d-u*p)-s*(n*d-i*p)+_*(n*u-i*a)),t[15]=r*(a*h-u*m)-s*(n*h-i*m)+l*(n*u-i*a),t}function ie(t){let e=t[0],r=t[1],n=t[2],i=t[3],o=t[4],s=t[5],a=t[6],u=t[7],c=t[8],l=t[9],m=t[10],h=t[11],f=t[12],_=t[13],p=t[14],d=t[15];return(e*s-r*o)*(m*d-h*p)-(e*a-n*o)*(l*d-h*_)+(e*u-i*o)*(l*p-m*_)+(r*a-n*s)*(c*d-h*f)-(r*u-i*s)*(c*p-m*f)+(n*u-i*a)*(c*_-l*f)}function oe(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],m=e[8],h=e[9],f=e[10],_=e[11],p=e[12],d=e[13],y=e[14],v=e[15],b=r[0],g=r[1],x=r[2],A=r[3];return t[0]=b*n+g*a+x*m+A*p,t[1]=b*i+g*u+x*h+A*d,t[2]=b*o+g*c+x*f+A*y,t[3]=b*s+g*l+x*_+A*v,b=r[4],g=r[5],x=r[6],A=r[7],t[4]=b*n+g*a+x*m+A*p,t[5]=b*i+g*u+x*h+A*d,t[6]=b*o+g*c+x*f+A*y,t[7]=b*s+g*l+x*_+A*v,b=r[8],g=r[9],x=r[10],A=r[11],t[8]=b*n+g*a+x*m+A*p,t[9]=b*i+g*u+x*h+A*d,t[10]=b*o+g*c+x*f+A*y,t[11]=b*s+g*l+x*_+A*v,b=r[12],g=r[13],x=r[14],A=r[15],t[12]=b*n+g*a+x*m+A*p,t[13]=b*i+g*u+x*h+A*d,t[14]=b*o+g*c+x*f+A*y,t[15]=b*s+g*l+x*_+A*v,t}function se(t,e,r){let n,i,o,s,a,u,c,l,m,h,f,_,p=r[0],d=r[1],y=r[2];return e===t?(t[12]=e[0]*p+e[4]*d+e[8]*y+e[12],t[13]=e[1]*p+e[5]*d+e[9]*y+e[13],t[14]=e[2]*p+e[6]*d+e[10]*y+e[14],t[15]=e[3]*p+e[7]*d+e[11]*y+e[15]):(n=e[0],i=e[1],o=e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],m=e[8],h=e[9],f=e[10],_=e[11],t[0]=n,t[1]=i,t[2]=o,t[3]=s,t[4]=a,t[5]=u,t[6]=c,t[7]=l,t[8]=m,t[9]=h,t[10]=f,t[11]=_,t[12]=n*p+a*d+m*y+e[12],t[13]=i*p+u*d+h*y+e[13],t[14]=o*p+c*d+f*y+e[14],t[15]=s*p+l*d+_*y+e[15]),t}function ae(t,e,r){let n=r[0],i=r[1],o=r[2];return t[0]=e[0]*n,t[1]=e[1]*n,t[2]=e[2]*n,t[3]=e[3]*n,t[4]=e[4]*i,t[5]=e[5]*i,t[6]=e[6]*i,t[7]=e[7]*i,t[8]=e[8]*o,t[9]=e[9]*o,t[10]=e[10]*o,t[11]=e[11]*o,t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15],t}function ue(t,e,r,n){let i,o,s,a,u,c,l,m,h,_,p,d,y,v,b,g,x,A,w,B,E,M,S,T,I=n[0],P=n[1],C=n[2],R=Math.sqrt(I*I+P*P+C*C);return R<f?null:(I*=R=1/R,P*=R,C*=R,i=Math.sin(r),s=1-(o=Math.cos(r)),a=e[0],u=e[1],c=e[2],l=e[3],m=e[4],h=e[5],_=e[6],p=e[7],d=e[8],y=e[9],v=e[10],b=e[11],g=I*I*s+o,x=P*I*s+C*i,A=C*I*s-P*i,w=I*P*s-C*i,B=P*P*s+o,E=C*P*s+I*i,M=I*C*s+P*i,S=P*C*s-I*i,T=C*C*s+o,t[0]=a*g+m*x+d*A,t[1]=u*g+h*x+y*A,t[2]=c*g+_*x+v*A,t[3]=l*g+p*x+b*A,t[4]=a*w+m*B+d*E,t[5]=u*w+h*B+y*E,t[6]=c*w+_*B+v*E,t[7]=l*w+p*B+b*E,t[8]=a*M+m*S+d*T,t[9]=u*M+h*S+y*T,t[10]=c*M+_*S+v*T,t[11]=l*M+p*S+b*T,e!==t&&(t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t)}function ce(t,e,r){let n=Math.sin(r),i=Math.cos(r),o=e[4],s=e[5],a=e[6],u=e[7],c=e[8],l=e[9],m=e[10],h=e[11];return e!==t&&(t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[4]=o*i+c*n,t[5]=s*i+l*n,t[6]=a*i+m*n,t[7]=u*i+h*n,t[8]=c*i-o*n,t[9]=l*i-s*n,t[10]=m*i-a*n,t[11]=h*i-u*n,t}function le(t,e,r){let n=Math.sin(r),i=Math.cos(r),o=e[0],s=e[1],a=e[2],u=e[3],c=e[8],l=e[9],m=e[10],h=e[11];return e!==t&&(t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i-c*n,t[1]=s*i-l*n,t[2]=a*i-m*n,t[3]=u*i-h*n,t[8]=o*n+c*i,t[9]=s*n+l*i,t[10]=a*n+m*i,t[11]=u*n+h*i,t}function me(t,e,r){let n=Math.sin(r),i=Math.cos(r),o=e[0],s=e[1],a=e[2],u=e[3],c=e[4],l=e[5],m=e[6],h=e[7];return e!==t&&(t[8]=e[8],t[9]=e[9],t[10]=e[10],t[11]=e[11],t[12]=e[12],t[13]=e[13],t[14]=e[14],t[15]=e[15]),t[0]=o*i+c*n,t[1]=s*i+l*n,t[2]=a*i+m*n,t[3]=u*i+h*n,t[4]=c*i-o*n,t[5]=l*i-s*n,t[6]=m*i-a*n,t[7]=h*i-u*n,t}function he(t,e){return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=e[0],t[13]=e[1],t[14]=e[2],t[15]=1,t}function fe(t,e){return t[0]=e[0],t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=e[1],t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=e[2],t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function _e(t,e,r){let n,i,o,s=r[0],a=r[1],u=r[2],c=Math.sqrt(s*s+a*a+u*u);return c<f?null:(s*=c=1/c,a*=c,u*=c,n=Math.sin(e),o=1-(i=Math.cos(e)),t[0]=s*s*o+i,t[1]=a*s*o+u*n,t[2]=u*s*o-a*n,t[3]=0,t[4]=s*a*o-u*n,t[5]=a*a*o+i,t[6]=u*a*o+s*n,t[7]=0,t[8]=s*u*o+a*n,t[9]=a*u*o-s*n,t[10]=u*u*o+i,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t)}function pe(t,e){let r=Math.sin(e),n=Math.cos(e);return t[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=n,t[6]=r,t[7]=0,t[8]=0,t[9]=-r,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function de(t,e){let r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=0,t[2]=-r,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=r,t[9]=0,t[10]=n,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ye(t,e){let r=Math.sin(e),n=Math.cos(e);return t[0]=n,t[1]=r,t[2]=0,t[3]=0,t[4]=-r,t[5]=n,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function ve(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=n+n,u=i+i,c=o+o,l=n*a,m=n*u,h=n*c,f=i*u,_=i*c,p=o*c,d=s*a,y=s*u,v=s*c;return t[0]=1-(f+p),t[1]=m+v,t[2]=h-y,t[3]=0,t[4]=m-v,t[5]=1-(l+p),t[6]=_+d,t[7]=0,t[8]=h+y,t[9]=_-d,t[10]=1-(l+f),t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function be(t,e){let r=new _(3),n=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],m=n*n+i*i+o*o+s*s;return m>0?(r[0]=2*(a*s+l*n+u*o-c*i)/m,r[1]=2*(u*s+l*i+c*n-a*o)/m,r[2]=2*(c*s+l*o+a*i-u*n)/m):(r[0]=2*(a*s+l*n+u*o-c*i),r[1]=2*(u*s+l*i+c*n-a*o),r[2]=2*(c*s+l*o+a*i-u*n)),ve(t,e,r),t}function ge(t,e){return t[0]=e[12],t[1]=e[13],t[2]=e[14],t}function xe(t,e){let r=e[0],n=e[1],i=e[2],o=e[4],s=e[5],a=e[6],u=e[8],c=e[9],l=e[10];return t[0]=Math.sqrt(r*r+n*n+i*i),t[1]=Math.sqrt(o*o+s*s+a*a),t[2]=Math.sqrt(u*u+c*c+l*l),t}function Ae(t,e){let r=e[0]+e[5]+e[10],n=0;return r>0?(n=2*Math.sqrt(r+1),t[3]=.25*n,t[0]=(e[6]-e[9])/n,t[1]=(e[8]-e[2])/n,t[2]=(e[1]-e[4])/n):e[0]>e[5]&&e[0]>e[10]?(n=2*Math.sqrt(1+e[0]-e[5]-e[10]),t[3]=(e[6]-e[9])/n,t[0]=.25*n,t[1]=(e[1]+e[4])/n,t[2]=(e[8]+e[2])/n):e[5]>e[10]?(n=2*Math.sqrt(1+e[5]-e[0]-e[10]),t[3]=(e[8]-e[2])/n,t[0]=(e[1]+e[4])/n,t[1]=.25*n,t[2]=(e[6]+e[9])/n):(n=2*Math.sqrt(1+e[10]-e[0]-e[5]),t[3]=(e[1]-e[4])/n,t[0]=(e[8]+e[2])/n,t[1]=(e[6]+e[9])/n,t[2]=.25*n),t}function we(t,e,r,n){let i=e[0],o=e[1],s=e[2],a=e[3],u=i+i,c=o+o,l=s+s,m=i*u,h=i*c,f=i*l,_=o*c,p=o*l,d=s*l,y=a*u,v=a*c,b=a*l,g=n[0],x=n[1],A=n[2];return t[0]=(1-(_+d))*g,t[1]=(h+b)*g,t[2]=(f-v)*g,t[3]=0,t[4]=(h-b)*x,t[5]=(1-(m+d))*x,t[6]=(p+y)*x,t[7]=0,t[8]=(f+v)*A,t[9]=(p-y)*A,t[10]=(1-(m+_))*A,t[11]=0,t[12]=r[0],t[13]=r[1],t[14]=r[2],t[15]=1,t}function Be(t,e,r,n,i){let o=e[0],s=e[1],a=e[2],u=e[3],c=o+o,l=s+s,m=a+a,h=o*c,f=o*l,_=o*m,p=s*l,d=s*m,y=a*m,v=u*c,b=u*l,g=u*m,x=n[0],A=n[1],w=n[2],B=i[0],E=i[1],M=i[2],S=(1-(p+y))*x,T=(f+g)*x,I=(_-b)*x,P=(f-g)*A,C=(1-(h+y))*A,R=(d+v)*A,F=(_+b)*w,D=(d-v)*w,L=(1-(h+p))*w;return t[0]=S,t[1]=T,t[2]=I,t[3]=0,t[4]=P,t[5]=C,t[6]=R,t[7]=0,t[8]=F,t[9]=D,t[10]=L,t[11]=0,t[12]=r[0]+B-(S*B+P*E+F*M),t[13]=r[1]+E-(T*B+C*E+D*M),t[14]=r[2]+M-(I*B+R*E+L*M),t[15]=1,t}function Ee(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=r+r,a=n+n,u=i+i,c=r*s,l=n*s,m=n*a,h=i*s,f=i*a,_=i*u,p=o*s,d=o*a,y=o*u;return t[0]=1-m-_,t[1]=l+y,t[2]=h-d,t[3]=0,t[4]=l-y,t[5]=1-c-_,t[6]=f+p,t[7]=0,t[8]=h+d,t[9]=f-p,t[10]=1-c-m,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function Me(t,e,r,n,i,o,s){let a=1/(r-e),u=1/(i-n),c=1/(o-s);return t[0]=2*o*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=2*o*u,t[6]=0,t[7]=0,t[8]=(r+e)*a,t[9]=(i+n)*u,t[10]=(s+o)*c,t[11]=-1,t[12]=0,t[13]=0,t[14]=s*o*2*c,t[15]=0,t}function Se(t,e,r,n,i){let o=1/Math.tan(e/2),s=1/(n-i);return t[0]=o/r,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=o,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=(i+n)*s,t[11]=-1,t[12]=0,t[13]=0,t[14]=2*i*n*s,t[15]=0,t}function Te(t,e,r,n){let i=Math.tan(e.upDegrees*Math.PI/180),o=Math.tan(e.downDegrees*Math.PI/180),s=Math.tan(e.leftDegrees*Math.PI/180),a=Math.tan(e.rightDegrees*Math.PI/180),u=2/(s+a),c=2/(i+o);return t[0]=u,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=c,t[6]=0,t[7]=0,t[8]=-(s-a)*u*.5,t[9]=(i-o)*c*.5,t[10]=n/(r-n),t[11]=-1,t[12]=0,t[13]=0,t[14]=n*r/(r-n),t[15]=0,t}function Ie(t,e,r,n,i,o,s){let a=1/(e-r),u=1/(n-i),c=1/(o-s);return t[0]=-2*a,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=-2*u,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=2*c,t[11]=0,t[12]=(e+r)*a,t[13]=(i+n)*u,t[14]=(s+o)*c,t[15]=1,t}function Pe(t,e,r,n){let i,o,s,a,u,c,l,m,h,_,p=e[0],d=e[1],y=e[2],v=n[0],b=n[1],g=n[2],x=r[0],A=r[1],w=r[2];return Math.abs(p-x)<f&&Math.abs(d-A)<f&&Math.abs(y-w)<f?te(t):(l=p-x,m=d-A,h=y-w,i=b*(h*=_=1/Math.sqrt(l*l+m*m+h*h))-g*(m*=_),o=g*(l*=_)-v*h,s=v*m-b*l,(_=Math.sqrt(i*i+o*o+s*s))?(i*=_=1/_,o*=_,s*=_):(i=0,o=0,s=0),a=m*s-h*o,u=h*i-l*s,c=l*o-m*i,(_=Math.sqrt(a*a+u*u+c*c))?(a*=_=1/_,u*=_,c*=_):(a=0,u=0,c=0),t[0]=i,t[1]=a,t[2]=l,t[3]=0,t[4]=o,t[5]=u,t[6]=m,t[7]=0,t[8]=s,t[9]=c,t[10]=h,t[11]=0,t[12]=-(i*p+o*d+s*y),t[13]=-(a*p+u*d+c*y),t[14]=-(l*p+m*d+h*y),t[15]=1,t)}function Ce(t,e,r,n){let i=e[0],o=e[1],s=e[2],a=n[0],u=n[1],c=n[2],l=i-r[0],m=o-r[1],h=s-r[2],f=l*l+m*m+h*h;f>0&&(l*=f=1/Math.sqrt(f),m*=f,h*=f);let _=u*h-c*m,p=c*l-a*h,d=a*m-u*l;return(f=_*_+p*p+d*d)>0&&(_*=f=1/Math.sqrt(f),p*=f,d*=f),t[0]=_,t[1]=p,t[2]=d,t[3]=0,t[4]=m*d-h*p,t[5]=h*_-l*d,t[6]=l*p-m*_,t[7]=0,t[8]=l,t[9]=m,t[10]=h,t[11]=0,t[12]=i,t[13]=o,t[14]=s,t[15]=1,t}function Re(t){return"mat4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+", "+t[8]+", "+t[9]+", "+t[10]+", "+t[11]+", "+t[12]+", "+t[13]+", "+t[14]+", "+t[15]+")"}function Fe(t){return Math.sqrt(Math.pow(t[0],2)+Math.pow(t[1],2)+Math.pow(t[2],2)+Math.pow(t[3],2)+Math.pow(t[4],2)+Math.pow(t[5],2)+Math.pow(t[6],2)+Math.pow(t[7],2)+Math.pow(t[8],2)+Math.pow(t[9],2)+Math.pow(t[10],2)+Math.pow(t[11],2)+Math.pow(t[12],2)+Math.pow(t[13],2)+Math.pow(t[14],2)+Math.pow(t[15],2))}function De(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t[8]=e[8]+r[8],t[9]=e[9]+r[9],t[10]=e[10]+r[10],t[11]=e[11]+r[11],t[12]=e[12]+r[12],t[13]=e[13]+r[13],t[14]=e[14]+r[14],t[15]=e[15]+r[15],t}function Le(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t[4]=e[4]-r[4],t[5]=e[5]-r[5],t[6]=e[6]-r[6],t[7]=e[7]-r[7],t[8]=e[8]-r[8],t[9]=e[9]-r[9],t[10]=e[10]-r[10],t[11]=e[11]-r[11],t[12]=e[12]-r[12],t[13]=e[13]-r[13],t[14]=e[14]-r[14],t[15]=e[15]-r[15],t}function Oe(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t[8]=e[8]*r,t[9]=e[9]*r,t[10]=e[10]*r,t[11]=e[11]*r,t[12]=e[12]*r,t[13]=e[13]*r,t[14]=e[14]*r,t[15]=e[15]*r,t}function ke(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t[4]=e[4]+r[4]*n,t[5]=e[5]+r[5]*n,t[6]=e[6]+r[6]*n,t[7]=e[7]+r[7]*n,t[8]=e[8]+r[8]*n,t[9]=e[9]+r[9]*n,t[10]=e[10]+r[10]*n,t[11]=e[11]+r[11]*n,t[12]=e[12]+r[12]*n,t[13]=e[13]+r[13]*n,t[14]=e[14]+r[14]*n,t[15]=e[15]+r[15]*n,t}function Ue(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]&&t[8]===e[8]&&t[9]===e[9]&&t[10]===e[10]&&t[11]===e[11]&&t[12]===e[12]&&t[13]===e[13]&&t[14]===e[14]&&t[15]===e[15]}function ze(t,e){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=t[8],m=t[9],h=t[10],_=t[11],p=t[12],d=t[13],y=t[14],v=t[15],b=e[0],g=e[1],x=e[2],A=e[3],w=e[4],B=e[5],E=e[6],M=e[7],S=e[8],T=e[9],I=e[10],P=e[11],C=e[12],R=e[13],F=e[14],D=e[15];return Math.abs(r-b)<=f*Math.max(1,Math.abs(r),Math.abs(b))&&Math.abs(n-g)<=f*Math.max(1,Math.abs(n),Math.abs(g))&&Math.abs(i-x)<=f*Math.max(1,Math.abs(i),Math.abs(x))&&Math.abs(o-A)<=f*Math.max(1,Math.abs(o),Math.abs(A))&&Math.abs(s-w)<=f*Math.max(1,Math.abs(s),Math.abs(w))&&Math.abs(a-B)<=f*Math.max(1,Math.abs(a),Math.abs(B))&&Math.abs(u-E)<=f*Math.max(1,Math.abs(u),Math.abs(E))&&Math.abs(c-M)<=f*Math.max(1,Math.abs(c),Math.abs(M))&&Math.abs(l-S)<=f*Math.max(1,Math.abs(l),Math.abs(S))&&Math.abs(m-T)<=f*Math.max(1,Math.abs(m),Math.abs(T))&&Math.abs(h-I)<=f*Math.max(1,Math.abs(h),Math.abs(I))&&Math.abs(_-P)<=f*Math.max(1,Math.abs(_),Math.abs(P))&&Math.abs(p-C)<=f*Math.max(1,Math.abs(p),Math.abs(C))&&Math.abs(d-R)<=f*Math.max(1,Math.abs(d),Math.abs(R))&&Math.abs(y-F)<=f*Math.max(1,Math.abs(y),Math.abs(F))&&Math.abs(v-D)<=f*Math.max(1,Math.abs(v),Math.abs(D))}const je=oe,Ve=Le;function Ne(){let t=new _(3);return t[0]=0,t[1]=0,t[2]=0,t}function qe(t){var e=new _(3);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e}function Ge(t){let e=t[0],r=t[1],n=t[2];return Math.sqrt(e*e+r*r+n*n)}function We(t,e,r){let n=new _(3);return n[0]=t,n[1]=e,n[2]=r,n}function Ye(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t}function Xe(t,e,r,n){return t[0]=e,t[1]=r,t[2]=n,t}function Ke(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t}function He(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t}function Je(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t}function Ze(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t}function Qe(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t}function $e(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t}function tr(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t}function er(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t}function rr(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t}function nr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t}function ir(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t}function or(t,e){let r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return Math.sqrt(r*r+n*n+i*i)}function sr(t,e){let r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2];return r*r+n*n+i*i}function ar(t){let e=t[0],r=t[1],n=t[2];return e*e+r*r+n*n}function ur(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t}function cr(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t}function lr(t,e){let r=e[0],n=e[1],i=e[2],o=r*r+n*n+i*i;return o>0&&(o=1/Math.sqrt(o),t[0]=e[0]*o,t[1]=e[1]*o,t[2]=e[2]*o),t}function mr(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function hr(t,e,r){let n=e[0],i=e[1],o=e[2],s=r[0],a=r[1],u=r[2];return t[0]=i*u-o*a,t[1]=o*s-n*u,t[2]=n*a-i*s,t}function fr(t,e,r,n){let i=e[0],o=e[1],s=e[2];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=s+n*(r[2]-s),t}function _r(t,e,r,n,i,o){let s=o*o,a=s*(2*o-3)+1,u=s*(o-2)+o,c=s*(o-1),l=s*(3-2*o);return t[0]=e[0]*a+r[0]*u+n[0]*c+i[0]*l,t[1]=e[1]*a+r[1]*u+n[1]*c+i[1]*l,t[2]=e[2]*a+r[2]*u+n[2]*c+i[2]*l,t}function pr(t,e,r,n,i,o){let s=1-o,a=s*s,u=o*o,c=a*s,l=3*o*a,m=3*u*s,h=u*o;return t[0]=e[0]*c+r[0]*l+n[0]*m+i[0]*h,t[1]=e[1]*c+r[1]*l+n[1]*m+i[1]*h,t[2]=e[2]*c+r[2]*l+n[2]*m+i[2]*h,t}function dr(t,e){e=e||1;let r=2*p()*Math.PI,n=2*p()-1,i=Math.sqrt(1-n*n)*e;return t[0]=Math.cos(r)*i,t[1]=Math.sin(r)*i,t[2]=n*e,t}function yr(t,e,r){let n=e[0],i=e[1],o=e[2],s=r[3]*n+r[7]*i+r[11]*o+r[15];return s=s||1,t[0]=(r[0]*n+r[4]*i+r[8]*o+r[12])/s,t[1]=(r[1]*n+r[5]*i+r[9]*o+r[13])/s,t[2]=(r[2]*n+r[6]*i+r[10]*o+r[14])/s,t}function vr(t,e,r){let n=e[0],i=e[1],o=e[2];return t[0]=n*r[0]+i*r[3]+o*r[6],t[1]=n*r[1]+i*r[4]+o*r[7],t[2]=n*r[2]+i*r[5]+o*r[8],t}function br(t,e,r){let n=r[0],i=r[1],o=r[2],s=r[3],a=e[0],u=e[1],c=e[2],l=i*c-o*u,m=o*a-n*c,h=n*u-i*a,f=i*h-o*m,_=o*l-n*h,p=n*m-i*l,d=2*s;return l*=d,m*=d,h*=d,f*=2,_*=2,p*=2,t[0]=a+l+f,t[1]=u+m+_,t[2]=c+h+p,t}function gr(t,e,r,n){let i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0],o[1]=i[1]*Math.cos(n)-i[2]*Math.sin(n),o[2]=i[1]*Math.sin(n)+i[2]*Math.cos(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function xr(t,e,r,n){let i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[2]*Math.sin(n)+i[0]*Math.cos(n),o[1]=i[1],o[2]=i[2]*Math.cos(n)-i[0]*Math.sin(n),t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function Ar(t,e,r,n){let i=[],o=[];return i[0]=e[0]-r[0],i[1]=e[1]-r[1],i[2]=e[2]-r[2],o[0]=i[0]*Math.cos(n)-i[1]*Math.sin(n),o[1]=i[0]*Math.sin(n)+i[1]*Math.cos(n),o[2]=i[2],t[0]=o[0]+r[0],t[1]=o[1]+r[1],t[2]=o[2]+r[2],t}function wr(t,e){let r=We(t[0],t[1],t[2]),n=We(e[0],e[1],e[2]);lr(r,r),lr(n,n);let i=mr(r,n);return i>1?0:i<-1?Math.PI:Math.acos(i)}function Br(t){return"vec3("+t[0]+", "+t[1]+", "+t[2]+")"}function Er(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]}function Mr(t,e){let r=t[0],n=t[1],i=t[2],o=e[0],s=e[1],a=e[2];return Math.abs(r-o)<=f*Math.max(1,Math.abs(r),Math.abs(o))&&Math.abs(n-s)<=f*Math.max(1,Math.abs(n),Math.abs(s))&&Math.abs(i-a)<=f*Math.max(1,Math.abs(i),Math.abs(a))}const Sr=He,Tr=Je,Ir=Ze,Pr=or,Cr=sr,Rr=Ge,Fr=ar,Dr=function(){let t=Ne();return function(e,r,n,i,o,s){let a,u;for(r||(r=3),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,a=n;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2];return e}}();function Lr(){let t=new _(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=0,t}function Or(t){let e=new _(4);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e}function kr(t,e,r,n){let i=new _(4);return i[0]=t,i[1]=e,i[2]=r,i[3]=n,i}function Ur(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t}function zr(t,e,r,n,i){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t}function jr(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t}function Vr(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t[2]=e[2]-r[2],t[3]=e[3]-r[3],t}function Nr(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t[2]=e[2]*r[2],t[3]=e[3]*r[3],t}function qr(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t[2]=e[2]/r[2],t[3]=e[3]/r[3],t}function Gr(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t[2]=Math.ceil(e[2]),t[3]=Math.ceil(e[3]),t}function Wr(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t[2]=Math.floor(e[2]),t[3]=Math.floor(e[3]),t}function Yr(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t[2]=Math.min(e[2],r[2]),t[3]=Math.min(e[3],r[3]),t}function Xr(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t[2]=Math.max(e[2],r[2]),t[3]=Math.max(e[3],r[3]),t}function Kr(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t[2]=Math.round(e[2]),t[3]=Math.round(e[3]),t}function Hr(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t}function Jr(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t[2]=e[2]+r[2]*n,t[3]=e[3]+r[3]*n,t}function Zr(t,e){let r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return Math.sqrt(r*r+n*n+i*i+o*o)}function Qr(t,e){let r=e[0]-t[0],n=e[1]-t[1],i=e[2]-t[2],o=e[3]-t[3];return r*r+n*n+i*i+o*o}function $r(t){let e=t[0],r=t[1],n=t[2],i=t[3];return Math.sqrt(e*e+r*r+n*n+i*i)}function tn(t){let e=t[0],r=t[1],n=t[2],i=t[3];return e*e+r*r+n*n+i*i}function en(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=-e[3],t}function rn(t,e){return t[0]=1/e[0],t[1]=1/e[1],t[2]=1/e[2],t[3]=1/e[3],t}function nn(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=r*r+n*n+i*i+o*o;return s>0&&(s=1/Math.sqrt(s),t[0]=r*s,t[1]=n*s,t[2]=i*s,t[3]=o*s),t}function on(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function sn(t,e,r,n){let i=e[0],o=e[1],s=e[2],a=e[3];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t[2]=s+n*(r[2]-s),t[3]=a+n*(r[3]-a),t}function an(t,e){var r,n,i,o,s,a;e=e||1;do{s=(r=2*p()-1)*r+(n=2*p()-1)*n}while(s>=1);do{a=(i=2*p()-1)*i+(o=2*p()-1)*o}while(a>=1);var u=Math.sqrt((1-s)/a);return t[0]=Hr*r,t[1]=Hr*n,t[2]=Hr*i*u,t[3]=Hr*o*u,t}function un(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3];return t[0]=r[0]*n+r[4]*i+r[8]*o+r[12]*s,t[1]=r[1]*n+r[5]*i+r[9]*o+r[13]*s,t[2]=r[2]*n+r[6]*i+r[10]*o+r[14]*s,t[3]=r[3]*n+r[7]*i+r[11]*o+r[15]*s,t}function cn(t,e,r){let n=e[0],i=e[1],o=e[2],s=r[0],a=r[1],u=r[2],c=r[3],l=c*n+a*o-u*i,m=c*i+u*n-s*o,h=c*o+s*i-a*n,f=-s*n-a*i-u*o;return t[0]=l*c+f*-s+m*-u-h*-a,t[1]=m*c+f*-a+h*-s-l*-u,t[2]=h*c+f*-u+l*-a-m*-s,t[3]=e[3],t}function ln(t){return"vec4("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}function mn(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]}function hn(t,e){let r=t[0],n=t[1],i=t[2],o=t[3],s=e[0],a=e[1],u=e[2],c=e[3];return Math.abs(r-s)<=f*Math.max(1,Math.abs(r),Math.abs(s))&&Math.abs(n-a)<=f*Math.max(1,Math.abs(n),Math.abs(a))&&Math.abs(i-u)<=f*Math.max(1,Math.abs(i),Math.abs(u))&&Math.abs(o-c)<=f*Math.max(1,Math.abs(o),Math.abs(c))}const fn=Vr,_n=Nr,pn=qr,dn=Zr,yn=Qr,vn=$r,bn=tn,gn=function(){let t=Lr();return function(e,r,n,i,o,s){let a,u;for(r||(r=4),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,a=n;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],t[2]=e[a+2],t[3]=e[a+3],o(t,t,s),e[a]=t[0],e[a+1]=t[1],e[a+2]=t[2],e[a+3]=t[3];return e}}();function xn(){let t=new _(4);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function An(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t}function wn(t,e,r){r*=.5;let n=Math.sin(r);return t[0]=n*e[0],t[1]=n*e[1],t[2]=n*e[2],t[3]=Math.cos(r),t}function Bn(t,e){let r=2*Math.acos(e[3]),n=Math.sin(r/2);return 0!=n?(t[0]=e[0]/n,t[1]=e[1]/n,t[2]=e[2]/n):(t[0]=1,t[1]=0,t[2]=0),r}function En(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*l+s*a+i*c-o*u,t[1]=i*l+s*u+o*a-n*c,t[2]=o*l+s*c+n*u-i*a,t[3]=s*l-n*a-i*u-o*c,t}function Mn(t,e,r){r*=.5;let n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=n*u+s*a,t[1]=i*u+o*a,t[2]=o*u-i*a,t[3]=s*u-n*a,t}function Sn(t,e,r){r*=.5;let n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=n*u-o*a,t[1]=i*u+s*a,t[2]=o*u+n*a,t[3]=s*u-i*a,t}function Tn(t,e,r){r*=.5;let n=e[0],i=e[1],o=e[2],s=e[3],a=Math.sin(r),u=Math.cos(r);return t[0]=n*u+i*a,t[1]=i*u-n*a,t[2]=o*u+s*a,t[3]=s*u-o*a,t}function In(t,e){let r=e[0],n=e[1],i=e[2];return t[0]=r,t[1]=n,t[2]=i,t[3]=Math.sqrt(Math.abs(1-r*r-n*n-i*i)),t}function Pn(t,e,r,n){let i,o,s,a,u,c=e[0],l=e[1],m=e[2],h=e[3],f=r[0],_=r[1],p=r[2],d=r[3];return(o=c*f+l*_+m*p+h*d)<0&&(o=-o,f=-f,_=-_,p=-p,d=-d),1-o>1e-6?(i=Math.acos(o),s=Math.sin(i),a=Math.sin((1-n)*i)/s,u=Math.sin(n*i)/s):(a=1-n,u=n),t[0]=a*c+u*f,t[1]=a*l+u*_,t[2]=a*m+u*p,t[3]=a*h+u*d,t}function Cn(t,e){let r=e[0],n=e[1],i=e[2],o=e[3],s=r*r+n*n+i*i+o*o,a=s?1/s:0;return t[0]=-r*a,t[1]=-n*a,t[2]=-i*a,t[3]=o*a,t}function Rn(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t}function Fn(t,e){let r,n=e[0]+e[4]+e[8];if(n>0)r=Math.sqrt(n+1),t[3]=.5*r,r=.5/r,t[0]=(e[5]-e[7])*r,t[1]=(e[6]-e[2])*r,t[2]=(e[1]-e[3])*r;else{let n=0;e[4]>e[0]&&(n=1),e[8]>e[3*n+n]&&(n=2);let i=(n+1)%3,o=(n+2)%3;r=Math.sqrt(e[3*n+n]-e[3*i+i]-e[3*o+o]+1),t[n]=.5*r,r=.5/r,t[3]=(e[3*i+o]-e[3*o+i])*r,t[i]=(e[3*i+n]+e[3*n+i])*r,t[o]=(e[3*o+n]+e[3*n+o])*r}return t}function Dn(t,e,r,n){let i=.5*Math.PI/180;e*=i,r*=i,n*=i;let o=Math.sin(e),s=Math.cos(e),a=Math.sin(r),u=Math.cos(r),c=Math.sin(n),l=Math.cos(n);return t[0]=o*u*l-s*a*c,t[1]=s*a*l+o*u*c,t[2]=s*u*c-o*a*l,t[3]=s*u*l+o*a*c,t}function Ln(t){return"quat("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+")"}const On=Or,kn=kr,Un=Ur,zn=zr,jn=jr,Vn=En,Nn=Hr,qn=on,Gn=sn,Wn=$r,Yn=Wn,Xn=tn,Kn=Xn,Hn=nn,Jn=mn,Zn=hn,Qn=function(){let t=Ne(),e=We(1,0,0),r=We(0,1,0);return function(n,i,o){let s=mr(i,o);return s<-.999999?(hr(t,e,i),Rr(t)<1e-6&&hr(t,r,i),lr(t,t),wn(n,t,Math.PI),n):s>.999999?(n[0]=0,n[1]=0,n[2]=0,n[3]=1,n):(hr(t,i,o),n[0]=t[0],n[1]=t[1],n[2]=t[2],n[3]=1+s,Hn(n,n))}}(),$n=function(){let t=xn(),e=xn();return function(r,n,i,o,s,a){return Pn(t,n,s,a),Pn(e,i,o,a),Pn(r,t,e,2*a*(1-a)),r}}(),ti=function(){let t=yt();return function(e,r,n,i){return t[0]=n[0],t[3]=n[1],t[6]=n[2],t[1]=i[0],t[4]=i[1],t[7]=i[2],t[2]=-r[0],t[5]=-r[1],t[8]=-r[2],Hn(e,Fn(e,t))}}();function ei(){let t=new _(8);return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function ri(t){let e=new _(8);return e[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e}function ni(t,e,r,n,i,o,s,a){let u=new _(8);return u[0]=t,u[1]=e,u[2]=r,u[3]=n,u[4]=i,u[5]=o,u[6]=s,u[7]=a,u}function ii(t,e,r,n,i,o,s){let a=new _(8);a[0]=t,a[1]=e,a[2]=r,a[3]=n;let u=.5*i,c=.5*o,l=.5*s;return a[4]=u*n+c*r-l*e,a[5]=c*n+l*t-u*r,a[6]=l*n+u*e-c*t,a[7]=-u*t-c*e-l*r,a}function oi(t,e,r){let n=.5*r[0],i=.5*r[1],o=.5*r[2],s=e[0],a=e[1],u=e[2],c=e[3];return t[0]=s,t[1]=a,t[2]=u,t[3]=c,t[4]=n*c+i*u-o*a,t[5]=i*c+o*s-n*u,t[6]=o*c+n*a-i*s,t[7]=-n*s-i*a-o*u,t}function si(t,e){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=.5*e[0],t[5]=.5*e[1],t[6]=.5*e[2],t[7]=0,t}function ai(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function ui(t,e){let r=xn();Ae(r,e);let n=new _(3);return ge(n,e),oi(t,r,n),t}function ci(t,e){return t[0]=e[0],t[1]=e[1],t[2]=e[2],t[3]=e[3],t[4]=e[4],t[5]=e[5],t[6]=e[6],t[7]=e[7],t}function li(t){return t[0]=0,t[1]=0,t[2]=0,t[3]=1,t[4]=0,t[5]=0,t[6]=0,t[7]=0,t}function mi(t,e,r,n,i,o,s,a,u){return t[0]=e,t[1]=r,t[2]=n,t[3]=i,t[4]=o,t[5]=s,t[6]=a,t[7]=u,t}const hi=Un;function fi(t,e){return t[0]=e[4],t[1]=e[5],t[2]=e[6],t[3]=e[7],t}const _i=Un;function pi(t,e){return t[4]=e[0],t[5]=e[1],t[6]=e[2],t[7]=e[3],t}function di(t,e){let r=e[4],n=e[5],i=e[6],o=e[7],s=-e[0],a=-e[1],u=-e[2],c=e[3];return t[0]=2*(r*c+o*s+n*u-i*a),t[1]=2*(n*c+o*a+i*s-r*u),t[2]=2*(i*c+o*u+r*a-n*s),t}function yi(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=.5*r[0],u=.5*r[1],c=.5*r[2],l=e[4],m=e[5],h=e[6],f=e[7];return t[0]=n,t[1]=i,t[2]=o,t[3]=s,t[4]=s*a+i*c-o*u+l,t[5]=s*u+o*a-n*c+m,t[6]=s*c+n*u-i*a+h,t[7]=-n*a-i*u-o*c+f,t}function vi(t,e,r){let n=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],m=a*s+l*n+u*o-c*i,h=u*s+l*i+c*n-a*o,f=c*s+l*o+a*i-u*n,_=l*s-a*n-u*i-c*o;return Mn(t,e,r),n=t[0],i=t[1],o=t[2],s=t[3],t[4]=m*s+_*n+h*o-f*i,t[5]=h*s+_*i+f*n-m*o,t[6]=f*s+_*o+m*i-h*n,t[7]=_*s-m*n-h*i-f*o,t}function bi(t,e,r){let n=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],m=a*s+l*n+u*o-c*i,h=u*s+l*i+c*n-a*o,f=c*s+l*o+a*i-u*n,_=l*s-a*n-u*i-c*o;return Sn(t,e,r),n=t[0],i=t[1],o=t[2],s=t[3],t[4]=m*s+_*n+h*o-f*i,t[5]=h*s+_*i+f*n-m*o,t[6]=f*s+_*o+m*i-h*n,t[7]=_*s-m*n-h*i-f*o,t}function gi(t,e,r){let n=-e[0],i=-e[1],o=-e[2],s=e[3],a=e[4],u=e[5],c=e[6],l=e[7],m=a*s+l*n+u*o-c*i,h=u*s+l*i+c*n-a*o,f=c*s+l*o+a*i-u*n,_=l*s-a*n-u*i-c*o;return Tn(t,e,r),n=t[0],i=t[1],o=t[2],s=t[3],t[4]=m*s+_*n+h*o-f*i,t[5]=h*s+_*i+f*n-m*o,t[6]=f*s+_*o+m*i-h*n,t[7]=_*s-m*n-h*i-f*o,t}function xi(t,e,r){let n=r[0],i=r[1],o=r[2],s=r[3],a=e[0],u=e[1],c=e[2],l=e[3];return t[0]=a*s+l*n+u*o-c*i,t[1]=u*s+l*i+c*n-a*o,t[2]=c*s+l*o+a*i-u*n,t[3]=l*s-a*n-u*i-c*o,a=e[4],u=e[5],c=e[6],l=e[7],t[4]=a*s+l*n+u*o-c*i,t[5]=u*s+l*i+c*n-a*o,t[6]=c*s+l*o+a*i-u*n,t[7]=l*s-a*n-u*i-c*o,t}function Ai(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=r[0],u=r[1],c=r[2],l=r[3];return t[0]=n*l+s*a+i*c-o*u,t[1]=i*l+s*u+o*a-n*c,t[2]=o*l+s*c+n*u-i*a,t[3]=s*l-n*a-i*u-o*c,a=r[4],u=r[5],c=r[6],l=r[7],t[4]=n*l+s*a+i*c-o*u,t[5]=i*l+s*u+o*a-n*c,t[6]=o*l+s*c+n*u-i*a,t[7]=s*l-n*a-i*u-o*c,t}function wi(t,e,r,n){if(Math.abs(n)<f)return ci(t,e);let i=Math.sqrt(r[0]*r[0]+r[1]*r[1]+r[2]*r[2]);n*=.5;let o=Math.sin(n),s=o*r[0]/i,a=o*r[1]/i,u=o*r[2]/i,c=Math.cos(n),l=e[0],m=e[1],h=e[2],_=e[3];t[0]=l*c+_*s+m*u-h*a,t[1]=m*c+_*a+h*s-l*u,t[2]=h*c+_*u+l*a-m*s,t[3]=_*c-l*s-m*a-h*u;let p=e[4],d=e[5],y=e[6],v=e[7];return t[4]=p*c+v*s+d*u-y*a,t[5]=d*c+v*a+y*s-p*u,t[6]=y*c+v*u+p*a-d*s,t[7]=v*c-p*s-d*a-y*u,t}function Bi(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t[2]=e[2]+r[2],t[3]=e[3]+r[3],t[4]=e[4]+r[4],t[5]=e[5]+r[5],t[6]=e[6]+r[6],t[7]=e[7]+r[7],t}function Ei(t,e,r){let n=e[0],i=e[1],o=e[2],s=e[3],a=r[4],u=r[5],c=r[6],l=r[7],m=e[4],h=e[5],f=e[6],_=e[7],p=r[0],d=r[1],y=r[2],v=r[3];return t[0]=n*v+s*p+i*y-o*d,t[1]=i*v+s*d+o*p-n*y,t[2]=o*v+s*y+n*d-i*p,t[3]=s*v-n*p-i*d-o*y,t[4]=n*l+s*a+i*c-o*u+m*v+_*p+h*y-f*d,t[5]=i*l+s*u+o*a-n*c+h*v+_*d+f*p-m*y,t[6]=o*l+s*c+n*u-i*a+f*v+_*y+m*d-h*p,t[7]=s*l-n*a-i*u-o*c+_*v-m*p-h*d-f*y,t}const Mi=Ei;function Si(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t[2]=e[2]*r,t[3]=e[3]*r,t[4]=e[4]*r,t[5]=e[5]*r,t[6]=e[6]*r,t[7]=e[7]*r,t}const Ti=qn;function Ii(t,e,r,n){let i=1-n;return Ti(e,r)<0&&(n=-n),t[0]=e[0]*i+r[0]*n,t[1]=e[1]*i+r[1]*n,t[2]=e[2]*i+r[2]*n,t[3]=e[3]*i+r[3]*n,t[4]=e[4]*i+r[4]*n,t[5]=e[5]*i+r[5]*n,t[6]=e[6]*i+r[6]*n,t[7]=e[7]*i+r[7]*n,t}function Pi(t,e){let r=Di(e);return t[0]=-e[0]/r,t[1]=-e[1]/r,t[2]=-e[2]/r,t[3]=e[3]/r,t[4]=-e[4]/r,t[5]=-e[5]/r,t[6]=-e[6]/r,t[7]=e[7]/r,t}function Ci(t,e){return t[0]=-e[0],t[1]=-e[1],t[2]=-e[2],t[3]=e[3],t[4]=-e[4],t[5]=-e[5],t[6]=-e[6],t[7]=e[7],t}const Ri=Wn,Fi=Ri,Di=Xn,Li=Di;function Oi(t,e){let r=Di(e);return r>0&&(r=Math.sqrt(r),t[0]=e[0]/r,t[1]=e[1]/r,t[2]=e[2]/r,t[3]=e[3]/r,t[4]=e[4]/r,t[5]=e[5]/r,t[6]=e[6]/r,t[7]=e[7]/r),t}function ki(t){return"quat2("+t[0]+", "+t[1]+", "+t[2]+", "+t[3]+", "+t[4]+", "+t[5]+", "+t[6]+", "+t[7]+")"}function Ui(t,e){return t[0]===e[0]&&t[1]===e[1]&&t[2]===e[2]&&t[3]===e[3]&&t[4]===e[4]&&t[5]===e[5]&&t[6]===e[6]&&t[7]===e[7]}function zi(t,e){let r=t[0],n=t[1],i=t[2],o=t[3],s=t[4],a=t[5],u=t[6],c=t[7],l=e[0],m=e[1],h=e[2],_=e[3],p=e[4],d=e[5],y=e[6],v=e[7];return Math.abs(r-l)<=f*Math.max(1,Math.abs(r),Math.abs(l))&&Math.abs(n-m)<=f*Math.max(1,Math.abs(n),Math.abs(m))&&Math.abs(i-h)<=f*Math.max(1,Math.abs(i),Math.abs(h))&&Math.abs(o-_)<=f*Math.max(1,Math.abs(o),Math.abs(_))&&Math.abs(s-p)<=f*Math.max(1,Math.abs(s),Math.abs(p))&&Math.abs(a-d)<=f*Math.max(1,Math.abs(a),Math.abs(d))&&Math.abs(u-y)<=f*Math.max(1,Math.abs(u),Math.abs(y))&&Math.abs(c-v)<=f*Math.max(1,Math.abs(c),Math.abs(v))}function ji(){let t=new _(2);return t[0]=0,t[1]=0,t}function Vi(t){let e=new _(2);return e[0]=t[0],e[1]=t[1],e}function Ni(t,e){let r=new _(2);return r[0]=t,r[1]=e,r}function qi(t,e){return t[0]=e[0],t[1]=e[1],t}function Gi(t,e,r){return t[0]=e,t[1]=r,t}function Wi(t,e,r){return t[0]=e[0]+r[0],t[1]=e[1]+r[1],t}function Yi(t,e,r){return t[0]=e[0]-r[0],t[1]=e[1]-r[1],t}function Xi(t,e,r){return t[0]=e[0]*r[0],t[1]=e[1]*r[1],t}function Ki(t,e,r){return t[0]=e[0]/r[0],t[1]=e[1]/r[1],t}function Hi(t,e){return t[0]=Math.ceil(e[0]),t[1]=Math.ceil(e[1]),t}function Ji(t,e){return t[0]=Math.floor(e[0]),t[1]=Math.floor(e[1]),t}function Zi(t,e,r){return t[0]=Math.min(e[0],r[0]),t[1]=Math.min(e[1],r[1]),t}function Qi(t,e,r){return t[0]=Math.max(e[0],r[0]),t[1]=Math.max(e[1],r[1]),t}function $i(t,e){return t[0]=Math.round(e[0]),t[1]=Math.round(e[1]),t}function to(t,e,r){return t[0]=e[0]*r,t[1]=e[1]*r,t}function eo(t,e,r,n){return t[0]=e[0]+r[0]*n,t[1]=e[1]+r[1]*n,t}function ro(t,e){var r=e[0]-t[0],n=e[1]-t[1];return Math.sqrt(r*r+n*n)}function no(t,e){var r=e[0]-t[0],n=e[1]-t[1];return r*r+n*n}function io(t){var e=t[0],r=t[1];return Math.sqrt(e*e+r*r)}function oo(t){var e=t[0],r=t[1];return e*e+r*r}function so(t,e){return t[0]=-e[0],t[1]=-e[1],t}function ao(t,e){return t[0]=1/e[0],t[1]=1/e[1],t}function uo(t,e){var r=e[0],n=e[1],i=r*r+n*n;return i>0&&(i=1/Math.sqrt(i),t[0]=e[0]*i,t[1]=e[1]*i),t}function co(t,e){return t[0]*e[0]+t[1]*e[1]}function lo(t,e,r){var n=e[0]*r[1]-e[1]*r[0];return t[0]=t[1]=0,t[2]=n,t}function mo(t,e,r,n){var i=e[0],o=e[1];return t[0]=i+n*(r[0]-i),t[1]=o+n*(r[1]-o),t}function ho(t,e){e=e||1;var r=2*p()*Math.PI;return t[0]=Math.cos(r)*e,t[1]=Math.sin(r)*e,t}function fo(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i,t[1]=r[1]*n+r[3]*i,t}function _o(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[2]*i+r[4],t[1]=r[1]*n+r[3]*i+r[5],t}function po(t,e,r){var n=e[0],i=e[1];return t[0]=r[0]*n+r[3]*i+r[6],t[1]=r[1]*n+r[4]*i+r[7],t}function yo(t,e,r){let n=e[0],i=e[1];return t[0]=r[0]*n+r[4]*i+r[12],t[1]=r[1]*n+r[5]*i+r[13],t}function vo(t,e,r,n){let i=e[0]-r[0],o=e[1]-r[1],s=Math.sin(n),a=Math.cos(n);return t[0]=i*a-o*s+r[0],t[1]=i*s+o*a+r[1],t}function bo(t,e){let r=t[0],n=t[1],i=e[0],o=e[1],s=r*r+n*n;s>0&&(s=1/Math.sqrt(s));let a=i*i+o*o;a>0&&(a=1/Math.sqrt(a));let u=(r*i+n*o)*s*a;return u>1?0:u<-1?Math.PI:Math.acos(u)}function go(t){return"vec2("+t[0]+", "+t[1]+")"}function xo(t,e){return t[0]===e[0]&&t[1]===e[1]}function Ao(t,e){let r=t[0],n=t[1],i=e[0],o=e[1];return Math.abs(r-i)<=f*Math.max(1,Math.abs(r),Math.abs(i))&&Math.abs(n-o)<=f*Math.max(1,Math.abs(n),Math.abs(o))}const wo=io,Bo=Yi,Eo=Xi,Mo=Ki,So=ro,To=no,Io=oo,Po=function(){let t=ji();return function(e,r,n,i,o,s){let a,u;for(r||(r=2),n||(n=0),u=i?Math.min(i*r+n,e.length):e.length,a=n;a<u;a+=r)t[0]=e[a],t[1]=e[a+1],o(t,t,s),e[a]=t[0],e[a+1]=t[1];return e}}();r.d(e,"glMatrix",function(){return n}),r.d(e,"mat2",function(){return i}),r.d(e,"mat2d",function(){return o}),r.d(e,"mat3",function(){return s}),r.d(e,"mat4",function(){return a}),r.d(e,"quat",function(){return l}),r.d(e,"quat2",function(){return m}),r.d(e,"vec2",function(){return h}),r.d(e,"vec3",function(){return u}),r.d(e,"vec4",function(){return c})},function(t,e,r){var n="undefined"!=typeof DEBUG&&DEBUG,i="undefined"!=typeof ASSERT&&ASSERT;t.exports=a;var o=r(7),s=r(4);function a(t,e){if(!(this instanceof a))return new a(t,e);void 0===t?(this.x=0,this.y=0):"object"==typeof t?(this.x=t.x,this.y=t.y):(this.x=t,this.y=e),i&&a.assert(this)}a.zero=function(){var t=Object.create(a.prototype);return t.x=0,t.y=0,t},a.neo=function(t,e){var r=Object.create(a.prototype);return r.x=t,r.y=e,r},a.clone=function(t,e){return i&&a.assert(t),i&&o.assert(!e),a.neo(t.x,t.y)},a.prototype.toString=function(){return JSON.stringify(this)},a.isValid=function(t){return t&&s.isFinite(t.x)&&s.isFinite(t.y)},a.assert=function(t){if(i&&!a.isValid(t))throw n&&o.debug(t),new Error("Invalid Vec2!")},a.prototype.clone=function(t){return a.clone(this,t)},a.prototype.setZero=function(){return this.x=0,this.y=0,this},a.prototype.set=function(t,e){return"object"==typeof t?(i&&a.assert(t),this.x=t.x,this.y=t.y):(i&&s.assert(t),i&&s.assert(e),this.x=t,this.y=e),this},a.prototype.wSet=function(t,e,r,n){i&&s.assert(t),i&&a.assert(e);var o=t*e.x,u=t*e.y;return void 0===r&&void 0===n||(i&&s.assert(r),i&&a.assert(n),o+=r*n.x,u+=r*n.y),this.x=o,this.y=u,this},a.prototype.add=function(t){return i&&a.assert(t),this.x+=t.x,this.y+=t.y,this},a.prototype.wAdd=function(t,e,r,n){i&&s.assert(t),i&&a.assert(e);var o=t*e.x,u=t*e.y;return void 0===r&&void 0===n||(i&&s.assert(r),i&&a.assert(n),o+=r*n.x,u+=r*n.y),this.x+=o,this.y+=u,this},a.prototype.wSub=function(t,e,r,n){i&&s.assert(t),i&&a.assert(e);var o=t*e.x,u=t*e.y;return void 0===r&&void 0===n||(i&&s.assert(r),i&&a.assert(n),o+=r*n.x,u+=r*n.y),this.x-=o,this.y-=u,this},a.prototype.sub=function(t){return i&&a.assert(t),this.x-=t.x,this.y-=t.y,this},a.prototype.mul=function(t){return i&&s.assert(t),this.x*=t,this.y*=t,this},a.prototype.length=function(){return a.lengthOf(this)},a.prototype.lengthSquared=function(){return a.lengthSquared(this)},a.prototype.normalize=function(){var t=this.length();if(t<s.EPSILON)return 0;var e=1/t;return this.x*=e,this.y*=e,t},a.lengthOf=function(t){return i&&a.assert(t),s.sqrt(t.x*t.x+t.y*t.y)},a.lengthSquared=function(t){return i&&a.assert(t),t.x*t.x+t.y*t.y},a.distance=function(t,e){i&&a.assert(t),i&&a.assert(e);var r=t.x-e.x,n=t.y-e.y;return s.sqrt(r*r+n*n)},a.distanceSquared=function(t,e){i&&a.assert(t),i&&a.assert(e);var r=t.x-e.x,n=t.y-e.y;return r*r+n*n},a.areEqual=function(t,e){return i&&a.assert(t),i&&a.assert(e),t==e||"object"==typeof e&&null!==e&&t.x==e.x&&t.y==e.y},a.skew=function(t){return i&&a.assert(t),a.neo(-t.y,t.x)},a.dot=function(t,e){return i&&a.assert(t),i&&a.assert(e),t.x*e.x+t.y*e.y},a.cross=function(t,e){return"number"==typeof e?(i&&a.assert(t),i&&s.assert(e),a.neo(e*t.y,-e*t.x)):"number"==typeof t?(i&&s.assert(t),i&&a.assert(e),a.neo(-t*e.y,t*e.x)):(i&&a.assert(t),i&&a.assert(e),t.x*e.y-t.y*e.x)},a.addCross=function(t,e,r){return"number"==typeof r?(i&&a.assert(e),i&&s.assert(r),a.neo(r*e.y+t.x,-r*e.x+t.y)):"number"==typeof e?(i&&s.assert(e),i&&a.assert(r),a.neo(-e*r.y+t.x,e*r.x+t.y)):void(i&&o.assert(!1))},a.add=function(t,e){return i&&a.assert(t),i&&a.assert(e),a.neo(t.x+e.x,t.y+e.y)},a.wAdd=function(t,e,r,n){var i=a.zero();return i.wAdd(t,e,r,n),i},a.sub=function(t,e){return i&&a.assert(t),i&&a.assert(e),a.neo(t.x-e.x,t.y-e.y)},a.mul=function(t,e){return"object"==typeof t?(i&&a.assert(t),i&&s.assert(e),a.neo(t.x*e,t.y*e)):"object"==typeof e?(i&&s.assert(t),i&&a.assert(e),a.neo(t*e.x,t*e.y)):void 0},a.prototype.neg=function(){return this.x=-this.x,this.y=-this.y,this},a.neg=function(t){return i&&a.assert(t),a.neo(-t.x,-t.y)},a.abs=function(t){return i&&a.assert(t),a.neo(s.abs(t.x),s.abs(t.y))},a.mid=function(t,e){return i&&a.assert(t),i&&a.assert(e),a.neo(.5*(t.x+e.x),.5*(t.y+e.y))},a.upper=function(t,e){return i&&a.assert(t),i&&a.assert(e),a.neo(s.max(t.x,e.x),s.max(t.y,e.y))},a.lower=function(t,e){return i&&a.assert(t),i&&a.assert(e),a.neo(s.min(t.x,e.x),s.min(t.y,e.y))},a.prototype.clamp=function(t){var e=this.x*this.x+this.y*this.y;if(e>t*t){var r=s.invSqrt(e);this.x*=r*t,this.y*=r*t}return this},a.clamp=function(t,e){return(t=a.neo(t.x,t.y)).clamp(e),t}},function(t,e,r){var n="undefined"!=typeof DEBUG&&DEBUG,i="undefined"!=typeof ASSERT&&ASSERT,o=r(7),s=r(22),a=Math,u=t.exports=s(a);u.EPSILON=1e-9,u.isFinite=function(t){return"number"==typeof t&&isFinite(t)&&!isNaN(t)},u.assert=function(t){if(i&&!u.isFinite(t))throw n&&o.debug(t),new Error("Invalid Number!")},u.invSqrt=function(t){return 1/a.sqrt(t)},u.nextPowerOfTwo=function(t){return t|=t>>1,t|=t>>2,t|=t>>4,t|=t>>8,(t|=t>>16)+1},u.isPowerOfTwo=function(t){return t>0&&0==(t&t-1)},u.mod=function(t,e,r){return void 0===e?(r=1,e=0):void 0===r&&(r=e,e=0),r>e?(t=(t-e)%(r-e))+(t<0?r:e):(t=(t-r)%(e-r))+(t<=0?e:r)},u.clamp=function(t,e,r){return t<e?e:t>r?r:t},u.random=function(t,e){return void 0===t?(e=1,t=0):void 0===e&&(e=t,t=0),t==e?t:a.random()*(e-t)+t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.twgl=e.default=void 0;var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}(r(36));e.twgl=n;var i=n;e.default=i},,function(t,e){var r="undefined"!=typeof DEBUG&&DEBUG,n="undefined"!=typeof ASSERT&&ASSERT;e.debug=function(){r&&console.log.apply(console,arguments)},e.assert=function(t,e,r){if(n&&!t)throw r&&console.log(r),new Error(e)}},,,function(t,e){var r;r=function(){return this}();try{r=r||Function("return this")()||(0,eval)("this")}catch(t){"object"==typeof window&&(r=window)}t.exports=r},,function(t,e,r){var n="undefined"!=typeof DEBUG&&DEBUG,i="undefined"!=typeof ASSERT&&ASSERT;t.exports=u;var o=r(7),s=r(3),a=r(4);function u(t){if(!(this instanceof u))return new u(t);"number"==typeof t?this.setAngle(t):"object"==typeof t?this.set(t):this.setIdentity()}u.neo=function(t){var e=Object.create(u.prototype);return e.setAngle(t),e},u.clone=function(t){i&&u.assert(t);var e=Object.create(u.prototype);return e.s=t.s,e.c=t.c,e},u.identity=function(t){var e=Object.create(u.prototype);return e.s=0,e.c=1,e},u.isValid=function(t){return t&&a.isFinite(t.s)&&a.isFinite(t.c)},u.assert=function(t){if(i&&!u.isValid(t))throw n&&o.debug(t),new Error("Invalid Rot!")},u.prototype.setIdentity=function(){this.s=0,this.c=1},u.prototype.set=function(t){"object"==typeof t?(i&&u.assert(t),this.s=t.s,this.c=t.c):(i&&a.assert(t),this.s=a.sin(t),this.c=a.cos(t))},u.prototype.setAngle=function(t){i&&a.assert(t),this.s=a.sin(t),this.c=a.cos(t)},u.prototype.getAngle=function(){return a.atan2(this.s,this.c)},u.prototype.getXAxis=function(){return s.neo(this.c,this.s)},u.prototype.getYAxis=function(){return s.neo(-this.s,this.c)},u.mul=function(t,e){if(i&&u.assert(t),"c"in e&&"s"in e){i&&u.assert(e);var r=u.identity();return r.s=t.s*e.c+t.c*e.s,r.c=t.c*e.c-t.s*e.s,r}if("x"in e&&"y"in e)return i&&s.assert(e),s.neo(t.c*e.x-t.s*e.y,t.s*e.x+t.c*e.y)},u.mulSub=function(t,e,r){var n=t.c*(e.x-r.x)-t.s*(e.y-r.y),i=t.s*(e.x-r.y)+t.c*(e.y-r.y);return s.neo(n,i)},u.mulT=function(t,e){if("c"in e&&"s"in e){i&&u.assert(e);var r=u.identity();return r.s=t.c*e.s-t.s*e.c,r.c=t.c*e.c+t.s*e.s,r}if("x"in e&&"y"in e)return i&&s.assert(e),s.neo(t.c*e.x+t.s*e.y,-t.s*e.x+t.c*e.y)}},function(t,e){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;var r=e;r.maxManifoldPoints=2,r.maxPolygonVertices=12,r.aabbExtension=.1,r.aabbMultiplier=2,r.linearSlop=.005,r.linearSlopSquared=r.linearSlop*r.linearSlop,r.angularSlop=2/180*Math.PI,r.polygonRadius=2*r.linearSlop,r.maxSubSteps=8,r.maxTOIContacts=32,r.maxTOIIterations=20,r.maxDistnceIterations=20,r.velocityThreshold=1,r.maxLinearCorrection=.2,r.maxAngularCorrection=8/180*Math.PI,r.maxTranslation=2,r.maxTranslationSquared=r.maxTranslation*r.maxTranslation,r.maxRotation=.5*Math.PI,r.maxRotationSquared=r.maxRotation*r.maxRotation,r.baumgarte=.2,r.toiBaugarte=.75,r.timeToSleep=.5,r.linearSleepTolerance=.01,r.linearSleepToleranceSqr=Math.pow(r.linearSleepTolerance,2),r.angularSleepTolerance=2/180*Math.PI,r.angularSleepToleranceSqr=Math.pow(r.angularSleepTolerance,2)},function(t,e,r){var n="undefined"!=typeof DEBUG&&DEBUG,i="undefined"!=typeof ASSERT&&ASSERT;t.exports=u;var o=r(7),s=r(3),a=r(12);function u(t,e){if(!(this instanceof u))return new u(t,e);this.p=s.zero(),this.q=a.identity(),void 0!==t&&this.p.set(t),void 0!==e&&this.q.set(e)}u.clone=function(t){var e=Object.create(u.prototype);return e.p=s.clone(t.p),e.q=a.clone(t.q),e},u.neo=function(t,e){var r=Object.create(u.prototype);return r.p=s.clone(t),r.q=a.clone(e),r},u.identity=function(){var t=Object.create(u.prototype);return t.p=s.zero(),t.q=a.identity(),t},u.prototype.setIdentity=function(){this.p.setZero(),this.q.setIdentity()},u.prototype.set=function(t,e){u.isValid(t)?(this.p.set(t.p),this.q.set(t.q)):(this.p.set(t),this.q.set(e))},u.isValid=function(t){return t&&s.isValid(t.p)&&a.isValid(t.q)},u.assert=function(t){if(i&&!u.isValid(t))throw n&&o.debug(t),new Error("Invalid Transform!")},u.mul=function(t,e){if(i&&u.assert(t),Array.isArray(e)){for(var r=[],n=0;n<e.length;n++)r[n]=u.mul(t,e[n]);return r}if("x"in e&&"y"in e){i&&s.assert(e);var o=t.q.c*e.x-t.q.s*e.y+t.p.x,c=t.q.s*e.x+t.q.c*e.y+t.p.y;return s.neo(o,c)}if("p"in e&&"q"in e){i&&u.assert(e);var l=u.identity();return l.q=a.mul(t.q,e.q),l.p=s.add(a.mul(t.q,e.p),t.p),l}},u.mulT=function(t,e){if(i&&u.assert(t),"x"in e&&"y"in e){i&&s.assert(e);var r=e.x-t.p.x,n=e.y-t.p.y,o=t.q.c*r+t.q.s*n,c=-t.q.s*r+t.q.c*n;return s.neo(o,c)}if("p"in e&&"q"in e){i&&u.assert(e);var l=u.identity();return l.q.set(a.mulT(t.q,e.q)),l.p.set(a.mulT(t.q,s.sub(e.p,t.p))),l}}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.arraySetter=function(t){var e=0;return function(r){if(!r.length&&e+(r=[r]).length>t.length)throw new Error("attempting to append beyond buffer length");t.set(r,e),e+=r.length}},e.hsl2rgb=function(t,e,r){var n,i,o,s,a,u;isFinite(t)||(t=0);isFinite(e)||(e=0);isFinite(r)||(r=0);(t/=60)<0&&(t=6- -t%6);t%=6,e=Math.max(0,Math.min(1,e/100)),r=Math.max(0,Math.min(1,r/100)),a=(1-Math.abs(2*r-1))*e,u=a*(1-Math.abs(t%2-1)),t<1?(n=a,i=u,o=0):t<2?(n=u,i=a,o=0):t<3?(n=0,i=a,o=u):t<4?(n=0,i=u,o=a):t<5?(n=u,i=0,o=a):(n=a,i=0,o=u);return s=r-a/2,n=Math.round(255*(n+s)),i=Math.round(255*(i+s)),o=Math.round(255*(o+s)),[n,i,o]},e.attachFramebuffer=function(t,e,r){var n=t.createFramebuffer(),i=t.createTexture();return t.bindTexture(t.TEXTURE_2D,i),t.texStorage2D(t.TEXTURE_2D,1,t.RGBA8,e,r),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.NEAREST),t.bindFramebuffer(t.FRAMEBUFFER,n),t.framebufferTexture2D(t.FRAMEBUFFER,t.COLOR_ATTACHMENT0,t.TEXTURE_2D,i,0),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindTexture(t.TEXTURE_2D,null),{width:e,height:r,attach:function(){t.viewport(0,0,e,r),t.bindFramebuffer(t.FRAMEBUFFER,n)},detach:function(){t.bindFramebuffer(t.FRAMEBUFFER,null)},texture:i,framebuffer:n}},e.loadImage=function(t){return new Promise(function(e,r){var n=new Image;function i(){n.removeEventListener("load",null),n.removeEventListener("error",null)}n.addEventListener("load",function(){i(),e(n)}),n.addEventListener("error",function(t){i(),r(t)}),n.src=t})}},,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Sprite=void 0;e.Sprite=function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.position=e.position||[0,0],this.size=e.size,this.angle=0,this.offset=e.offset||[0,0],this.backgroundColor=e.backgroundColor||[0,0,0,0],this.textureName=e.textureName||null}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.SpriteRenderer=void 0;var n=s(r(5)),i=s(r(34)),o=s(r(33));function s(t){return t&&t.__esModule?t:{default:t}}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var u=new Float32Array([0,0,1,0,0,1,1,1]),c=function(){function t(e){var r=e.game,n=e.textureInfo;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.gl=r.gl,this.loader=r.loader,this.game=r,this.textureInfo=n,this.setup()}return function(t,e,r){e&&a(t.prototype,e),r&&a(t,r)}(t,[{key:"setup",value:function(){this.programInfo=n.default.createProgramInfo(this.gl,[i.default,o.default]),this._arrays={vertex:{data:u,numComponents:2,divisor:0,drawType:this.gl.STATIC_DRAW},position:{numComponents:2,divisor:1,drawType:this.gl.DYNAMIC_DRAW},offset:{numComponents:2,divisor:1,drawType:this.gl.DYNAMIC_DRAW},size:{numComponents:2,divisor:1,drawType:this.gl.DYNAMIC_DRAW},texcoord:{data:[0,0,1,0,0,1,1,1],numComponents:2,divisor:0,type:Int16Array},indices:{data:[0,1,2,3]}},this.bufferInfo=n.default.createBufferInfoFromArrays(this.gl,this._arrays),this.vao=n.default.createVertexArrayInfo(this.gl,this.programInfo,this.bufferInfo)}},{key:"render",value:function(t,e){var r=new Float32Array(2*t.length),i=new Float32Array(2*t.length),o=new Float32Array(2*t.length);t.forEach(function(t,e){t.position.forEach(function(t,n){r[2*e+n]=t}),t.size.forEach(function(t,r){i[2*e+r]=t}),t.offset.forEach(function(t,r){o[2*e+r]=t})}),n.default.setAttribInfoBufferFromArray(this.gl,this.bufferInfo.attribs.position,r),n.default.setAttribInfoBufferFromArray(this.gl,this.bufferInfo.attribs.size,i),n.default.setAttribInfoBufferFromArray(this.gl,this.bufferInfo.attribs.offset,o),this.gl.useProgram(this.programInfo.program),n.default.setUniforms(this.programInfo,{projection:e,texture:this.textureInfo.texture}),n.default.setBuffersAndAttributes(this.gl,this.programInfo,this.vao),n.default.drawBufferInfo(this.gl,this.vao,this.gl.TRIANGLE_STRIP,void 0,void 0,t.length)}}]),t}();e.SpriteRenderer=c},,,,function(t,e){if("function"==typeof Object.create)t.exports=function(t,e){return Object.create.call(Object,t,e)};else{function r(){}t.exports=function(t,e){if(e)throw Error("Second argument is not supported!");if("object"!=typeof t||null===t)throw Error("Invalid prototype!");return r.prototype=t,new r}}},function(t,e,r){var n={},i=function(t){var e;return function(){return void 0===e&&(e=t.apply(this,arguments)),e}}(function(){return window&&document&&document.all&&!window.atob}),o=function(t){var e={};return function(t){if(void 0===e[t]){var r=function(t){return document.querySelector(t)}.call(this,t);if(r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}}(),s=null,a=0,u=[],c=r(25);function l(t,e){for(var r=0;r<t.length;r++){var i=t[r],o=n[i.id];if(o){o.refs++;for(var s=0;s<o.parts.length;s++)o.parts[s](i.parts[s]);for(;s<i.parts.length;s++)o.parts.push(d(i.parts[s],e))}else{var a=[];for(s=0;s<i.parts.length;s++)a.push(d(i.parts[s],e));n[i.id]={id:i.id,refs:1,parts:a}}}}function m(t,e){for(var r=[],n={},i=0;i<t.length;i++){var o=t[i],s=e.base?o[0]+e.base:o[0],a={css:o[1],media:o[2],sourceMap:o[3]};n[s]?n[s].parts.push(a):r.push(n[s]={id:s,parts:[a]})}return r}function h(t,e){var r=o(t.insertInto);if(!r)throw new Error("Couldn't find a style target. This probably means that the value for the 'insertInto' parameter is invalid.");var n=u[u.length-1];if("top"===t.insertAt)n?n.nextSibling?r.insertBefore(e,n.nextSibling):r.appendChild(e):r.insertBefore(e,r.firstChild),u.push(e);else if("bottom"===t.insertAt)r.appendChild(e);else{if("object"!=typeof t.insertAt||!t.insertAt.before)throw new Error("[Style Loader]\n\n Invalid value for parameter 'insertAt' ('options.insertAt') found.\n Must be 'top', 'bottom', or Object.\n (https://github.com/webpack-contrib/style-loader#insertat)\n");var i=o(t.insertInto+" "+t.insertAt.before);r.insertBefore(e,i)}}function f(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t);var e=u.indexOf(t);e>=0&&u.splice(e,1)}function _(t){var e=document.createElement("style");return t.attrs.type="text/css",p(e,t.attrs),h(t,e),e}function p(t,e){Object.keys(e).forEach(function(r){t.setAttribute(r,e[r])})}function d(t,e){var r,n,i,o;if(e.transform&&t.css){if(!(o=e.transform(t.css)))return function(){};t.css=o}if(e.singleton){var u=a++;r=s||(s=_(e)),n=v.bind(null,r,u,!1),i=v.bind(null,r,u,!0)}else t.sourceMap&&"function"==typeof URL&&"function"==typeof URL.createObjectURL&&"function"==typeof URL.revokeObjectURL&&"function"==typeof Blob&&"function"==typeof btoa?(r=function(t){var e=document.createElement("link");return t.attrs.type="text/css",t.attrs.rel="stylesheet",p(e,t.attrs),h(t,e),e}(e),n=function(t,e,r){var n=r.css,i=r.sourceMap,o=void 0===e.convertToAbsoluteUrls&&i;(e.convertToAbsoluteUrls||o)&&(n=c(n));i&&(n+="\n/*# sourceMappingURL=data:application/json;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(i))))+" */");var s=new Blob([n],{type:"text/css"}),a=t.href;t.href=URL.createObjectURL(s),a&&URL.revokeObjectURL(a)}.bind(null,r,e),i=function(){f(r),r.href&&URL.revokeObjectURL(r.href)}):(r=_(e),n=function(t,e){var r=e.css,n=e.media;n&&t.setAttribute("media",n);if(t.styleSheet)t.styleSheet.cssText=r;else{for(;t.firstChild;)t.removeChild(t.firstChild);t.appendChild(document.createTextNode(r))}}.bind(null,r),i=function(){f(r)});return n(t),function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap)return;n(t=e)}else i()}}t.exports=function(t,e){if("undefined"!=typeof DEBUG&&DEBUG&&"object"!=typeof document)throw new Error("The style-loader cannot be used in a non-browser environment");(e=e||{}).attrs="object"==typeof e.attrs?e.attrs:{},e.singleton||"boolean"==typeof e.singleton||(e.singleton=i()),e.insertInto||(e.insertInto="head"),e.insertAt||(e.insertAt="bottom");var r=m(t,e);return l(r,e),function(t){for(var i=[],o=0;o<r.length;o++){var s=r[o];(a=n[s.id]).refs--,i.push(a)}t&&l(m(t,e),e);for(o=0;o<i.length;o++){var a;if(0===(a=i[o]).refs){for(var u=0;u<a.parts.length;u++)a.parts[u]();delete n[a.id]}}}};var y=function(){var t=[];return function(e,r){return t[e]=r,t.filter(Boolean).join("\n")}}();function v(t,e,r,n){var i=r?"":n.css;if(t.styleSheet)t.styleSheet.cssText=y(e,i);else{var o=document.createTextNode(i),s=t.childNodes;s[e]&&t.removeChild(s[e]),s.length?t.insertBefore(o,s[e]):t.appendChild(o)}}},function(t,e){t.exports=function(t){var e=[];return e.toString=function(){return this.map(function(e){var r=function(t,e){var r=t[1]||"",n=t[3];if(!n)return r;if(e&&"function"==typeof btoa){var i=function(t){return"/*# sourceMappingURL=data:application/json;charset=utf-8;base64,"+btoa(unescape(encodeURIComponent(JSON.stringify(t))))+" */"}(n),o=n.sources.map(function(t){return"/*# sourceURL="+n.sourceRoot+t+" */"});return[r].concat(o).concat([i]).join("\n")}return[r].join("\n")}(e,t);return e[2]?"@media "+e[2]+"{"+r+"}":r}).join("")},e.i=function(t,r){"string"==typeof t&&(t=[[null,t,""]]);for(var n={},i=0;i<this.length;i++){var o=this[i][0];"number"==typeof o&&(n[o]=!0)}for(i=0;i<t.length;i++){var s=t[i];"number"==typeof s[0]&&n[s[0]]||(r&&!s[2]?s[2]=r:r&&(s[2]="("+s[2]+") and ("+r+")"),e.push(s))}},e}},function(t,e){t.exports=function(t){var e="undefined"!=typeof window&&window.location;if(!e)throw new Error("fixUrls requires window.location");if(!t||"string"!=typeof t)return t;var r=e.protocol+"//"+e.host,n=r+e.pathname.replace(/\/[^\/]*$/,"/");return t.replace(/url\s*\(((?:[^)(]|\((?:[^)(]+|\([^)(]*\))*\))*)\)/gi,function(t,e){var i,o=e.trim().replace(/^"(.*)"$/,function(t,e){return e}).replace(/^'(.*)'$/,function(t,e){return e});return/^(#|data:|http:\/\/|https:\/\/|file:\/\/\/)/i.test(o)?t:(i=0===o.indexOf("//")?o:0===o.indexOf("/")?r+o:n+o.replace(/^\.\//,""),"url("+JSON.stringify(i)+")")})}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.CoordinateConversions=e.TilemapTextureBuilder=void 0;var n=r(2),i=r(1);function o(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function s(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var a=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Object.assign(this,function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){o(t,e,r[e])})}return t}({tileWidth:8,tileHeight:8,width:256,height:1,layers:2},e)),this.copyIndex=0,this.texture=i.gl.createTexture(),i.gl.bindTexture(i.gl.TEXTURE_2D_ARRAY,this.texture),i.gl.texStorage3D(i.gl.TEXTURE_2D_ARRAY,1,i.gl.RGBA8,this.width*this.tileWidth,this.height*this.tileHeight,this.layers),i.gl.texParameteri(i.gl.TEXTURE_2D_ARRAY,i.gl.TEXTURE_MIN_FILTER,i.gl.NEAREST),i.gl.bindTexture(i.gl.TEXTURE_2D_ARRAY,null)}return function(t,e,r){e&&s(t.prototype,e),r&&s(t,r)}(t,[{key:"tileCoordinates",value:function(){return{x:this.copyIndex%this.width,y:Math.floor(this.copyIndex/this.width)%this.height,z:Math.floor(this.copyIndex/(this.width*this.height))%this.layers}}},{key:"addTiles",value:function(t){var e=this,r=this.detectWidthInTiles(t),n=this.detectHeightInTiles(t),o=document.createElement("canvas"),s=o.getContext("2d");o.width=t.width,o.height=t.height,s.drawImage(t,0,0);var a=function(t,r){var n=s.getImageData(t*e.tileWidth,r*e.tileHeight,e.tileWidth,e.tileHeight),o=e.tileCoordinates(),a=o.x,u=o.y,c=o.z;i.gl.texSubImage3D(i.gl.TEXTURE_2D_ARRAY,0,a*e.tileWidth,u*e.tileHeight,c,e.tileWidth,e.tileHeight,1,i.gl.RGBA,i.gl.UNSIGNED_BYTE,n),e.copyIndex++};i.gl.bindTexture(i.gl.TEXTURE_2D_ARRAY,this.texture),i.gl.pixelStorei(i.gl.UNPACK_FLIP_Y_WEBGL,1);for(var u=0;u<n;u++)for(var c=0;c<r&&!this.isFull();c++)a(c,u);i.gl.pixelStorei(i.gl.UNPACK_FLIP_Y_WEBGL,0),i.gl.bindTexture(i.gl.TEXTURE_2D_ARRAY,null)}},{key:"detectWidthInTiles",value:function(t){return Math.floor(t.width/this.tileWidth)}},{key:"detectHeightInTiles",value:function(t){return Math.floor(t.height/this.tileHeight)}},{key:"isFull",value:function(){return this.copyIndex>=this.maxIndex}},{key:"readback",value:function(){var t=new Uint8Array(this.layerWidth*this.layerHeight*4),e=i.gl.createFramebuffer(),r=[];i.gl.bindFramebuffer(i.gl.READ_FRAMEBUFFER,e);for(var n=0;n<this.layers;n++)i.gl.framebufferTextureLayer(i.gl.READ_FRAMEBUFFER,i.gl.COLOR_ATTACHMENT0,this.texture,0,n),i.gl.readPixels(0,0,this.layerWidth,this.layerHeight,i.gl.RGBA,i.gl.UNSIGNED_BYTE,t),r.push(new ImageData(new Uint8ClampedArray(t),this.layerWidth,this.layerHeight));return i.gl.bindFramebuffer(i.gl.READ_FRAMEBUFFER,null),r}},{key:"layerWidth",get:function(){return this.tileWidth*this.width}},{key:"layerHeight",get:function(){return this.tileHeight*this.height}},{key:"maxIndex",get:function(){return this.width*this.height*this.layers}}]),t}();e.TilemapTextureBuilder=a;var u={canvasToWorldMatrix:function(t,e,r){var i=n.mat4.create(),o=n.mat4.create();return n.mat4.multiply(i,n.mat4.fromValues(1,0,0,0,0,-1,0,0,0,0,1,0,0,e.height,1,1),i),n.mat4.fromScaling(o,[r.width/e.width,r.height/e.height,1]),n.mat4.multiply(i,o,i),n.mat4.invert(o,t),n.mat4.multiply(i,o,i),i}};e.CoordinateConversions=u},function(t,e,r){(function(t,r){var n;!function(){var i="object"==typeof self&&self.self===self&&self||"object"==typeof t&&t.global===t&&t||this||{},o=i._,s=Array.prototype,a=Object.prototype,u="undefined"!=typeof Symbol?Symbol.prototype:null,c=s.push,l=s.slice,m=a.toString,h=a.hasOwnProperty,f=Array.isArray,_=Object.keys,p=Object.create,d=function(){},y=function(t){return t instanceof y?t:this instanceof y?void(this._wrapped=t):new y(t)};void 0===e||e.nodeType?i._=y:(void 0!==r&&!r.nodeType&&r.exports&&(e=r.exports=y),e._=y),y.VERSION="1.9.1";var v,b=function(t,e,r){if(void 0===e)return t;switch(null==r?3:r){case 1:return function(r){return t.call(e,r)};case 3:return function(r,n,i){return t.call(e,r,n,i)};case 4:return function(r,n,i,o){return t.call(e,r,n,i,o)}}return function(){return t.apply(e,arguments)}},g=function(t,e,r){return y.iteratee!==v?y.iteratee(t,e):null==t?y.identity:y.isFunction(t)?b(t,e,r):y.isObject(t)&&!y.isArray(t)?y.matcher(t):y.property(t)};y.iteratee=v=function(t,e){return g(t,e,1/0)};var x=function(t,e){return e=null==e?t.length-1:+e,function(){for(var r=Math.max(arguments.length-e,0),n=Array(r),i=0;i<r;i++)n[i]=arguments[i+e];switch(e){case 0:return t.call(this,n);case 1:return t.call(this,arguments[0],n);case 2:return t.call(this,arguments[0],arguments[1],n)}var o=Array(e+1);for(i=0;i<e;i++)o[i]=arguments[i];return o[e]=n,t.apply(this,o)}},A=function(t){if(!y.isObject(t))return{};if(p)return p(t);d.prototype=t;var e=new d;return d.prototype=null,e},w=function(t){return function(e){return null==e?void 0:e[t]}},B=function(t,e){return null!=t&&h.call(t,e)},E=function(t,e){for(var r=e.length,n=0;n<r;n++){if(null==t)return;t=t[e[n]]}return r?t:void 0},M=Math.pow(2,53)-1,S=w("length"),T=function(t){var e=S(t);return"number"==typeof e&&e>=0&&e<=M};y.each=y.forEach=function(t,e,r){var n,i;if(e=b(e,r),T(t))for(n=0,i=t.length;n<i;n++)e(t[n],n,t);else{var o=y.keys(t);for(n=0,i=o.length;n<i;n++)e(t[o[n]],o[n],t)}return t},y.map=y.collect=function(t,e,r){e=g(e,r);for(var n=!T(t)&&y.keys(t),i=(n||t).length,o=Array(i),s=0;s<i;s++){var a=n?n[s]:s;o[s]=e(t[a],a,t)}return o};var I=function(t){return function(e,r,n,i){var o=arguments.length>=3;return function(e,r,n,i){var o=!T(e)&&y.keys(e),s=(o||e).length,a=t>0?0:s-1;for(i||(n=e[o?o[a]:a],a+=t);a>=0&&a<s;a+=t){var u=o?o[a]:a;n=r(n,e[u],u,e)}return n}(e,b(r,i,4),n,o)}};y.reduce=y.foldl=y.inject=I(1),y.reduceRight=y.foldr=I(-1),y.find=y.detect=function(t,e,r){var n=(T(t)?y.findIndex:y.findKey)(t,e,r);if(void 0!==n&&-1!==n)return t[n]},y.filter=y.select=function(t,e,r){var n=[];return e=g(e,r),y.each(t,function(t,r,i){e(t,r,i)&&n.push(t)}),n},y.reject=function(t,e,r){return y.filter(t,y.negate(g(e)),r)},y.every=y.all=function(t,e,r){e=g(e,r);for(var n=!T(t)&&y.keys(t),i=(n||t).length,o=0;o<i;o++){var s=n?n[o]:o;if(!e(t[s],s,t))return!1}return!0},y.some=y.any=function(t,e,r){e=g(e,r);for(var n=!T(t)&&y.keys(t),i=(n||t).length,o=0;o<i;o++){var s=n?n[o]:o;if(e(t[s],s,t))return!0}return!1},y.contains=y.includes=y.include=function(t,e,r,n){return T(t)||(t=y.values(t)),("number"!=typeof r||n)&&(r=0),y.indexOf(t,e,r)>=0},y.invoke=x(function(t,e,r){var n,i;return y.isFunction(e)?i=e:y.isArray(e)&&(n=e.slice(0,-1),e=e[e.length-1]),y.map(t,function(t){var o=i;if(!o){if(n&&n.length&&(t=E(t,n)),null==t)return;o=t[e]}return null==o?o:o.apply(t,r)})}),y.pluck=function(t,e){return y.map(t,y.property(e))},y.where=function(t,e){return y.filter(t,y.matcher(e))},y.findWhere=function(t,e){return y.find(t,y.matcher(e))},y.max=function(t,e,r){var n,i,o=-1/0,s=-1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,u=(t=T(t)?t:y.values(t)).length;a<u;a++)null!=(n=t[a])&&n>o&&(o=n);else e=g(e,r),y.each(t,function(t,r,n){((i=e(t,r,n))>s||i===-1/0&&o===-1/0)&&(o=t,s=i)});return o},y.min=function(t,e,r){var n,i,o=1/0,s=1/0;if(null==e||"number"==typeof e&&"object"!=typeof t[0]&&null!=t)for(var a=0,u=(t=T(t)?t:y.values(t)).length;a<u;a++)null!=(n=t[a])&&n<o&&(o=n);else e=g(e,r),y.each(t,function(t,r,n){((i=e(t,r,n))<s||i===1/0&&o===1/0)&&(o=t,s=i)});return o},y.shuffle=function(t){return y.sample(t,1/0)},y.sample=function(t,e,r){if(null==e||r)return T(t)||(t=y.values(t)),t[y.random(t.length-1)];var n=T(t)?y.clone(t):y.values(t),i=S(n);e=Math.max(Math.min(e,i),0);for(var o=i-1,s=0;s<e;s++){var a=y.random(s,o),u=n[s];n[s]=n[a],n[a]=u}return n.slice(0,e)},y.sortBy=function(t,e,r){var n=0;return e=g(e,r),y.pluck(y.map(t,function(t,r,i){return{value:t,index:n++,criteria:e(t,r,i)}}).sort(function(t,e){var r=t.criteria,n=e.criteria;if(r!==n){if(r>n||void 0===r)return 1;if(r<n||void 0===n)return-1}return t.index-e.index}),"value")};var P=function(t,e){return function(r,n,i){var o=e?[[],[]]:{};return n=g(n,i),y.each(r,function(e,i){var s=n(e,i,r);t(o,e,s)}),o}};y.groupBy=P(function(t,e,r){B(t,r)?t[r].push(e):t[r]=[e]}),y.indexBy=P(function(t,e,r){t[r]=e}),y.countBy=P(function(t,e,r){B(t,r)?t[r]++:t[r]=1});var C=/[^\ud800-\udfff]|[\ud800-\udbff][\udc00-\udfff]|[\ud800-\udfff]/g;y.toArray=function(t){return t?y.isArray(t)?l.call(t):y.isString(t)?t.match(C):T(t)?y.map(t,y.identity):y.values(t):[]},y.size=function(t){return null==t?0:T(t)?t.length:y.keys(t).length},y.partition=P(function(t,e,r){t[r?0:1].push(e)},!0),y.first=y.head=y.take=function(t,e,r){return null==t||t.length<1?null==e?void 0:[]:null==e||r?t[0]:y.initial(t,t.length-e)},y.initial=function(t,e,r){return l.call(t,0,Math.max(0,t.length-(null==e||r?1:e)))},y.last=function(t,e,r){return null==t||t.length<1?null==e?void 0:[]:null==e||r?t[t.length-1]:y.rest(t,Math.max(0,t.length-e))},y.rest=y.tail=y.drop=function(t,e,r){return l.call(t,null==e||r?1:e)},y.compact=function(t){return y.filter(t,Boolean)};var R=function(t,e,r,n){for(var i=(n=n||[]).length,o=0,s=S(t);o<s;o++){var a=t[o];if(T(a)&&(y.isArray(a)||y.isArguments(a)))if(e)for(var u=0,c=a.length;u<c;)n[i++]=a[u++];else R(a,e,r,n),i=n.length;else r||(n[i++]=a)}return n};y.flatten=function(t,e){return R(t,e,!1)},y.without=x(function(t,e){return y.difference(t,e)}),y.uniq=y.unique=function(t,e,r,n){y.isBoolean(e)||(n=r,r=e,e=!1),null!=r&&(r=g(r,n));for(var i=[],o=[],s=0,a=S(t);s<a;s++){var u=t[s],c=r?r(u,s,t):u;e&&!r?(s&&o===c||i.push(u),o=c):r?y.contains(o,c)||(o.push(c),i.push(u)):y.contains(i,u)||i.push(u)}return i},y.union=x(function(t){return y.uniq(R(t,!0,!0))}),y.intersection=function(t){for(var e=[],r=arguments.length,n=0,i=S(t);n<i;n++){var o=t[n];if(!y.contains(e,o)){var s;for(s=1;s<r&&y.contains(arguments[s],o);s++);s===r&&e.push(o)}}return e},y.difference=x(function(t,e){return e=R(e,!0,!0),y.filter(t,function(t){return!y.contains(e,t)})}),y.unzip=function(t){for(var e=t&&y.max(t,S).length||0,r=Array(e),n=0;n<e;n++)r[n]=y.pluck(t,n);return r},y.zip=x(y.unzip),y.object=function(t,e){for(var r={},n=0,i=S(t);n<i;n++)e?r[t[n]]=e[n]:r[t[n][0]]=t[n][1];return r};var F=function(t){return function(e,r,n){r=g(r,n);for(var i=S(e),o=t>0?0:i-1;o>=0&&o<i;o+=t)if(r(e[o],o,e))return o;return-1}};y.findIndex=F(1),y.findLastIndex=F(-1),y.sortedIndex=function(t,e,r,n){for(var i=(r=g(r,n,1))(e),o=0,s=S(t);o<s;){var a=Math.floor((o+s)/2);r(t[a])<i?o=a+1:s=a}return o};var D=function(t,e,r){return function(n,i,o){var s=0,a=S(n);if("number"==typeof o)t>0?s=o>=0?o:Math.max(o+a,s):a=o>=0?Math.min(o+1,a):o+a+1;else if(r&&o&&a)return n[o=r(n,i)]===i?o:-1;if(i!=i)return(o=e(l.call(n,s,a),y.isNaN))>=0?o+s:-1;for(o=t>0?s:a-1;o>=0&&o<a;o+=t)if(n[o]===i)return o;return-1}};y.indexOf=D(1,y.findIndex,y.sortedIndex),y.lastIndexOf=D(-1,y.findLastIndex),y.range=function(t,e,r){null==e&&(e=t||0,t=0),r||(r=e<t?-1:1);for(var n=Math.max(Math.ceil((e-t)/r),0),i=Array(n),o=0;o<n;o++,t+=r)i[o]=t;return i},y.chunk=function(t,e){if(null==e||e<1)return[];for(var r=[],n=0,i=t.length;n<i;)r.push(l.call(t,n,n+=e));return r};var L=function(t,e,r,n,i){if(!(n instanceof e))return t.apply(r,i);var o=A(t.prototype),s=t.apply(o,i);return y.isObject(s)?s:o};y.bind=x(function(t,e,r){if(!y.isFunction(t))throw new TypeError("Bind must be called on a function");var n=x(function(i){return L(t,n,e,this,r.concat(i))});return n}),y.partial=x(function(t,e){var r=y.partial.placeholder,n=function(){for(var i=0,o=e.length,s=Array(o),a=0;a<o;a++)s[a]=e[a]===r?arguments[i++]:e[a];for(;i<arguments.length;)s.push(arguments[i++]);return L(t,n,this,this,s)};return n}),y.partial.placeholder=y,y.bindAll=x(function(t,e){var r=(e=R(e,!1,!1)).length;if(r<1)throw new Error("bindAll must be passed function names");for(;r--;){var n=e[r];t[n]=y.bind(t[n],t)}}),y.memoize=function(t,e){var r=function(n){var i=r.cache,o=""+(e?e.apply(this,arguments):n);return B(i,o)||(i[o]=t.apply(this,arguments)),i[o]};return r.cache={},r},y.delay=x(function(t,e,r){return setTimeout(function(){return t.apply(null,r)},e)}),y.defer=y.partial(y.delay,y,1),y.throttle=function(t,e,r){var n,i,o,s,a=0;r||(r={});var u=function(){a=!1===r.leading?0:y.now(),n=null,s=t.apply(i,o),n||(i=o=null)},c=function(){var c=y.now();a||!1!==r.leading||(a=c);var l=e-(c-a);return i=this,o=arguments,l<=0||l>e?(n&&(clearTimeout(n),n=null),a=c,s=t.apply(i,o),n||(i=o=null)):n||!1===r.trailing||(n=setTimeout(u,l)),s};return c.cancel=function(){clearTimeout(n),a=0,n=i=o=null},c},y.debounce=function(t,e,r){var n,i,o=function(e,r){n=null,r&&(i=t.apply(e,r))},s=x(function(s){if(n&&clearTimeout(n),r){var a=!n;n=setTimeout(o,e),a&&(i=t.apply(this,s))}else n=y.delay(o,e,this,s);return i});return s.cancel=function(){clearTimeout(n),n=null},s},y.wrap=function(t,e){return y.partial(e,t)},y.negate=function(t){return function(){return!t.apply(this,arguments)}},y.compose=function(){var t=arguments,e=t.length-1;return function(){for(var r=e,n=t[e].apply(this,arguments);r--;)n=t[r].call(this,n);return n}},y.after=function(t,e){return function(){if(--t<1)return e.apply(this,arguments)}},y.before=function(t,e){var r;return function(){return--t>0&&(r=e.apply(this,arguments)),t<=1&&(e=null),r}},y.once=y.partial(y.before,2),y.restArguments=x;var O=!{toString:null}.propertyIsEnumerable("toString"),k=["valueOf","isPrototypeOf","toString","propertyIsEnumerable","hasOwnProperty","toLocaleString"],U=function(t,e){var r=k.length,n=t.constructor,i=y.isFunction(n)&&n.prototype||a,o="constructor";for(B(t,o)&&!y.contains(e,o)&&e.push(o);r--;)(o=k[r])in t&&t[o]!==i[o]&&!y.contains(e,o)&&e.push(o)};y.keys=function(t){if(!y.isObject(t))return[];if(_)return _(t);var e=[];for(var r in t)B(t,r)&&e.push(r);return O&&U(t,e),e},y.allKeys=function(t){if(!y.isObject(t))return[];var e=[];for(var r in t)e.push(r);return O&&U(t,e),e},y.values=function(t){for(var e=y.keys(t),r=e.length,n=Array(r),i=0;i<r;i++)n[i]=t[e[i]];return n},y.mapObject=function(t,e,r){e=g(e,r);for(var n=y.keys(t),i=n.length,o={},s=0;s<i;s++){var a=n[s];o[a]=e(t[a],a,t)}return o},y.pairs=function(t){for(var e=y.keys(t),r=e.length,n=Array(r),i=0;i<r;i++)n[i]=[e[i],t[e[i]]];return n},y.invert=function(t){for(var e={},r=y.keys(t),n=0,i=r.length;n<i;n++)e[t[r[n]]]=r[n];return e},y.functions=y.methods=function(t){var e=[];for(var r in t)y.isFunction(t[r])&&e.push(r);return e.sort()};var z=function(t,e){return function(r){var n=arguments.length;if(e&&(r=Object(r)),n<2||null==r)return r;for(var i=1;i<n;i++)for(var o=arguments[i],s=t(o),a=s.length,u=0;u<a;u++){var c=s[u];e&&void 0!==r[c]||(r[c]=o[c])}return r}};y.extend=z(y.allKeys),y.extendOwn=y.assign=z(y.keys),y.findKey=function(t,e,r){e=g(e,r);for(var n,i=y.keys(t),o=0,s=i.length;o<s;o++)if(e(t[n=i[o]],n,t))return n};var j,V,N=function(t,e,r){return e in r};y.pick=x(function(t,e){var r={},n=e[0];if(null==t)return r;y.isFunction(n)?(e.length>1&&(n=b(n,e[1])),e=y.allKeys(t)):(n=N,e=R(e,!1,!1),t=Object(t));for(var i=0,o=e.length;i<o;i++){var s=e[i],a=t[s];n(a,s,t)&&(r[s]=a)}return r}),y.omit=x(function(t,e){var r,n=e[0];return y.isFunction(n)?(n=y.negate(n),e.length>1&&(r=e[1])):(e=y.map(R(e,!1,!1),String),n=function(t,r){return!y.contains(e,r)}),y.pick(t,n,r)}),y.defaults=z(y.allKeys,!0),y.create=function(t,e){var r=A(t);return e&&y.extendOwn(r,e),r},y.clone=function(t){return y.isObject(t)?y.isArray(t)?t.slice():y.extend({},t):t},y.tap=function(t,e){return e(t),t},y.isMatch=function(t,e){var r=y.keys(e),n=r.length;if(null==t)return!n;for(var i=Object(t),o=0;o<n;o++){var s=r[o];if(e[s]!==i[s]||!(s in i))return!1}return!0},j=function(t,e,r,n){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return!1;if(t!=t)return e!=e;var i=typeof t;return("function"===i||"object"===i||"object"==typeof e)&&V(t,e,r,n)},V=function(t,e,r,n){t instanceof y&&(t=t._wrapped),e instanceof y&&(e=e._wrapped);var i=m.call(t);if(i!==m.call(e))return!1;switch(i){case"[object RegExp]":case"[object String]":return""+t==""+e;case"[object Number]":return+t!=+t?+e!=+e:0==+t?1/+t==1/e:+t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object Symbol]":return u.valueOf.call(t)===u.valueOf.call(e)}var o="[object Array]"===i;if(!o){if("object"!=typeof t||"object"!=typeof e)return!1;var s=t.constructor,a=e.constructor;if(s!==a&&!(y.isFunction(s)&&s instanceof s&&y.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1}r=r||[],n=n||[];for(var c=r.length;c--;)if(r[c]===t)return n[c]===e;if(r.push(t),n.push(e),o){if((c=t.length)!==e.length)return!1;for(;c--;)if(!j(t[c],e[c],r,n))return!1}else{var l,h=y.keys(t);if(c=h.length,y.keys(e).length!==c)return!1;for(;c--;)if(l=h[c],!B(e,l)||!j(t[l],e[l],r,n))return!1}return r.pop(),n.pop(),!0},y.isEqual=function(t,e){return j(t,e)},y.isEmpty=function(t){return null==t||(T(t)&&(y.isArray(t)||y.isString(t)||y.isArguments(t))?0===t.length:0===y.keys(t).length)},y.isElement=function(t){return!(!t||1!==t.nodeType)},y.isArray=f||function(t){return"[object Array]"===m.call(t)},y.isObject=function(t){var e=typeof t;return"function"===e||"object"===e&&!!t},y.each(["Arguments","Function","String","Number","Date","RegExp","Error","Symbol","Map","WeakMap","Set","WeakSet"],function(t){y["is"+t]=function(e){return m.call(e)==="[object "+t+"]"}}),y.isArguments(arguments)||(y.isArguments=function(t){return B(t,"callee")});var q=i.document&&i.document.childNodes;"function"!=typeof/./&&"object"!=typeof Int8Array&&"function"!=typeof q&&(y.isFunction=function(t){return"function"==typeof t||!1}),y.isFinite=function(t){return!y.isSymbol(t)&&isFinite(t)&&!isNaN(parseFloat(t))},y.isNaN=function(t){return y.isNumber(t)&&isNaN(t)},y.isBoolean=function(t){return!0===t||!1===t||"[object Boolean]"===m.call(t)},y.isNull=function(t){return null===t},y.isUndefined=function(t){return void 0===t},y.has=function(t,e){if(!y.isArray(e))return B(t,e);for(var r=e.length,n=0;n<r;n++){var i=e[n];if(null==t||!h.call(t,i))return!1;t=t[i]}return!!r},y.noConflict=function(){return i._=o,this},y.identity=function(t){return t},y.constant=function(t){return function(){return t}},y.noop=function(){},y.property=function(t){return y.isArray(t)?function(e){return E(e,t)}:w(t)},y.propertyOf=function(t){return null==t?function(){}:function(e){return y.isArray(e)?E(t,e):t[e]}},y.matcher=y.matches=function(t){return t=y.extendOwn({},t),function(e){return y.isMatch(e,t)}},y.times=function(t,e,r){var n=Array(Math.max(0,t));e=b(e,r,1);for(var i=0;i<t;i++)n[i]=e(i);return n},y.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},y.now=Date.now||function(){return(new Date).getTime()};var G={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},W=y.invert(G),Y=function(t){var e=function(e){return t[e]},r="(?:"+y.keys(t).join("|")+")",n=RegExp(r),i=RegExp(r,"g");return function(t){return t=null==t?"":""+t,n.test(t)?t.replace(i,e):t}};y.escape=Y(G),y.unescape=Y(W),y.result=function(t,e,r){y.isArray(e)||(e=[e]);var n=e.length;if(!n)return y.isFunction(r)?r.call(t):r;for(var i=0;i<n;i++){var o=null==t?void 0:t[e[i]];void 0===o&&(o=r,i=n),t=y.isFunction(o)?o.call(t):o}return t};var X=0;y.uniqueId=function(t){var e=++X+"";return t?t+e:e},y.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var K=/(.)^/,H={"'":"'","\\":"\\","\r":"r","\n":"n","\u2028":"u2028","\u2029":"u2029"},J=/\\|'|\r|\n|\u2028|\u2029/g,Z=function(t){return"\\"+H[t]};y.template=function(t,e,r){!e&&r&&(e=r),e=y.defaults({},e,y.templateSettings);var n,i=RegExp([(e.escape||K).source,(e.interpolate||K).source,(e.evaluate||K).source].join("|")+"|$","g"),o=0,s="__p+='";t.replace(i,function(e,r,n,i,a){return s+=t.slice(o,a).replace(J,Z),o=a+e.length,r?s+="'+\n((__t=("+r+"))==null?'':_.escape(__t))+\n'":n?s+="'+\n((__t=("+n+"))==null?'':__t)+\n'":i&&(s+="';\n"+i+"\n__p+='"),e}),s+="';\n",e.variable||(s="with(obj||{}){\n"+s+"}\n"),s="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+s+"return __p;\n";try{n=new Function(e.variable||"obj","_",s)}catch(t){throw t.source=s,t}var a=function(t){return n.call(this,t,y)},u=e.variable||"obj";return a.source="function("+u+"){\n"+s+"}",a},y.chain=function(t){var e=y(t);return e._chain=!0,e};var Q=function(t,e){return t._chain?y(e).chain():e};y.mixin=function(t){return y.each(y.functions(t),function(e){var r=y[e]=t[e];y.prototype[e]=function(){var t=[this._wrapped];return c.apply(t,arguments),Q(this,r.apply(y,t))}}),y},y.mixin(y),y.each(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=s[t];y.prototype[t]=function(){var r=this._wrapped;return e.apply(r,arguments),"shift"!==t&&"splice"!==t||0!==r.length||delete r[0],Q(this,r)}}),y.each(["concat","join","slice"],function(t){var e=s[t];y.prototype[t]=function(){return Q(this,e.apply(this._wrapped,arguments))}}),y.prototype.value=function(){return this._wrapped},y.prototype.valueOf=y.prototype.toJSON=y.prototype.value,y.prototype.toString=function(){return String(this._wrapped)},void 0===(n=function(){return y}.apply(e,[]))||(r.exports=n)}()}).call(this,r(10),r(37)(t))},function(t,e){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,Object.prototype.propertyIsEnumerable;t.exports=function(t,e){for(var r in null!==t&&void 0!==t||(t={}),e)e.hasOwnProperty(r)&&void 0===t[r]&&(t[r]=e[r]);if("function"==typeof Object.getOwnPropertySymbols)for(var n=Object.getOwnPropertySymbols(e),i=0;i<n.length;i++){var o=n[i];e.propertyIsEnumerable(o)&&void 0===t[r]&&(t[o]=e[o])}return t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Camera=void 0;var n=r(2);function i(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var s=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this._translation=n.vec2.create(),this._bounds=e}return function(t,e,r){e&&o(t.prototype,e),r&&o(t,r)}(t,[{key:"centerAt",value:function(t,e){return this._translation.set([-(t-this._bounds.width/2),-(e-this._bounds.height/2)]),this}},{key:"translate",value:function(t,e){return n.vec2.sub(this._translation,this._translation,[t,e]),this}},{key:"position",get:function(){return n.vec2.clone(this._translation)}},{key:"translation",get:function(){return this.position}},{key:"matrix",get:function(){return n.mat4.fromTranslation(n.mat4.create(),n.vec4.fromValues.apply(n.vec4,i(this._translation).concat([0,1])))}}]),t}();e.Camera=s},,function(t,e,r){(t.exports=r(24)(!1)).push([t.i,"html {\n    height: 100%;\n    background-color: #555;\n    color: #eee;\n    font-family: monospace;\n}\n\nbody {\n    padding: 0;\n    margin: 0;\n    height: 100%;\n}\n\n#content {\n    width: 100%;\n    display: flex;\n    align-items: center;\n    justify-content: center;\n    flex-direction: column;\n}\n\ncanvas.game {\n    width: 100vw;\n    height: 100vh;\n}\n",""])},function(t,e,r){var n=r(31);"string"==typeof n&&(n=[[t.i,n,""]]);var i={hmr:!0,transform:void 0};r(23)(n,i);n.locals&&(t.exports=n.locals)},function(t,e){t.exports="#version 300 es\n\nprecision mediump float;\n\nout vec4 out_color;\n\nin vec2 v_tex_coord;\n\nuniform sampler2D texture;\n\nvoid main() {\n    float line = v_tex_coord.y - floor(v_tex_coord.y);\n\n    vec4 texel = texelFetch(texture, ivec2(v_tex_coord), 0).xyzw;\n    out_color = texel; //vec4(texel.xyz * (line >= 0.5 ? 1. : .25), texel.w);\n}\n"},function(t,e){t.exports="#version 300 es\n\nlayout(location = 0) in vec2 vertex;\nlayout(location = 1) in vec2 position;\nlayout(location = 2) in vec2 size;\nlayout(location = 3) in ivec2 texcoord;\nlayout(location = 4) in vec2 offset;\n\nout vec2 v_tex_coord;\n\nuniform mat4 projection;\n\n/*\n\nConvert coordinates from world space to clip space\n\n 1. Scale [0, dim] -> [-1, 1] where dim is screen width or height\n    dim pixels = 2 clip\n    clip / pixels = 2 / dim\n    x' = 2 * x / width - 1\n    y' = 2 * y / height - 1\n\n    2/w  0   0   -1\n     0  2/h  0   -1\n     0   0   1    0\n     0   0   0    1\n*/\n\nvoid main() {\n    vec4 transformed_position = projection * vec4(position + size * (vertex - offset), 0, 1);\n    gl_Position = transformed_position;\n    v_tex_coord = vec2(texcoord * ivec2(size));\n}\n"},function(t,e){WebGLDebugUtils=function(){var t=function(t){window.console&&window.console.error?window.console.error(t):function(t){window.console&&window.console.log&&window.console.log(t)}(t)},e={enable:{1:{0:!0}},disable:{1:{0:!0}},getParameter:{1:{0:!0}},drawArrays:{3:{0:!0}},drawElements:{4:{0:!0,2:!0}},createShader:{1:{0:!0}},getShaderParameter:{2:{1:!0}},getProgramParameter:{2:{1:!0}},getShaderPrecisionFormat:{2:{0:!0,1:!0}},getVertexAttrib:{2:{1:!0}},vertexAttribPointer:{6:{2:!0}},bindTexture:{2:{0:!0}},activeTexture:{1:{0:!0}},getTexParameter:{2:{0:!0,1:!0}},texParameterf:{3:{0:!0,1:!0}},texParameteri:{3:{0:!0,1:!0,2:!0}},copyTexImage2D:{8:{0:!0,2:!0}},copyTexSubImage2D:{8:{0:!0}},generateMipmap:{1:{0:!0}},bindBuffer:{2:{0:!0}},getBufferParameter:{2:{0:!0,1:!0}},pixelStorei:{2:{0:!0,1:!0}},bindRenderbuffer:{2:{0:!0}},bindFramebuffer:{2:{0:!0}},checkFramebufferStatus:{1:{0:!0}},framebufferRenderbuffer:{4:{0:!0,1:!0,2:!0}},framebufferTexture2D:{5:{0:!0,1:!0,2:!0}},getFramebufferAttachmentParameter:{3:{0:!0,1:!0,2:!0}},getRenderbufferParameter:{2:{0:!0,1:!0}},renderbufferStorage:{4:{0:!0,1:!0}},clear:{1:{0:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]}}},depthFunc:{1:{0:!0}},blendFunc:{2:{0:!0,1:!0}},blendFuncSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},blendEquation:{1:{0:!0}},blendEquationSeparate:{2:{0:!0,1:!0}},stencilFunc:{3:{0:!0}},stencilFuncSeparate:{4:{0:!0,1:!0}},stencilMaskSeparate:{2:{0:!0}},stencilOp:{3:{0:!0,1:!0,2:!0}},stencilOpSeparate:{4:{0:!0,1:!0,2:!0,3:!0}},cullFace:{1:{0:!0}},frontFace:{1:{0:!0}},drawArraysInstancedANGLE:{4:{0:!0}},drawElementsInstancedANGLE:{5:{0:!0,2:!0}},blendEquationEXT:{1:{0:!0}},bufferData:{3:{0:!0,2:!0},4:{0:!0,2:!0},5:{0:!0,2:!0}},bufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},copyBufferSubData:{5:{0:!0,1:!0}},getBufferSubData:{3:{0:!0},4:{0:!0},5:{0:!0}},blitFramebuffer:{10:{8:{enumBitwiseOr:["COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","STENCIL_BUFFER_BIT"]},9:!0}},framebufferTextureLayer:{5:{0:!0,1:!0}},invalidateFramebuffer:{2:{0:!0}},invalidateSubFramebuffer:{6:{0:!0}},readBuffer:{1:{0:!0}},getInternalformatParameter:{3:{0:!0,1:!0,2:!0}},renderbufferStorageMultisample:{5:{0:!0,2:!0}},texStorage2D:{5:{0:!0,2:!0}},texStorage3D:{6:{0:!0,2:!0}},texImage2D:{9:{0:!0,2:!0,6:!0,7:!0},6:{0:!0,2:!0,3:!0,4:!0},10:{0:!0,2:!0,6:!0,7:!0}},texImage3D:{10:{0:!0,2:!0,7:!0,8:!0},11:{0:!0,2:!0,7:!0,8:!0}},texSubImage2D:{9:{0:!0,6:!0,7:!0},7:{0:!0,4:!0,5:!0},10:{0:!0,6:!0,7:!0}},texSubImage3D:{11:{0:!0,8:!0,9:!0},12:{0:!0,8:!0,9:!0}},copyTexSubImage3D:{9:{0:!0}},compressedTexImage2D:{7:{0:!0,2:!0},8:{0:!0,2:!0},9:{0:!0,2:!0}},compressedTexImage3D:{8:{0:!0,2:!0},9:{0:!0,2:!0},10:{0:!0,2:!0}},compressedTexSubImage2D:{8:{0:!0,6:!0},9:{0:!0,6:!0},10:{0:!0,6:!0}},compressedTexSubImage3D:{10:{0:!0,8:!0},11:{0:!0,8:!0},12:{0:!0,8:!0}},vertexAttribIPointer:{5:{2:!0}},drawArraysInstanced:{4:{0:!0}},drawElementsInstanced:{5:{0:!0,2:!0}},drawRangeElements:{6:{0:!0,4:!0}},readPixels:{7:{4:!0,5:!0},8:{4:!0,5:!0}},clearBufferfv:{3:{0:!0},4:{0:!0}},clearBufferiv:{3:{0:!0},4:{0:!0}},clearBufferuiv:{3:{0:!0},4:{0:!0}},clearBufferfi:{4:{0:!0}},beginQuery:{2:{0:!0}},endQuery:{1:{0:!0}},getQuery:{2:{0:!0,1:!0}},getQueryParameter:{2:{1:!0}},samplerParameteri:{3:{1:!0,2:!0}},samplerParameterf:{3:{1:!0}},getSamplerParameter:{2:{1:!0}},fenceSync:{2:{0:!0,1:{enumBitwiseOr:[]}}},clientWaitSync:{3:{1:{enumBitwiseOr:["SYNC_FLUSH_COMMANDS_BIT"]}}},waitSync:{3:{1:{enumBitwiseOr:[]}}},getSyncParameter:{2:{1:!0}},bindTransformFeedback:{2:{0:!0}},beginTransformFeedback:{1:{0:!0}},transformFeedbackVaryings:{3:{2:!0}},bindBufferBase:{3:{0:!0}},bindBufferRange:{5:{0:!0}},getIndexedParameter:{2:{0:!0}},getActiveUniforms:{3:{2:!0}},getActiveUniformBlockParameter:{3:{2:!0}}},r=null,n=null;function i(t){if(null==r)for(var e in r={},n={},t)"number"==typeof t[e]&&(r[t[e]]=e,n[e]=t[e])}function o(){if(null==r)throw"WebGLDebugUtils.init(ctx) not called"}function s(t){o();var e=r[t];return void 0!==e?"gl."+e:"/*UNKNOWN WebGL ENUM*/ 0x"+t.toString(16)}function a(t,r,i,o){var a;if(void 0!==(a=e[t])&&(void 0!==(a=a[r])&&a[i])){if("object"==typeof a[i]&&void 0!==a[i].enumBitwiseOr){for(var u=a[i].enumBitwiseOr,c=0,l=[],m=0;m<u.length;++m){var h=n[u[m]];0!=(o&h)&&(c|=h,l.push(s(h)))}return c===o?l.join(" | "):s(o)}return s(o)}return null===o?"null":void 0===o?"undefined":o.toString()}function u(t,e,r){t.__defineGetter__(r,function(){return e[r]}),t.__defineSetter__(r,function(t){e[r]=t})}function c(t){var e=!!t.createTransformFeedback;e&&t.bindVertexArray(null);var r=t.getParameter(t.MAX_VERTEX_ATTRIBS),n=t.createBuffer();t.bindBuffer(t.ARRAY_BUFFER,n);for(var i=0;i<r;++i)t.disableVertexAttribArray(i),t.vertexAttribPointer(i,4,t.FLOAT,!1,0,0),t.vertexAttrib1f(i,0),e&&t.vertexAttribDivisor(i,0);t.deleteBuffer(n);var o=t.getParameter(t.MAX_TEXTURE_IMAGE_UNITS);for(i=0;i<o;++i)t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_CUBE_MAP,null),t.bindTexture(t.TEXTURE_2D,null),e&&(t.bindTexture(t.TEXTURE_2D_ARRAY,null),t.bindTexture(t.TEXTURE_3D,null),t.bindSampler(i,null));if(t.activeTexture(t.TEXTURE0),t.useProgram(null),t.bindBuffer(t.ARRAY_BUFFER,null),t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,null),t.bindFramebuffer(t.FRAMEBUFFER,null),t.bindRenderbuffer(t.RENDERBUFFER,null),t.disable(t.BLEND),t.disable(t.CULL_FACE),t.disable(t.DEPTH_TEST),t.disable(t.DITHER),t.disable(t.SCISSOR_TEST),t.blendColor(0,0,0,0),t.blendEquation(t.FUNC_ADD),t.blendFunc(t.ONE,t.ZERO),t.clearColor(0,0,0,0),t.clearDepth(1),t.clearStencil(-1),t.colorMask(!0,!0,!0,!0),t.cullFace(t.BACK),t.depthFunc(t.LESS),t.depthMask(!0),t.depthRange(0,1),t.frontFace(t.CCW),t.hint(t.GENERATE_MIPMAP_HINT,t.DONT_CARE),t.lineWidth(1),t.pixelStorei(t.PACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_ALIGNMENT,4),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,!1),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,!1),t.UNPACK_COLORSPACE_CONVERSION_WEBGL&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,t.BROWSER_DEFAULT_WEBGL),t.polygonOffset(0,0),t.sampleCoverage(1,!1),t.scissor(0,0,t.canvas.width,t.canvas.height),t.stencilFunc(t.ALWAYS,0,4294967295),t.stencilMask(4294967295),t.stencilOp(t.KEEP,t.KEEP,t.KEEP),t.viewport(0,0,t.canvas.width,t.canvas.height),t.clear(t.COLOR_BUFFER_BIT|t.DEPTH_BUFFER_BIT|t.STENCIL_BUFFER_BIT),e){t.drawBuffers([t.BACK]),t.readBuffer(t.BACK),t.bindBuffer(t.COPY_READ_BUFFER,null),t.bindBuffer(t.COPY_WRITE_BUFFER,null),t.bindBuffer(t.PIXEL_PACK_BUFFER,null),t.bindBuffer(t.PIXEL_UNPACK_BUFFER,null);var s=t.getParameter(t.MAX_TRANSFORM_FEEDBACK_SEPARATE_ATTRIBS);for(i=0;i<s;++i)t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,i,null);var a=t.getParameter(t.MAX_UNIFORM_BUFFER_BINDINGS);for(i=0;i<a;++i)t.bindBufferBase(t.UNIFORM_BUFFER,i,null);t.disable(t.RASTERIZER_DISCARD),t.pixelStorei(t.UNPACK_IMAGE_HEIGHT,0),t.pixelStorei(t.UNPACK_SKIP_IMAGES,0),t.pixelStorei(t.UNPACK_ROW_LENGTH,0),t.pixelStorei(t.UNPACK_SKIP_ROWS,0),t.pixelStorei(t.UNPACK_SKIP_PIXELS,0),t.pixelStorei(t.PACK_ROW_LENGTH,0),t.pixelStorei(t.PACK_SKIP_ROWS,0),t.pixelStorei(t.PACK_SKIP_PIXELS,0),t.hint(t.FRAGMENT_SHADER_DERIVATIVE_HINT,t.DONT_CARE)}for(;t.getError(););}return{init:i,mightBeEnum:function(t){return o(),void 0!==r[t]},glEnumToString:s,glFunctionArgToString:a,glFunctionArgsToString:function(t,e){for(var r="",n=e.length,i=0;i<n;++i)r+=(0==i?"":", ")+a(t,n,i,e[i]);return r},makeDebugContext:function e(r,n,o,c){c=c||r,i(r),n=n||function(e,r,n){for(var i="",o=n.length,u=0;u<o;++u)i+=(0==u?"":", ")+a(r,o,u,n[u]);t("WebGL error "+s(e)+" in "+r+"("+i+")")};var l={};function m(t,e){return function(){o&&o(e,arguments);var r=t[e].apply(t,arguments),i=c.getError();return 0!=i&&(l[i]=!0,n(i,e,arguments)),r}}var h={};for(var f in r)if("function"==typeof r[f])if("getExtension"!=f)h[f]=m(r,f);else{var _=m(r,f);h[f]=function(){var t=_.apply(r,arguments);return t?e(t,n,o,c):null}}else u(h,r,f);return h.getError=function(){for(var t in l)if(l.hasOwnProperty(t)&&l[t])return l[t]=!1,t;return r.NO_ERROR},h},makeLostContextSimulatingCanvas:function(t){var e,r,n=[],i=[],o={},s=1,a=!1,l=[],m=0,h=0,f=!1,_=0,p={};function d(t){return"function"==typeof t?t:function(e){t.handleEvent(e)}}t.getContext=function(n){return function(){var i=n.apply(t,arguments);if(i instanceof WebGLRenderingContext||window.WebGL2RenderingContext&&i instanceof WebGL2RenderingContext){if(i!=e){if(e)throw"got different context";r=window.WebGL2RenderingContext&&i instanceof WebGL2RenderingContext,o=function(t){for(var n in t)"function"==typeof t[n]?o[n]=g(t,n):u(o,t,n);o.getError=function(){if(b(),!a)for(;t=e.getError();)p[t]=!0;for(var t in p)if(p[t])return delete p[t],t;return o.NO_ERROR};var i=["createBuffer","createFramebuffer","createProgram","createRenderbuffer","createShader","createTexture"];r&&i.push("createQuery","createSampler","fenceSync","createTransformFeedback","createVertexArray");for(var c=0;c<i.length;++c){var m=i[c];o[m]=function(e){return function(){if(b(),a)return null;var r=e.apply(t,arguments);return r.__webglDebugContextLostId__=s,l.push(r),r}}(t[m])}var h=["getActiveAttrib","getActiveUniform","getBufferParameter","getContextAttributes","getAttachedShaders","getFramebufferAttachmentParameter","getParameter","getProgramParameter","getProgramInfoLog","getRenderbufferParameter","getShaderParameter","getShaderInfoLog","getShaderSource","getTexParameter","getUniform","getUniformLocation","getVertexAttrib"];r&&h.push("getInternalformatParameter","getQuery","getQueryParameter","getSamplerParameter","getSyncParameter","getTransformFeedbackVarying","getIndexedParameter","getUniformIndices","getActiveUniforms","getActiveUniformBlockParameter","getActiveUniformBlockName");for(var c=0;c<h.length;++c){var m=h[c];o[m]=function(e){return function(){return b(),a?null:e.apply(t,arguments)}}(o[m])}var f=["isBuffer","isEnabled","isFramebuffer","isProgram","isRenderbuffer","isShader","isTexture"];r&&f.push("isQuery","isSampler","isSync","isTransformFeedback","isVertexArray");for(var c=0;c<f.length;++c){var m=f[c];o[m]=function(e){return function(){return b(),!a&&e.apply(t,arguments)}}(o[m])}return o.checkFramebufferStatus=function(e){return function(){return b(),a?o.FRAMEBUFFER_UNSUPPORTED:e.apply(t,arguments)}}(o.checkFramebufferStatus),o.getAttribLocation=function(e){return function(){return b(),a?-1:e.apply(t,arguments)}}(o.getAttribLocation),o.getVertexAttribOffset=function(e){return function(){return b(),a?0:e.apply(t,arguments)}}(o.getVertexAttribOffset),o.isContextLost=function(){return a},r&&(o.getFragDataLocation=function(e){return function(){return b(),a?-1:e.apply(t,arguments)}}(o.getFragDataLocation),o.clientWaitSync=function(e){return function(){return b(),a?o.WAIT_FAILED:e.apply(t,arguments)}}(o.clientWaitSync),o.getUniformBlockIndex=function(e){return function(){return b(),a?o.INVALID_INDEX:e.apply(t,arguments)}}(o.getUniformBlockIndex)),o}(e=i)}return o}return i}}(t.getContext);var y=function(t){n.push(d(t))},v=function(t){i.push(d(t))};function b(){++h,a||m==h&&t.loseContext()}function g(t,e){var r=t[e];return function(){if(b(),!a)return r.apply(t,arguments)}}function x(t){return{statusMessage:t,preventDefault:function(){f=!0}}}return function(t){var e=t.addEventListener;t.addEventListener=function(r,n,i){switch(r){case"webglcontextlost":y(n);break;case"webglcontextrestored":v(n);break;default:e.apply(t,arguments)}}}(t),t.loseContext=function(){if(!a){for(a=!0,m=0,++s;e.getError(););!function(){for(var t=Object.keys(p),e=0;e<t.length;++e)delete p[t[e]]}(),p[e.CONTEXT_LOST_WEBGL]=!0;var r=x("context lost"),i=n.slice();setTimeout(function(){for(var e=0;e<i.length;++e)i[e](r);_>=0&&setTimeout(function(){t.restoreContext()},_)},0)}},t.restoreContext=function(){a&&i.length&&setTimeout(function(){if(!f)throw"can not restore. webglcontestlost listener did not call event.preventDefault";!function(){for(var t=0;t<l.length;++t){var n=l[t];n instanceof WebGLBuffer?e.deleteBuffer(n):n instanceof WebGLFramebuffer?e.deleteFramebuffer(n):n instanceof WebGLProgram?e.deleteProgram(n):n instanceof WebGLRenderbuffer?e.deleteRenderbuffer(n):n instanceof WebGLShader?e.deleteShader(n):n instanceof WebGLTexture?e.deleteTexture(n):r&&(n instanceof WebGLQuery?e.deleteQuery(n):n instanceof WebGLSampler?e.deleteSampler(n):n instanceof WebGLSync?e.deleteSync(n):n instanceof WebGLTransformFeedback?e.deleteTransformFeedback(n):n instanceof WebGLVertexArrayObject&&e.deleteVertexArray(n))}}(),c(e),a=!1,h=0,f=!1;for(var t=i.slice(),n=x("context restored"),o=0;o<t.length;++o)t[o](n)},0)},t.loseContextInNCalls=function(t){if(a)throw"You can not ask a lost contet to be lost";m=h+t},t.getNumCalls=function(){return h},t.setRestoreTimeout=function(t){_=t},t},resetToInitialState:c}}()},function(t,e,r){
/*!
 * @license twgl.js 4.4.0 Copyright (c) 2015, Gregg Tavares All Rights Reserved.
 * Available via the MIT license.
 * see: http://github.com/greggman/twgl.js for details
 */
!function(e,r){t.exports=r()}("undefined"!=typeof self&&self,function(){return function(t){var e={};function r(n){if(e[n])return e[n].exports;var i=e[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}return r.m=t,r.c=e,r.d=function(t,e,n){r.o(t,e)||Object.defineProperty(t,e,{configurable:!1,enumerable:!0,get:n})},r.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return r.d(e,"a",e),e},r.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},r.p="",r(r.s=9)}([function(t,e,r){"use strict";e.__esModule=!0,e.copyExistingProperties=function(t,e){Object.keys(e).forEach(function(r){e.hasOwnProperty(r)&&t.hasOwnProperty(r)&&(e[r]=t[r])})},e.copyNamedProperties=function(t,e,r){t.forEach(function(t){var n=e[t];void 0!==n&&(r[t]=n)})},e.isBuffer=function(t,e){o||(o=t.createBuffer());return e instanceof o.constructor},e.isRenderbuffer=function(t,e){s||(s=t.createRenderbuffer());return e instanceof s.constructor},e.isShader=function(t,e){a||(a=t.createShader(t.VERTEX_SHADER));return e instanceof a.constructor},e.isTexture=function(t,e){u||(u=t.createTexture());return e instanceof u.constructor},e.isSampler=function(t,e){if(!c){if(!t.createSampler)return!1;c=t.createSampler()}return e instanceof c.constructor},e.warn=e.error=void 0;var n=function(t){return t&&t.__esModule?t:{default:t}}(r(2));var i=n.default.console&&n.default.console.error&&"function"==typeof n.default.console.error?n.default.console.error.bind(n.default.console):function(){};e.error=i;var o,s,a,u,c,l=n.default.console&&n.default.console.warn&&"function"==typeof n.default.console.warn?n.default.console.warn.bind(n.default.console):function(){};e.warn=l},function(t,e,r){"use strict";e.__esModule=!0,e.getGLTypeForTypedArray=function(t){if(t instanceof Int8Array)return i;if(t instanceof Uint8Array)return o;if(t instanceof Uint8ClampedArray)return o;if(t instanceof Int16Array)return s;if(t instanceof Uint16Array)return a;if(t instanceof Int32Array)return u;if(t instanceof Uint32Array)return c;if(t instanceof Float32Array)return l;throw"unsupported typed array type"},e.getGLTypeForTypedArrayType=function(t){if(t===Int8Array)return i;if(t===Uint8Array)return o;if(t===Uint8ClampedArray)return o;if(t===Int16Array)return s;if(t===Uint16Array)return a;if(t===Int32Array)return u;if(t===Uint32Array)return c;if(t===Float32Array)return l;throw"unsupported typed array type"},e.getTypedArrayTypeForGLType=function(t){var e=m[t];if(!e)throw"unknown gl type";return e},e.isArrayBuffer=void 0;var n=function(t){return t&&t.__esModule?t:{default:t}}(r(2));var i=5120,o=5121,s=5122,a=5123,u=5124,c=5125,l=5126,m={},h=m;h[i]=Int8Array,h[o]=Uint8Array,h[s]=Int16Array,h[a]=Uint16Array,h[u]=Int32Array,h[c]=Uint32Array,h[l]=Float32Array,h[32819]=Uint16Array,h[32820]=Uint16Array,h[33635]=Uint16Array,h[5131]=Uint16Array,h[33640]=Uint32Array,h[35899]=Uint32Array,h[35902]=Uint32Array,h[36269]=Uint32Array,h[34042]=Uint32Array;var f=n.default.SharedArrayBuffer?function(t){return t&&t.buffer&&(t.buffer instanceof ArrayBuffer||t.buffer instanceof n.default.SharedArrayBuffer)}:function(t){return t&&t.buffer&&t.buffer instanceof ArrayBuffer};e.isArrayBuffer=f},function(t,e,r){"use strict";e.__esModule=!0,e.default=void 0;var n=void 0!==n?n:"undefined"!=typeof self?self:"undefined"!=typeof window?window:{};e.default=n},function(t,e,r){"use strict";e.__esModule=!0,e.add=function(t,e,r){return(r=r||new n(3))[0]=t[0]+e[0],r[1]=t[1]+e[1],r[2]=t[2]+e[2],r},e.copy=function(t,e){return(e=e||new n(3))[0]=t[0],e[1]=t[1],e[2]=t[2],e},e.create=function(t,e,r){var i=new n(3);t&&(i[0]=t);e&&(i[1]=e);r&&(i[2]=r);return i},e.cross=function(t,e,r){r=r||new n(3);var i=t[2]*e[0]-t[0]*e[2],o=t[0]*e[1]-t[1]*e[0];return r[0]=t[1]*e[2]-t[2]*e[1],r[1]=i,r[2]=o,r},e.distance=function(t,e){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return Math.sqrt(r*r+n*n+i*i)},e.distanceSq=function(t,e){var r=t[0]-e[0],n=t[1]-e[1],i=t[2]-e[2];return r*r+n*n+i*i},e.divide=function(t,e,r){return(r=r||new n(3))[0]=t[0]/e[0],r[1]=t[1]/e[1],r[2]=t[2]/e[2],r},e.divScalar=function(t,e,r){return(r=r||new n(3))[0]=t[0]/e,r[1]=t[1]/e,r[2]=t[2]/e,r},e.dot=function(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]},e.lerp=function(t,e,r,i){return(i=i||new n(3))[0]=(1-r)*t[0]+r*e[0],i[1]=(1-r)*t[1]+r*e[1],i[2]=(1-r)*t[2]+r*e[2],i},e.length=function(t){return Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2])},e.lengthSq=function(t){return t[0]*t[0]+t[1]*t[1]+t[2]*t[2]},e.mulScalar=function(t,e,r){return(r=r||new n(3))[0]=t[0]*e,r[1]=t[1]*e,r[2]=t[2]*e,r},e.multiply=function(t,e,r){return(r=r||new n(3))[0]=t[0]*e[0],r[1]=t[1]*e[1],r[2]=t[2]*e[2],r},e.negate=function(t,e){return(e=e||new n(3))[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e},e.normalize=function(t,e){e=e||new n(3);var r=t[0]*t[0]+t[1]*t[1]+t[2]*t[2],i=Math.sqrt(r);i>1e-5?(e[0]=t[0]/i,e[1]=t[1]/i,e[2]=t[2]/i):(e[0]=0,e[1]=0,e[2]=0);return e},e.setDefaultType=function(t){var e=n;return n=t,e},e.subtract=function(t,e,r){return(r=r||new n(3))[0]=t[0]-e[0],r[1]=t[1]-e[1],r[2]=t[2]-e[2],r};var n=Float32Array},function(t,e,r){"use strict";e.__esModule=!0,e.isWebGL1=function(t){return!t.texStorage2D},e.isWebGL2=function(t){return!!t.texStorage2D},e.glEnumToString=void 0;var n=function(){var t={},e={};return function(r,n){return function(r){var n=r.constructor.name;if(!t[n]){for(var i in r)if("number"==typeof r[i]){var o=e[r[i]];e[r[i]]=o?"".concat(o," | ").concat(i):i}t[n]=!0}}(r),e[n]||"0x"+n.toString(16)}}();e.glEnumToString=n},function(t,e,r){"use strict";e.__esModule=!0,e.createAttributeSetters=V,e.createProgram=P,e.createProgramFromScripts=function(t,e,r,n,i){for(var o=M(r,n,i),s=[],a=0;a<e.length;++a){var u=C(t,e[a],t[S[a]],o.errorCallback);if(!u)return null;s.push(u)}return P(t,s,o)},e.createProgramFromSources=R,e.createProgramInfo=function(t,e,r,n,i){var o=M(r,n,i),s=!0;if(e=e.map(function(t){if(t.indexOf("\n")<0){var e=c(t);e?t=e.text:(o.errorCallback("no element with id: "+t),s=!1)}return t}),!s)return null;var a=R(t,e,o);if(!a)return null;return q(t,a)},e.createProgramInfoFromProgram=q,e.createUniformSetters=D,e.createUniformBlockSpecFromProgram=k,e.createUniformBlockInfoFromProgram=z,e.createUniformBlockInfo=function(t,e,r){return z(t,e.program,e.uniformBlockSpec,r)},e.createTransformFeedback=function(t,e,r){var n=t.createTransformFeedback();return t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,n),t.useProgram(e.program),O(t,e,r),t.bindTransformFeedback(t.TRANSFORM_FEEDBACK,null),function(t,e,r){for(var n in e.transformFeedbackInfo&&(e=e.transformFeedbackInfo),r.attribs&&(r=r.attribs),r){var i=e[n];i&&t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,i.index,null)}}(t,e,r),n},e.createTransformFeedbackInfo=L,e.bindTransformFeedbackInfo=O,e.setAttributes=N,e.setBuffersAndAttributes=function(t,e,r){r.vertexArrayObject?t.bindVertexArray(r.vertexArrayObject):(N(e.attribSetters||e,r.attribs),r.indices&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,r.indices))},e.setUniforms=function t(e,r){var n=e.uniformSetters||e;var i=arguments.length;for(var o=1;o<i;++o){var s=arguments[o];if(Array.isArray(s))for(var a=s.length,u=0;u<a;++u)t(n,s[u]);else for(var c in s){var l=n[c];l&&l(s[c])}}},e.setUniformBlock=function(t,e,r){j(t,e,r)&&t.bufferData(t.UNIFORM_BUFFER,r.array,t.DYNAMIC_DRAW)},e.setBlockUniforms=function(t,e){var r=t.uniforms;for(var n in e){var i=r[n];if(i){var o=e[n];o.length?i.set(o):i[0]=o}}},e.bindUniformBlock=j;var n=s(r(4)),i=s(r(0)),o=function(t){return t&&t.__esModule?t:{default:t}}(r(2));function s(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}var a=i.error,u=i.warn,c=o.default&&o.default.document&&o.default.document.getElementById?o.default.document.getElementById.bind(o.default.document):function(){return null},l={};function m(t,e){return l[e].bindPoint}function h(t,e){return function(r){t.uniform1i(e,r)}}function f(t,e){return function(r){t.uniform1iv(e,r)}}function _(t,e){return function(r){t.uniform2iv(e,r)}}function p(t,e){return function(r){t.uniform3iv(e,r)}}function d(t,e){return function(r){t.uniform4iv(e,r)}}function y(t,e,r,o){var s=m(0,e);return n.isWebGL2(t)?function(e){var n,a;i.isTexture(t,e)?(n=e,a=null):(n=e.texture,a=e.sampler),t.uniform1i(o,r),t.activeTexture(t.TEXTURE0+r),t.bindTexture(s,n),t.bindSampler(r,a)}:function(e){t.uniform1i(o,r),t.activeTexture(t.TEXTURE0+r),t.bindTexture(s,e)}}function v(t,e,r,o,s){for(var a=m(0,e),u=new Int32Array(s),c=0;c<s;++c)u[c]=r+c;return n.isWebGL2(t)?function(e){t.uniform1iv(o,u),e.forEach(function(e,n){var o,s;t.activeTexture(t.TEXTURE0+u[n]),i.isTexture(t,e)?(o=e,s=null):(o=e.texture,s=e.sampler),t.bindSampler(r,s),t.bindTexture(a,o)})}:function(e){t.uniform1iv(o,u),e.forEach(function(e,r){t.activeTexture(t.TEXTURE0+u[r]),t.bindTexture(a,e)})}}function b(t,e){return function(r){t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.enableVertexAttribArray(e),t.vertexAttribPointer(e,r.numComponents||r.size,r.type||t.FLOAT,r.normalize||!1,r.stride||0,r.offset||0),void 0!==r.divisor&&t.vertexAttribDivisor(e,r.divisor)}}function g(t,e){return function(r){t.bindBuffer(t.ARRAY_BUFFER,r.buffer),t.enableVertexAttribArray(e),t.vertexAttribIPointer(e,r.numComponents||r.size,r.type||t.INT,r.stride||0,r.offset||0),void 0!==r.divisor&&t.vertexAttribDivisor(e,r.divisor)}}function x(t,e,r){var n=r.size,i=r.count;return function(r){t.bindBuffer(t.ARRAY_BUFFER,r.buffer);for(var o=r.size||r.numComponents||n,s=o/i,a=r.type||t.FLOAT,u=l[a].size*o,c=r.normalize||!1,m=r.offset||0,h=u/i,f=0;f<i;++f)t.enableVertexAttribArray(e+f),t.vertexAttribPointer(e+f,s,a,c,u,m+h*f),void 0!==r.divisor&&t.vertexAttribDivisor(e+f,r.divisor)}}l[5126]={Type:Float32Array,size:4,setter:function(t,e){return function(r){t.uniform1f(e,r)}},arraySetter:function(t,e){return function(r){t.uniform1fv(e,r)}}},l[35664]={Type:Float32Array,size:8,setter:function(t,e){return function(r){t.uniform2fv(e,r)}}},l[35665]={Type:Float32Array,size:12,setter:function(t,e){return function(r){t.uniform3fv(e,r)}}},l[35666]={Type:Float32Array,size:16,setter:function(t,e){return function(r){t.uniform4fv(e,r)}}},l[5124]={Type:Int32Array,size:4,setter:h,arraySetter:f},l[35667]={Type:Int32Array,size:8,setter:_},l[35668]={Type:Int32Array,size:12,setter:p},l[35669]={Type:Int32Array,size:16,setter:d},l[5125]={Type:Uint32Array,size:4,setter:function(t,e){return function(r){t.uniform1ui(e,r)}},arraySetter:function(t,e){return function(r){t.uniform1uiv(e,r)}}},l[36294]={Type:Uint32Array,size:8,setter:function(t,e){return function(r){t.uniform2uiv(e,r)}}},l[36295]={Type:Uint32Array,size:12,setter:function(t,e){return function(r){t.uniform3uiv(e,r)}}},l[36296]={Type:Uint32Array,size:16,setter:function(t,e){return function(r){t.uniform4uiv(e,r)}}},l[35670]={Type:Uint32Array,size:4,setter:h,arraySetter:f},l[35671]={Type:Uint32Array,size:8,setter:_},l[35672]={Type:Uint32Array,size:12,setter:p},l[35673]={Type:Uint32Array,size:16,setter:d},l[35674]={Type:Float32Array,size:16,setter:function(t,e){return function(r){t.uniformMatrix2fv(e,!1,r)}}},l[35675]={Type:Float32Array,size:36,setter:function(t,e){return function(r){t.uniformMatrix3fv(e,!1,r)}}},l[35676]={Type:Float32Array,size:64,setter:function(t,e){return function(r){t.uniformMatrix4fv(e,!1,r)}}},l[35685]={Type:Float32Array,size:24,setter:function(t,e){return function(r){t.uniformMatrix2x3fv(e,!1,r)}}},l[35686]={Type:Float32Array,size:32,setter:function(t,e){return function(r){t.uniformMatrix2x4fv(e,!1,r)}}},l[35687]={Type:Float32Array,size:24,setter:function(t,e){return function(r){t.uniformMatrix3x2fv(e,!1,r)}}},l[35688]={Type:Float32Array,size:48,setter:function(t,e){return function(r){t.uniformMatrix3x4fv(e,!1,r)}}},l[35689]={Type:Float32Array,size:32,setter:function(t,e){return function(r){t.uniformMatrix4x2fv(e,!1,r)}}},l[35690]={Type:Float32Array,size:48,setter:function(t,e){return function(r){t.uniformMatrix4x3fv(e,!1,r)}}},l[35678]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:3553},l[35680]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:34067},l[35679]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:32879},l[35682]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:3553},l[36289]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:35866},l[36292]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:35866},l[36293]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:34067},l[36298]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:3553},l[36299]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:32879},l[36300]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:34067},l[36303]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:35866},l[36306]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:3553},l[36307]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:32879},l[36308]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:34067},l[36311]={Type:null,size:0,setter:y,arraySetter:v,bindPoint:35866};var A={};A[5126]={size:4,setter:b},A[35664]={size:8,setter:b},A[35665]={size:12,setter:b},A[35666]={size:16,setter:b},A[5124]={size:4,setter:g},A[35667]={size:8,setter:g},A[35668]={size:12,setter:g},A[35669]={size:16,setter:g},A[5125]={size:4,setter:g},A[36294]={size:8,setter:g},A[36295]={size:12,setter:g},A[36296]={size:16,setter:g},A[35670]={size:4,setter:g},A[35671]={size:8,setter:g},A[35672]={size:12,setter:g},A[35673]={size:16,setter:g},A[35674]={size:4,setter:x,count:2},A[35675]={size:9,setter:x,count:3},A[35676]={size:16,setter:x,count:4};var w=void 0;var B=/^[ \t]*\n/;function E(t,e,r,n){var i=n||a,o=t.createShader(r),s=0;if(B.test(e)&&(s=1,e=e.replace(B,"")),t.shaderSource(o,e),t.compileShader(o),!t.getShaderParameter(o,t.COMPILE_STATUS)){var u=t.getShaderInfoLog(o);return i(function(t,e){return e=e||0,++e,t.split("\n").map(function(t,r){return r+e+": "+t}).join("\n")}(e,s)+"\n*** Error compiling shader: "+u),t.deleteShader(o),null}return o}function M(t,e,r){var n;if("function"==typeof e&&(r=e,e=void 0),"function"==typeof t)r=t,t=void 0;else if(t&&!Array.isArray(t)){if(t.errorCallback)return t;var i=t;r=i.errorCallback,t=i.attribLocations,n=i.transformFeedbackVaryings}var o={errorCallback:r||a,transformFeedbackVaryings:n};if(t){var s={};Array.isArray(t)?t.forEach(function(t,r){s[t]=e?e[r]:r}):s=t,o.attribLocations=s}return o}var S=["VERTEX_SHADER","FRAGMENT_SHADER"];function T(t){return t.indexOf("frag")>=0?w.FRAGMENT_SHADER:t.indexOf("vert")>=0?w.VERTEX_SHADER:void 0}function I(t,e){e.forEach(function(e){t.deleteShader(e)})}function P(t,e,r,n,o){for(var s=M(r,n,o),a=[],u=[],l=0;l<e.length;++l){var m=e[l];if("string"==typeof m){var h=c(m),f=h?h.text:m,_=t[S[l]];h&&h.type&&(_=T(h.type)||_),m=E(t,f,_,s.errorCallback),u.push(m)}i.isShader(t,m)&&a.push(m)}if(a.length!==e.length)return s.errorCallback("not enough shaders for program"),I(t,u),null;var p=t.createProgram();a.forEach(function(e){t.attachShader(p,e)}),s.attribLocations&&Object.keys(s.attribLocations).forEach(function(e){t.bindAttribLocation(p,s.attribLocations[e],e)});var d=s.transformFeedbackVaryings;if(d&&(d.attribs&&(d=d.attribs),Array.isArray(d)||(d=Object.keys(d)),t.transformFeedbackVaryings(p,d,s.transformFeedbackMode||t.SEPARATE_ATTRIBS)),t.linkProgram(p),!t.getProgramParameter(p,t.LINK_STATUS)){var y=t.getProgramInfoLog(p);return s.errorCallback("Error in program linking:"+y),t.deleteProgram(p),I(t,u),null}return p}function C(t,e,r,n){var i,o=c(e);if(!o)throw"*** Error: unknown script element"+e;i=o.text;var s=r||T(o.type);if(!s)throw"*** Error: unknown shader type";return E(t,i,s,n)}function R(t,e,r,n,i){for(var o=M(r,n,i),s=[],a=0;a<e.length;++a){var u=E(t,e[a],t[S[a]],o.errorCallback);if(!u)return null;s.push(u)}return P(t,s,o)}function F(t){var e=t.name;return e.startsWith("gl_")||e.startsWith("webgl_")}function D(t,e){var r=0;function n(e,n){var i,o=t.getUniformLocation(e,n.name),s=n.size>1&&"[0]"===n.name.substr(-3),a=n.type,u=l[a];if(!u)throw"unknown type: 0x"+a.toString(16);if(u.bindPoint){var c=r;r+=n.size,i=s?u.arraySetter(t,a,c,o,n.size):u.setter(t,a,c,o,n.size)}else i=u.arraySetter&&s?u.arraySetter(t,o):u.setter(t,o);return i.location=o,i}for(var i={},o=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),s=0;s<o;++s){var a=t.getActiveUniform(e,s);if(!F(a)){var u=a.name;"[0]"===u.substr(-3)&&(u=u.substr(0,u.length-3));var c=n(e,a);i[u]=c}}return i}function L(t,e){for(var r={},n=t.getProgramParameter(e,t.TRANSFORM_FEEDBACK_VARYINGS),i=0;i<n;++i){var o=t.getTransformFeedbackVarying(e,i);r[o.name]={index:i,type:o.type,size:o.size}}return r}function O(t,e,r){for(var n in e.transformFeedbackInfo&&(e=e.transformFeedbackInfo),r.attribs&&(r=r.attribs),r){var i=e[n];if(i){var o=r[n];o.offset?t.bindBufferRange(t.TRANSFORM_FEEDBACK_BUFFER,i.index,o.buffer,o.offset,o.size):t.bindBufferBase(t.TRANSFORM_FEEDBACK_BUFFER,i.index,o.buffer)}}}function k(t,e){for(var r=t.getProgramParameter(e,t.ACTIVE_UNIFORMS),n=[],i=[],o=0;o<r;++o){i.push(o),n.push({});var s=t.getActiveUniform(e,o);if(F(s))break;n[o].name=s.name}[["UNIFORM_TYPE","type"],["UNIFORM_SIZE","size"],["UNIFORM_BLOCK_INDEX","blockNdx"],["UNIFORM_OFFSET","offset"]].forEach(function(r){var o=r[0],s=r[1];t.getActiveUniforms(e,i,t[o]).forEach(function(t,e){n[e][s]=t})});for(var a={},u=t.getProgramParameter(e,t.ACTIVE_UNIFORM_BLOCKS),c=0;c<u;++c){var l=t.getActiveUniformBlockName(e,c),m={index:c,usedByVertexShader:t.getActiveUniformBlockParameter(e,c,t.UNIFORM_BLOCK_REFERENCED_BY_VERTEX_SHADER),usedByFragmentShader:t.getActiveUniformBlockParameter(e,c,t.UNIFORM_BLOCK_REFERENCED_BY_FRAGMENT_SHADER),size:t.getActiveUniformBlockParameter(e,c,t.UNIFORM_BLOCK_DATA_SIZE),uniformIndices:t.getActiveUniformBlockParameter(e,c,t.UNIFORM_BLOCK_ACTIVE_UNIFORM_INDICES)};m.used=m.usedByVertexSahder||m.usedByFragmentShader,a[l]=m}return{blockSpecs:a,uniformData:n}}var U=/\[\d+\]\.$/;function z(t,e,r,n){var i=r.blockSpecs,o=r.uniformData,s=i[n];if(!s)return u("no uniform block object named:",n),{name:n,uniforms:{}};var a=new ArrayBuffer(s.size),c=t.createBuffer(),m=s.index;t.bindBuffer(t.UNIFORM_BUFFER,c),t.uniformBlockBinding(e,s.index,m);var h=n+".";U.test(h)&&(h=h.replace(U,"."));var f={};return s.uniformIndices.forEach(function(t){var e=o[t],r=l[e.type],n=r.Type,i=e.size*r.size,s=e.name;s.substr(0,h.length)===h&&(s=s.substr(h.length)),f[s]=new n(a,e.offset,i/n.BYTES_PER_ELEMENT)}),{name:n,array:a,asFloat:new Float32Array(a),buffer:c,uniforms:f}}function j(t,e,r){var n=(e.uniformBlockSpec||e).blockSpecs[r.name];if(n){var i=n.index;return t.bindBufferRange(t.UNIFORM_BUFFER,i,r.buffer,r.offset||0,r.array.byteLength),!0}return!1}function V(t,e){for(var r={},n=t.getProgramParameter(e,t.ACTIVE_ATTRIBUTES),i=0;i<n;++i){var o=t.getActiveAttrib(e,i);if(!F(o)){var s=t.getAttribLocation(e,o.name),a=A[o.type],u=a.setter(t,s,a);u.location=s,r[o.name]=u}}return r}function N(t,e){for(var r in e){var n=t[r];n&&n(e[r])}}function q(t,e){var r={program:e,uniformSetters:D(t,e),attribSetters:V(t,e)};return n.isWebGL2(t)&&(r.uniformBlockSpec=k(t,e),r.transformFeedbackInfo=L(t,e)),r}},function(t,e,r){"use strict";e.__esModule=!0,e.axisRotate=function(t,e,r,n){n=n||new i(16);var o=e[0],s=e[1],a=e[2],u=Math.sqrt(o*o+s*s+a*a),c=(o/=u)*o,l=(s/=u)*s,m=(a/=u)*a,h=Math.cos(r),f=Math.sin(r),_=1-h,p=c+(1-c)*h,d=o*s*_+a*f,y=o*a*_-s*f,v=o*s*_-a*f,b=l+(1-l)*h,g=s*a*_+o*f,x=o*a*_+s*f,A=s*a*_-o*f,w=m+(1-m)*h,B=t[0],E=t[1],M=t[2],S=t[3],T=t[4],I=t[5],P=t[6],C=t[7],R=t[8],F=t[9],D=t[10],L=t[11];n[0]=p*B+d*T+y*R,n[1]=p*E+d*I+y*F,n[2]=p*M+d*P+y*D,n[3]=p*S+d*C+y*L,n[4]=v*B+b*T+g*R,n[5]=v*E+b*I+g*F,n[6]=v*M+b*P+g*D,n[7]=v*S+b*C+g*L,n[8]=x*B+A*T+w*R,n[9]=x*E+A*I+w*F,n[10]=x*M+A*P+w*D,n[11]=x*S+A*C+w*L,t!==n&&(n[12]=t[12],n[13]=t[13],n[14]=t[14],n[15]=t[15]);return n},e.axisRotation=function(t,e,r){r=r||new i(16);var n=t[0],o=t[1],s=t[2],a=Math.sqrt(n*n+o*o+s*s),u=(n/=a)*n,c=(o/=a)*o,l=(s/=a)*s,m=Math.cos(e),h=Math.sin(e),f=1-m;return r[0]=u+(1-u)*m,r[1]=n*o*f+s*h,r[2]=n*s*f-o*h,r[3]=0,r[4]=n*o*f-s*h,r[5]=c+(1-c)*m,r[6]=o*s*f+n*h,r[7]=0,r[8]=n*s*f+o*h,r[9]=o*s*f-n*h,r[10]=l+(1-l)*m,r[11]=0,r[12]=0,r[13]=0,r[14]=0,r[15]=1,r},e.copy=u,e.frustum=function(t,e,r,n,o,s,a){a=a||new i(16);var u=e-t,c=n-r,l=o-s;return a[0]=2*o/u,a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2*o/c,a[6]=0,a[7]=0,a[8]=(t+e)/u,a[9]=(n+r)/c,a[10]=s/l,a[11]=-1,a[12]=0,a[13]=0,a[14]=o*s/l,a[15]=0,a},e.getAxis=function(t,e,r){r=r||n.create();var i=4*e;return r[0]=t[i+0],r[1]=t[i+1],r[2]=t[i+2],r},e.getTranslation=function(t,e){return(e=e||n.create())[0]=t[12],e[1]=t[13],e[2]=t[14],e},e.identity=c,e.inverse=l,e.lookAt=function(t,e,r,u){u=u||new i(16);var c=o,l=s,m=a;return n.normalize(n.subtract(t,e,m),m),n.normalize(n.cross(r,m,c),c),n.normalize(n.cross(m,c,l),l),u[0]=c[0],u[1]=c[1],u[2]=c[2],u[3]=0,u[4]=l[0],u[5]=l[1],u[6]=l[2],u[7]=0,u[8]=m[0],u[9]=m[1],u[10]=m[2],u[11]=0,u[12]=t[0],u[13]=t[1],u[14]=t[2],u[15]=1,u},e.multiply=function(t,e,r){r=r||new i(16);var n=t[0],o=t[1],s=t[2],a=t[3],u=t[4],c=t[5],l=t[6],m=t[7],h=t[8],f=t[9],_=t[10],p=t[11],d=t[12],y=t[13],v=t[14],b=t[15],g=e[0],x=e[1],A=e[2],w=e[3],B=e[4],E=e[5],M=e[6],S=e[7],T=e[8],I=e[9],P=e[10],C=e[11],R=e[12],F=e[13],D=e[14],L=e[15];return r[0]=n*g+u*x+h*A+d*w,r[1]=o*g+c*x+f*A+y*w,r[2]=s*g+l*x+_*A+v*w,r[3]=a*g+m*x+p*A+b*w,r[4]=n*B+u*E+h*M+d*S,r[5]=o*B+c*E+f*M+y*S,r[6]=s*B+l*E+_*M+v*S,r[7]=a*B+m*E+p*M+b*S,r[8]=n*T+u*I+h*P+d*C,r[9]=o*T+c*I+f*P+y*C,r[10]=s*T+l*I+_*P+v*C,r[11]=a*T+m*I+p*P+b*C,r[12]=n*R+u*F+h*D+d*L,r[13]=o*R+c*F+f*D+y*L,r[14]=s*R+l*F+_*D+v*L,r[15]=a*R+m*F+p*D+b*L,r},e.negate=function(t,e){return(e=e||new i(16))[0]=-t[0],e[1]=-t[1],e[2]=-t[2],e[3]=-t[3],e[4]=-t[4],e[5]=-t[5],e[6]=-t[6],e[7]=-t[7],e[8]=-t[8],e[9]=-t[9],e[10]=-t[10],e[11]=-t[11],e[12]=-t[12],e[13]=-t[13],e[14]=-t[14],e[15]=-t[15],e},e.ortho=function(t,e,r,n,o,s,a){return(a=a||new i(16))[0]=2/(e-t),a[1]=0,a[2]=0,a[3]=0,a[4]=0,a[5]=2/(n-r),a[6]=0,a[7]=0,a[8]=0,a[9]=0,a[10]=2/(o-s),a[11]=0,a[12]=(e+t)/(t-e),a[13]=(n+r)/(r-n),a[14]=(s+o)/(o-s),a[15]=1,a},e.perspective=function(t,e,r,n,o){o=o||new i(16);var s=Math.tan(.5*Math.PI-.5*t),a=1/(r-n);return o[0]=s/e,o[1]=0,o[2]=0,o[3]=0,o[4]=0,o[5]=s,o[6]=0,o[7]=0,o[8]=0,o[9]=0,o[10]=(r+n)*a,o[11]=-1,o[12]=0,o[13]=0,o[14]=r*n*a*2,o[15]=0,o},e.rotateX=function(t,e,r){r=r||new i(16);var n=t[4],o=t[5],s=t[6],a=t[7],u=t[8],c=t[9],l=t[10],m=t[11],h=Math.cos(e),f=Math.sin(e);r[4]=h*n+f*u,r[5]=h*o+f*c,r[6]=h*s+f*l,r[7]=h*a+f*m,r[8]=h*u-f*n,r[9]=h*c-f*o,r[10]=h*l-f*s,r[11]=h*m-f*a,t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]);return r},e.rotateY=function(t,e,r){r=r||new i(16);var n=t[0],o=t[1],s=t[2],a=t[3],u=t[8],c=t[9],l=t[10],m=t[11],h=Math.cos(e),f=Math.sin(e);r[0]=h*n-f*u,r[1]=h*o-f*c,r[2]=h*s-f*l,r[3]=h*a-f*m,r[8]=h*u+f*n,r[9]=h*c+f*o,r[10]=h*l+f*s,r[11]=h*m+f*a,t!==r&&(r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]);return r},e.rotateZ=function(t,e,r){r=r||new i(16);var n=t[0],o=t[1],s=t[2],a=t[3],u=t[4],c=t[5],l=t[6],m=t[7],h=Math.cos(e),f=Math.sin(e);r[0]=h*n+f*u,r[1]=h*o+f*c,r[2]=h*s+f*l,r[3]=h*a+f*m,r[4]=h*u-f*n,r[5]=h*c-f*o,r[6]=h*l-f*s,r[7]=h*m-f*a,t!==r&&(r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11],r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]);return r},e.rotationX=function(t,e){e=e||new i(16);var r=Math.cos(t),n=Math.sin(t);return e[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=r,e[6]=n,e[7]=0,e[8]=0,e[9]=-n,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.rotationY=function(t,e){e=e||new i(16);var r=Math.cos(t),n=Math.sin(t);return e[0]=r,e[1]=0,e[2]=-n,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=n,e[9]=0,e[10]=r,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.rotationZ=function(t,e){e=e||new i(16);var r=Math.cos(t),n=Math.sin(t);return e[0]=r,e[1]=n,e[2]=0,e[3]=0,e[4]=-n,e[5]=r,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.scale=function(t,e,r){r=r||new i(16);var n=e[0],o=e[1],s=e[2];r[0]=n*t[0],r[1]=n*t[1],r[2]=n*t[2],r[3]=n*t[3],r[4]=o*t[4],r[5]=o*t[5],r[6]=o*t[6],r[7]=o*t[7],r[8]=s*t[8],r[9]=s*t[9],r[10]=s*t[10],r[11]=s*t[11],t!==r&&(r[12]=t[12],r[13]=t[13],r[14]=t[14],r[15]=t[15]);return r},e.scaling=function(t,e){return(e=e||new i(16))[0]=t[0],e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=t[1],e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=t[2],e[11]=0,e[12]=0,e[13]=0,e[14]=0,e[15]=1,e},e.setAxis=function(t,e,r,n){n!==t&&(n=u(t,n));var i=4*r;return n[i+0]=e[0],n[i+1]=e[1],n[i+2]=e[2],n},e.setDefaultType=function(t){var e=i;return i=t,e},e.setTranslation=function(t,e,r){r=r||c(),t!==r&&(r[0]=t[0],r[1]=t[1],r[2]=t[2],r[3]=t[3],r[4]=t[4],r[5]=t[5],r[6]=t[6],r[7]=t[7],r[8]=t[8],r[9]=t[9],r[10]=t[10],r[11]=t[11]);return r[12]=e[0],r[13]=e[1],r[14]=e[2],r[15]=1,r},e.transformDirection=function(t,e,r){r=r||n.create();var i=e[0],o=e[1],s=e[2];return r[0]=i*t[0]+o*t[4]+s*t[8],r[1]=i*t[1]+o*t[5]+s*t[9],r[2]=i*t[2]+o*t[6]+s*t[10],r},e.transformNormal=function(t,e,r){r=r||n.create();var i=l(t),o=e[0],s=e[1],a=e[2];return r[0]=o*i[0]+s*i[1]+a*i[2],r[1]=o*i[4]+s*i[5]+a*i[6],r[2]=o*i[8]+s*i[9]+a*i[10],r},e.transformPoint=function(t,e,r){r=r||n.create();var i=e[0],o=e[1],s=e[2],a=i*t[3]+o*t[7]+s*t[11]+t[15];return r[0]=(i*t[0]+o*t[4]+s*t[8]+t[12])/a,r[1]=(i*t[1]+o*t[5]+s*t[9]+t[13])/a,r[2]=(i*t[2]+o*t[6]+s*t[10]+t[14])/a,r},e.translate=function(t,e,r){r=r||new i(16);var n=e[0],o=e[1],s=e[2],a=t[0],u=t[1],c=t[2],l=t[3],m=t[4],h=t[5],f=t[6],_=t[7],p=t[8],d=t[9],y=t[10],v=t[11],b=t[12],g=t[13],x=t[14],A=t[15];t!==r&&(r[0]=a,r[1]=u,r[2]=c,r[3]=l,r[4]=m,r[5]=h,r[6]=f,r[7]=_,r[8]=p,r[9]=d,r[10]=y,r[11]=v);return r[12]=a*n+m*o+p*s+b,r[13]=u*n+h*o+d*s+g,r[14]=c*n+f*o+y*s+x,r[15]=l*n+_*o+v*s+A,r},e.translation=function(t,e){return(e=e||new i(16))[0]=1,e[1]=0,e[2]=0,e[3]=0,e[4]=0,e[5]=1,e[6]=0,e[7]=0,e[8]=0,e[9]=0,e[10]=1,e[11]=0,e[12]=t[0],e[13]=t[1],e[14]=t[2],e[15]=1,e},e.transpose=function(t,e){if((e=e||new i(16))===t){var r;return r=t[1],t[1]=t[4],t[4]=r,r=t[2],t[2]=t[8],t[8]=r,r=t[3],t[3]=t[12],t[12]=r,r=t[6],t[6]=t[9],t[9]=r,r=t[7],t[7]=t[13],t[13]=r,r=t[11],t[11]=t[14],t[14]=r,e}var n=t[0],o=t[1],s=t[2],a=t[3],u=t[4],c=t[5],l=t[6],m=t[7],h=t[8],f=t[9],_=t[10],p=t[11],d=t[12],y=t[13],v=t[14],b=t[15];return e[0]=n,e[1]=u,e[2]=h,e[3]=d,e[4]=o,e[5]=c,e[6]=f,e[7]=y,e[8]=s,e[9]=l,e[10]=_,e[11]=v,e[12]=a,e[13]=m,e[14]=p,e[15]=b,e};var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}(r(3));var i=Float32Array,o=n.create(),s=n.create(),a=n.create();function u(t,e){return(e=e||new i(16))[0]=t[0],e[1]=t[1],e[2]=t[2],e[3]=t[3],e[4]=t[4],e[5]=t[5],e[6]=t[6],e[7]=t[7],e[8]=t[8],e[9]=t[9],e[10]=t[10],e[11]=t[11],e[12]=t[12],e[13]=t[13],e[14]=t[14],e[15]=t[15],e}function c(t){return(t=t||new i(16))[0]=1,t[1]=0,t[2]=0,t[3]=0,t[4]=0,t[5]=1,t[6]=0,t[7]=0,t[8]=0,t[9]=0,t[10]=1,t[11]=0,t[12]=0,t[13]=0,t[14]=0,t[15]=1,t}function l(t,e){e=e||new i(16);var r=t[0],n=t[1],o=t[2],s=t[3],a=t[4],u=t[5],c=t[6],l=t[7],m=t[8],h=t[9],f=t[10],_=t[11],p=t[12],d=t[13],y=t[14],v=t[15],b=f*v,g=y*_,x=c*v,A=y*l,w=c*_,B=f*l,E=o*v,M=y*s,S=o*_,T=f*s,I=o*l,P=c*s,C=m*d,R=p*h,F=a*d,D=p*u,L=a*h,O=m*u,k=r*d,U=p*n,z=r*h,j=m*n,V=r*u,N=a*n,q=b*u+A*h+w*d-(g*u+x*h+B*d),G=g*n+E*h+T*d-(b*n+M*h+S*d),W=x*n+M*u+I*d-(A*n+E*u+P*d),Y=B*n+S*u+P*h-(w*n+T*u+I*h),X=1/(r*q+a*G+m*W+p*Y);return e[0]=X*q,e[1]=X*G,e[2]=X*W,e[3]=X*Y,e[4]=X*(g*a+x*m+B*p-(b*a+A*m+w*p)),e[5]=X*(b*r+M*m+S*p-(g*r+E*m+T*p)),e[6]=X*(A*r+E*a+P*p-(x*r+M*a+I*p)),e[7]=X*(w*r+T*a+I*m-(B*r+S*a+P*m)),e[8]=X*(C*l+D*_+L*v-(R*l+F*_+O*v)),e[9]=X*(R*s+k*_+j*v-(C*s+U*_+z*v)),e[10]=X*(F*s+U*l+V*v-(D*s+k*l+N*v)),e[11]=X*(O*s+z*l+N*_-(L*s+j*l+V*_)),e[12]=X*(F*f+O*y+R*c-(L*y+C*c+D*f)),e[13]=X*(z*y+C*o+U*f-(k*f+j*y+R*o)),e[14]=X*(k*c+N*y+D*o-(V*y+F*o+U*c)),e[15]=X*(V*f+L*o+j*c-(z*c+N*f+O*o)),e}},function(t,e,r){"use strict";e.__esModule=!0,e.createAttribsFromArrays=d,e.createBuffersFromArrays=function(t,e){var r={};Object.keys(e).forEach(function(n){r[n]=v(t,e[n],n)}),e.indices?(r.numElements=e.indices.length,r.elementType=n.getGLTypeForTypedArray(p(e.indices),"indices")):r.numElements=function(t){for(var e,r=0;r<y.length&&!((e=y[r])in t);++r);ii===y.length&&(e=Object.keys(t)[0]);var n=t[e],i=l(n).length,o=_(n,e),s=i/o;if(i%o>0)throw"numComponents "+o+" not correct for length "+i;return s}(e);return r},e.createBufferFromArray=v,e.createBufferFromTypedArray=u,e.createBufferInfoFromArrays=function(t,e){var r={attribs:d(t,e)},i=e.indices;if(i){var o=p(i,"indices");r.indices=u(t,o,t.ELEMENT_ARRAY_BUFFER),r.numElements=o.length,r.elementType=n.getGLTypeForTypedArray(o)}else r.numElements=function(t,e){var r,n;for(n=0;n<y.length&&!((r=y[n])in e)&&!((r=s.attribPrefix+r)in e);++n);n===y.length&&(r=Object.keys(e)[0]);var i=e[r];t.bindBuffer(t.ARRAY_BUFFER,i.buffer);var o=t.getBufferParameter(t.ARRAY_BUFFER,t.BUFFER_SIZE);t.bindBuffer(t.ARRAY_BUFFER,null);var a=function(t,e){return e===t.BYTE?1:e===t.UNSIGNED_BYTE?1:e===t.SHORT?2:e===t.UNSIGNED_SHORT?2:e===t.INT?4:e===t.UNSIGNED_INT?4:e===t.FLOAT?4:0}(t,i.type),u=o/a,c=i.numComponents||i.size,l=u/c;if(l%1!=0)throw"numComponents "+c+" not correct for length "+length;return l}(t,r.attribs);return r},e.setAttribInfoBufferFromArray=function(t,e,r,n){r=p(r),void 0!==n?(t.bindBuffer(t.ARRAY_BUFFER,e.buffer),t.bufferSubData(t.ARRAY_BUFFER,n,r)):a(t,t.ARRAY_BUFFER,e.buffer,r,e.drawType)},e.setAttributePrefix=function(t){s.attribPrefix=t},e.setAttributeDefaults_=function(t){i.copyExistingProperties(t,s)},e.getNumComponents_=_,e.getArray_=l;var n=o(r(1)),i=o(r(0));function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}var s={attribPrefix:""};function a(t,e,r,n,i){t.bindBuffer(e,r),t.bufferData(e,n,i||t.STATIC_DRAW)}function u(t,e,r,n){if(i.isBuffer(t,e))return e;r=r||t.ARRAY_BUFFER;var o=t.createBuffer();return a(t,r,o,e,n),o}function c(t){return"indices"===t}function l(t){return t.length?t:t.data}var m=/coord|texture/i,h=/color|colour/i;function f(t,e){var r;if(e%(r=m.test(t)?2:h.test(t)?4:3)>0)throw"Can not guess numComponents for attribute '"+t+"'. Tried "+r+" but "+e+" values is not evenly divisible by "+r+". You should specify it.";return r}function _(t,e){return t.numComponents||t.size||f(e,l(t).length)}function p(t,e){if(n.isArrayBuffer(t))return t;if(n.isArrayBuffer(t.data))return t.data;Array.isArray(t)&&(t={data:t});var r=t.type;return r||(r=c(e)?Uint16Array:Float32Array),new r(t.data)}function d(t,e){var r={};return Object.keys(e).forEach(function(i){if(!c(i)){var o,a,l,m,h,d=e[i],y=d.attrib||d.name||d.attribName||s.attribPrefix+i;if("number"==typeof d||"number"==typeof d.data){h=d.data||d;var v=d.type||Float32Array,b=h*v.BYTES_PER_ELEMENT;a=n.getGLTypeForTypedArrayType(v),l=void 0!==d.normalize?d.normalize:function(t){return t===Int8Array||t===Uint8Array}(v),m=d.numComponents||d.size||f(i,h),o=t.createBuffer(),t.bindBuffer(t.ARRAY_BUFFER,o),t.bufferData(t.ARRAY_BUFFER,b,d.drawType||t.STATIC_DRAW)}else{var g=p(d,i);o=u(t,g,void 0,d.drawType),a=n.getGLTypeForTypedArray(g),l=void 0!==d.normalize?d.normalize:function(t){return t instanceof Int8Array||t instanceof Uint8Array}(g),m=_(d,i),h=g.length}r[y]={buffer:o,numComponents:m,type:a,normalize:l,stride:d.stride||0,offset:d.offset||0,divisor:void 0===d.divisor?void 0:d.divisor,drawType:d.drawType}}}),t.bindBuffer(t.ARRAY_BUFFER,null),r}var y=["position","positions","a_position"];function v(t,e,r){var n="indices"===r?t.ELEMENT_ARRAY_BUFFER:t.ARRAY_BUFFER;return u(t,p(e,r),n)}},function(t,e,r){"use strict";e.__esModule=!0,e.setTextureDefaults_=function(t){o.copyExistingProperties(t,u),t.textureColor&&A(t.textureColor)},e.createSampler=C,e.createSamplers=function(t,e){var r={};return Object.keys(e).forEach(function(n){r[n]=C(t,e[n])}),r},e.setSamplerParameters=P,e.createTexture=Y,e.setEmptyTexture=W,e.setTextureFromArray=G,e.loadTextureFromUrl=V,e.setTextureFromElement=O,e.setTextureFilteringForSize=R,e.setTextureParameters=I,e.setDefaultTextureColor=A,e.createTextures=function(t,e,r){r=r||k;var n=0,i=[],o={},s={};function a(){0===n&&setTimeout(function(){r(i.length?i:void 0,o,s)},0)}return Object.keys(e).forEach(function(r){var u,c=e[r];(function(t){return"string"==typeof t||Array.isArray(t)&&"string"==typeof t[0]})(c.src)&&(u=function(t,e,o){s[r]=o,--n,t&&i.push(t),a()},++n),o[r]=Y(t,c,u)}),a(),o},e.resizeTexture=function(t,e,r,n,i){n=n||r.width,i=i||r.height;var o=r.target||t.TEXTURE_2D;t.bindTexture(o,e);var s,a=r.level||0,u=r.internalFormat||r.format||t.RGBA,l=v(u),m=r.format||l.format,h=r.src;s=h&&(c(h)||Array.isArray(h)&&"number"==typeof h[0])?r.type||g(t,h,l.type):r.type||l.type;if(o===t.TEXTURE_CUBE_MAP)for(var f=0;f<6;++f)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+f,a,u,n,i,0,m,s,null);else t.texImage2D(o,a,u,n,i,0,m,s,null)},e.getNumComponentsForFormat=function(t){var e=f[t];if(!e)throw"unknown format: "+t;return e.numColorComponents},e.getBytesPerElementForInternalFormat=y;var n=a(r(4)),i=a(r(1)),o=a(r(0)),s=function(t){return t&&t.__esModule?t:{default:t}}(r(2));function a(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}var u={textureColor:new Uint8Array([128,192,255,255]),textureOptions:{},crossOrigin:void 0},c=i.isArrayBuffer,l=s.default.document&&s.default.document.createElement?s.default.document.createElement("canvas").getContext("2d"):null,m=6407,h=33319,f={},_=f;_[6406]={numColorComponents:1},_[6409]={numColorComponents:1},_[6410]={numColorComponents:2},_[m]={numColorComponents:3},_[6408]={numColorComponents:4},_[6403]={numColorComponents:1},_[36244]={numColorComponents:1},_[h]={numColorComponents:2},_[33320]={numColorComponents:2},_[m]={numColorComponents:3},_[36248]={numColorComponents:3},_[6408]={numColorComponents:4},_[36249]={numColorComponents:4},_[6402]={numColorComponents:1},_[34041]={numColorComponents:2};var p={},d=p;function y(t,e){var r=p[t];if(!r)throw"unknown internal format";var n=r.bytesPerElementMap[e];if(void 0===n)throw"unknown internal format";return n}function v(t){var e=p[t];if(!e)throw"unknown internal format";return{format:e.textureFormat,type:Array.isArray(e.type)?e.type[0]:e.type}}function b(t){return 0==(t&t-1)}function g(t,e,r){return c(e)?i.getGLTypeForTypedArray(e):r||t.UNSIGNED_BYTE}function x(t,e,r,n,i){if(i%1!=0)throw"can't guess dimensions";if(r||n){if(n){if(!r&&(r=i/n)%1)throw"can't guess dimensions"}else if((n=i/r)%1)throw"can't guess dimensions"}else{var o=Math.sqrt(i/(e===t.TEXTURE_CUBE_MAP?6:1));o%1==0?(r=o,n=o):(r=i,n=1)}return{width:r,height:n}}function A(t){u.textureColor=new Uint8Array([255*t[0],255*t[1],255*t[2],255*t[3]])}d[6406]={textureFormat:6406,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},d[6409]={textureFormat:6409,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[1,2,2,4],type:[5121,5131,36193,5126]},d[6410]={textureFormat:6410,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[2,4,4,8],type:[5121,5131,36193,5126]},d[m]={textureFormat:m,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,6,6,12,2],type:[5121,5131,36193,5126,33635]},d[6408]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,8,8,16,2,2],type:[5121,5131,36193,5126,32819,32820]},d[33321]={textureFormat:6403,colorRenderable:!0,textureFilterable:!0,bytesPerElement:1,type:5121},d[36756]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:1,type:5120},d[33325]={textureFormat:6403,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[4,2],type:[5126,5131]},d[33326]={textureFormat:6403,colorRenderable:!1,textureFilterable:!1,bytesPerElement:4,type:5126},d[33330]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:1,type:5121},d[33329]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:1,type:5120},d[33332]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5123},d[33331]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5122},d[33334]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5125},d[33333]={textureFormat:36244,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5124},d[33323]={textureFormat:h,colorRenderable:!0,textureFilterable:!0,bytesPerElement:2,type:5121},d[36757]={textureFormat:h,colorRenderable:!1,textureFilterable:!0,bytesPerElement:2,type:5120},d[33327]={textureFormat:h,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[8,4],type:[5126,5131]},d[33328]={textureFormat:h,colorRenderable:!1,textureFilterable:!1,bytesPerElement:8,type:5126},d[33336]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5121},d[33335]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:2,type:5120},d[33338]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5123},d[33337]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5122},d[33340]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5125},d[33339]={textureFormat:33320,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5124},d[32849]={textureFormat:m,colorRenderable:!0,textureFilterable:!0,bytesPerElement:3,type:5121},d[35905]={textureFormat:m,colorRenderable:!1,textureFilterable:!0,bytesPerElement:3,type:5121},d[36194]={textureFormat:m,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[3,2],type:[5121,33635]},d[36758]={textureFormat:m,colorRenderable:!1,textureFilterable:!0,bytesPerElement:3,type:5120},d[35898]={textureFormat:m,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35899]},d[35901]={textureFormat:m,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6,4],type:[5126,5131,35902]},d[34843]={textureFormat:m,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[12,6],type:[5126,5131]},d[34837]={textureFormat:m,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5126},d[36221]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:3,type:5121},d[36239]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:3,type:5120},d[36215]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:6,type:5123},d[36233]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:6,type:5122},d[36209]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5125},d[36227]={textureFormat:36248,colorRenderable:!1,textureFilterable:!1,bytesPerElement:12,type:5124},d[32856]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:5121},d[35907]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:5121},d[36759]={textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:4,type:5120},d[32855]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2,4],type:[5121,32820,33640]},d[32854]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:[4,2],type:[5121,32819]},d[32857]={textureFormat:6408,colorRenderable:!0,textureFilterable:!0,bytesPerElement:4,type:33640},d[34842]={textureFormat:6408,colorRenderable:!1,textureFilterable:!0,bytesPerElement:[16,8],type:[5126,5131]},d[34836]={textureFormat:6408,colorRenderable:!1,textureFilterable:!1,bytesPerElement:16,type:5126},d[36220]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5121},d[36238]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5120},d[36975]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:33640},d[36214]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5123},d[36232]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:8,type:5122},d[36226]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:16,type:5124},d[36208]={textureFormat:36249,colorRenderable:!0,textureFilterable:!1,bytesPerElement:16,type:5125},d[33189]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:[2,4],type:[5123,5125]},d[33190]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5125},d[36012]={textureFormat:6402,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:5126},d[35056]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:34042},d[36013]={textureFormat:34041,colorRenderable:!0,textureFilterable:!1,bytesPerElement:4,type:36269},Object.keys(d).forEach(function(t){var e=d[t];if(e.bytesPerElementMap={},Array.isArray(e.bytesPerElement))e.bytesPerElement.forEach(function(t,r){var n=e.type[r];e.bytesPerElementMap[n]=t});else{var r=e.type;e.bytesPerElementMap[r]=e.bytesPerElement}});var w={};function B(t,e){void 0!==e.colorspaceConversion&&(w.colorspaceConversion=t.getParameter(t.UNPACK_COLORSPACE_CONVERSION_WEBGL),t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,e.colorspaceConversion)),void 0!==e.premultiplyAlpha&&(w.premultiplyAlpha=t.getParameter(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL),t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,e.premultiplyAlpha)),void 0!==e.flipY&&(w.flipY=t.getParameter(t.UNPACK_FLIP_Y_WEBGL),t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,e.flipY))}function E(t,e){void 0!==e.colorspaceConversion&&t.pixelStorei(t.UNPACK_COLORSPACE_CONVERSION_WEBGL,w.colorspaceConversion),void 0!==e.premultiplyAlpha&&t.pixelStorei(t.UNPACK_PREMULTIPLY_ALPHA_WEBGL,w.premultiplyAlpha),void 0!==e.flipY&&t.pixelStorei(t.UNPACK_FLIP_Y_WEBGL,w.flipY)}function M(t){w.unpackAlignment=t.getParameter(t.UNPACK_ALIGNMENT),n.isWebGL2(t)&&(w.unpackRowLength=t.getParameter(t.UNPACK_ROW_LENGTH),w.unpackImageHeight=t.getParameter(t.UNPACK_IMAGE_HEIGHT),w.unpackSkipPixels=t.getParameter(t.UNPACK_SKIP_PIXELS),w.unpackSkipRows=t.getParameter(t.UNPACK_SKIP_ROWS),w.unpackSkipImages=t.getParameter(t.UNPACK_SKIP_IMAGES))}function S(t){t.pixelStorei(t.UNPACK_ALIGNMENT,w.unpackAlignment),n.isWebGL2(t)&&(t.pixelStorei(t.UNPACK_ROW_LENGTH,w.unpackRowLength),t.pixelStorei(t.UNPACK_IMAGE_HEIGHT,w.unpackImageHeight),t.pixelStorei(t.UNPACK_SKIP_PIXELS,w.unpackSkipPixels),t.pixelStorei(t.UNPACK_SKIP_ROWS,w.unpackSkipRows),t.pixelStorei(t.UNPACK_SKIP_IMAGES,w.unpackSkipImages))}function T(t,e,r,n){n.minMag&&(r.call(t,e,t.TEXTURE_MIN_FILTER,n.minMag),r.call(t,e,t.TEXTURE_MAG_FILTER,n.minMag)),n.min&&r.call(t,e,t.TEXTURE_MIN_FILTER,n.min),n.mag&&r.call(t,e,t.TEXTURE_MAG_FILTER,n.mag),n.wrap&&(r.call(t,e,t.TEXTURE_WRAP_S,n.wrap),r.call(t,e,t.TEXTURE_WRAP_T,n.wrap),(e===t.TEXTURE_3D||o.isSampler(t,e))&&r.call(t,e,t.TEXTURE_WRAP_R,n.wrap)),n.wrapR&&r.call(t,e,t.TEXTURE_WRAP_R,n.wrapR),n.wrapS&&r.call(t,e,t.TEXTURE_WRAP_S,n.wrapS),n.wrapT&&r.call(t,e,t.TEXTURE_WRAP_T,n.wrapT),n.minLod&&r.call(t,e,t.TEXTURE_MIN_LOD,n.minLod),n.maxLod&&r.call(t,e,t.TEXTURE_MAX_LOD,n.maxLod),n.baseLevel&&r.call(t,e,t.TEXTURE_BASE_LEVEL,n.baseLevel),n.maxLevel&&r.call(t,e,t.TEXTURE_MAX_LEVEL,n.maxLevel)}function I(t,e,r){var n=r.target||t.TEXTURE_2D;t.bindTexture(n,e),T(t,n,t.texParameteri,r)}function P(t,e,r){T(t,e,t.samplerParameteri,r)}function C(t,e){var r=t.createSampler();return P(t,r,e),r}function R(t,e,r,i,o,s,a){r=r||u.textureOptions,s=s||t.RGBA,a=a||t.UNSIGNED_BYTE;var c=r.target||t.TEXTURE_2D;if(i=i||r.width,o=o||r.height,t.bindTexture(c,e),function(t,e,r,i){if(!n.isWebGL2(t))return b(e)&&b(r);var o=p[i];if(!o)throw"unknown internal format";return o.colorRenderable&&o.textureFilterable}(t,i,o,s))t.generateMipmap(c);else{var l=function(t){var e=p[t];if(!e)throw"unknown internal format";return e.textureFilterable}(s)?t.LINEAR:t.NEAREST;t.texParameteri(c,t.TEXTURE_MIN_FILTER,l),t.texParameteri(c,t.TEXTURE_MAG_FILTER,l),t.texParameteri(c,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(c,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE)}}function F(t){return!0===t.auto||void 0===t.auto&&void 0===t.level}function D(t,e){return(e=e||{}).cubeFaceOrder||[t.TEXTURE_CUBE_MAP_POSITIVE_X,t.TEXTURE_CUBE_MAP_NEGATIVE_X,t.TEXTURE_CUBE_MAP_POSITIVE_Y,t.TEXTURE_CUBE_MAP_NEGATIVE_Y,t.TEXTURE_CUBE_MAP_POSITIVE_Z,t.TEXTURE_CUBE_MAP_NEGATIVE_Z]}function L(t,e){var r=D(t,e).map(function(t,e){return{face:t,ndx:e}});return r.sort(function(t,e){return t.face-e.face}),r}function O(t,e,r,n){var i=(n=n||u.textureOptions).target||t.TEXTURE_2D,o=n.level||0,a=r.width,c=r.height,m=n.internalFormat||n.format||t.RGBA,h=v(m),f=n.format||h.format,_=n.type||h.type;if(B(t,n),t.bindTexture(i,e),i===t.TEXTURE_CUBE_MAP){var p,d,y=r.width,b=r.height;if(y/6===b)p=b,d=[0,0,1,0,2,0,3,0,4,0,5,0];else if(b/6===y)p=y,d=[0,0,0,1,0,2,0,3,0,4,0,5];else if(y/3==b/2)p=y/3,d=[0,0,1,0,2,0,0,1,1,1,2,1];else{if(y/2!=b/3)throw"can't figure out cube map from element: "+(r.src?r.src:r.nodeName);p=y/2,d=[0,0,1,0,0,1,1,1,0,2,1,2]}l?(l.canvas.width=p,l.canvas.height=p,a=p,c=p,L(t,n).forEach(function(e){var n=d[2*e.ndx+0]*p,i=d[2*e.ndx+1]*p;l.drawImage(r,n,i,p,p,0,0,p,p),t.texImage2D(e.face,o,m,f,_,l.canvas)}),l.canvas.width=1,l.canvas.height=1):s.default.createImageBitmap&&(a=p,c=p,L(t,n).forEach(function(u){var l=d[2*u.ndx+0]*p,h=d[2*u.ndx+1]*p;t.texImage2D(u.face,o,m,p,p,0,f,_,null),s.default.createImageBitmap(r,l,h,p,p,{premultiplyAlpha:"none",colorSpaceConversion:"none"}).then(function(r){B(t,n),t.bindTexture(i,e),t.texImage2D(u.face,o,m,f,_,r),E(t,n),F(n)&&R(t,e,n,a,c,m,_)})}))}else if(i===t.TEXTURE_3D||i===t.TEXTURE_2D_ARRAY){var g=Math.min(r.width,r.height),x=Math.max(r.width,r.height),A=x/g;if(A%1!=0)throw"can not compute 3D dimensions of element";var w=r.width===x?1:0,T=r.height===x?1:0;M(t),t.pixelStorei(t.UNPACK_ALIGNMENT,1),t.pixelStorei(t.UNPACK_ROW_LENGTH,r.width),t.pixelStorei(t.UNPACK_IMAGE_HEIGHT,0),t.pixelStorei(t.UNPACK_SKIP_IMAGES,0),t.texImage3D(i,o,m,g,g,g,0,f,_,null);for(var P=0;P<A;++P){var C=P*g*w,D=P*g*T;t.pixelStorei(t.UNPACK_SKIP_PIXELS,C),t.pixelStorei(t.UNPACK_SKIP_ROWS,D),t.texSubImage3D(i,o,0,0,P,g,g,1,f,_,r)}S(t)}else t.texImage2D(i,o,m,f,_,r);E(t,n),F(n)&&R(t,e,n,a,c,m,_),I(t,e,n)}function k(){}function U(t){return s.default.ImageBitmap&&t instanceof s.default.ImageBitmap||s.default.ImageData&&t instanceof s.default.ImageData||s.default.HTMLElement&&t instanceof s.default.HTMLElement}function z(t,e,r){return U(t)?(setTimeout(function(){r(null,t)}),t):function(t,e,r){var n;if(r=r||k,s.default.Image){n=new s.default.Image,void 0!==(e=void 0!==e?e:u.crossOrigin)&&(n.crossOrigin=e);var i=function(){n.removeEventListener("error",a),n.removeEventListener("load",c),n=null},a=function(){var e="couldn't load image: "+t;o.error(e),r(e,n),i()},c=function(){r(null,n),i()};return n.addEventListener("error",a),n.addEventListener("load",c),n.src=t,n}if(s.default.ImageBitmap){var l,m,h=function(){r(l,m)},f={};e&&(f.mode="cors"),fetch(t,f).then(function(t){if(!t.ok)throw t;return t.blob()}).then(function(t){return s.default.createImageBitmap(t,{premultiplyAlpha:"none",colorSpaceConversion:"none"})}).then(function(t){m=t,setTimeout(h)}).catch(function(t){l=t,setTimeout(h)}),n=null}return n}(t,e,r)}function j(t,e,r){var n=(r=r||u.textureOptions).target||t.TEXTURE_2D;if(t.bindTexture(n,e),!1!==r.color){var i=function(t){return t=t||u.textureColor,c(t)?t:new Uint8Array([255*t[0],255*t[1],255*t[2],255*t[3]])}(r.color);if(n===t.TEXTURE_CUBE_MAP)for(var o=0;o<6;++o)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+o,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i);else n===t.TEXTURE_3D||n===t.TEXTURE_2D_ARRAY?t.texImage3D(n,0,t.RGBA,1,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i):t.texImage2D(n,0,t.RGBA,1,1,0,t.RGBA,t.UNSIGNED_BYTE,i)}}function V(t,e,r,n){return n=n||k,r=r||u.textureOptions,j(t,e,r),z((r=Object.assign({},r)).src,r.crossOrigin,function(i,o){i?n(i,e,o):(O(t,e,o,r),n(null,e,o))})}function N(t,e,r,n){n=n||k;var i=r.src;if(6!==i.length)throw"there must be 6 urls for a cubemap";var o=r.level||0,s=r.internalFormat||r.format||t.RGBA,a=v(s),u=r.format||a.format,c=r.type||t.UNSIGNED_BYTE,l=r.target||t.TEXTURE_2D;if(l!==t.TEXTURE_CUBE_MAP)throw"target must be TEXTURE_CUBE_MAP";j(t,e,r),r=Object.assign({},r);var m,h=6,f=[],_=D(t,r);m=i.map(function(i,a){return z(i,r.crossOrigin,function(i){return function(a,_){--h,a?f.push(a):_.width!==_.height?f.push("cubemap face img is not a square: "+_.src):(B(t,r),t.bindTexture(l,e),5===h?D(t).forEach(function(e){t.texImage2D(e,o,s,u,c,_)}):t.texImage2D(i,o,s,u,c,_),E(t,r),F(r)&&t.generateMipmap(l)),0===h&&n(f.length?f:void 0,e,m)}}(_[a]))})}function q(t,e,r,n){n=n||k;var i=r.src,o=r.internalFormat||r.format||t.RGBA,s=v(o),a=r.format||s.format,u=r.type||t.UNSIGNED_BYTE,c=r.target||t.TEXTURE_2D_ARRAY;if(c!==t.TEXTURE_3D&&c!==t.TEXTURE_2D_ARRAY)throw"target must be TEXTURE_3D or TEXTURE_2D_ARRAY";j(t,e,r),r=Object.assign({},r);var m,h=i.length,f=[],_=r.level||0,p=r.width,d=r.height,y=i.length,b=!0;m=i.map(function(i,s){return z(i,r.crossOrigin,function(i){return function(s,v){if(--h,s)f.push(s);else{if(B(t,r),t.bindTexture(c,e),b){b=!1,p=r.width||v.width,d=r.height||v.height,t.texImage3D(c,_,o,p,d,y,0,a,u,null);for(var g=0;g<y;++g)t.texSubImage3D(c,_,0,0,g,p,d,1,a,u,v)}else{var x=v;v.width===p&&v.height===d||(x=l.canvas,l.canvas.width=p,l.canvas.height=d,l.drawImage(v,0,0,p,d)),t.texSubImage3D(c,_,0,0,i,p,d,1,a,u,x),x===l.canvas&&(l.canvas.width=0,l.canvas.height=0)}E(t,r),F(r)&&t.generateMipmap(c)}0===h&&n(f.length?f:void 0,e,m)}}(s))})}function G(t,e,r,o){var s=(o=o||u.textureOptions).target||t.TEXTURE_2D;t.bindTexture(s,e);var a=o.width,l=o.height,m=o.depth,h=o.level||0,f=o.internalFormat||o.format||t.RGBA,_=v(f),p=o.format||_.format,d=o.type||g(t,r,_.type);if(c(r))r instanceof Uint8ClampedArray&&(r=new Uint8Array(r.buffer));else{var b=i.getTypedArrayTypeForGLType(d);r=new b(r)}var A,w=y(f,d),T=r.byteLength/w;if(T%1)throw"length wrong size for format: "+n.glEnumToString(t,p);if(s===t.TEXTURE_3D)if(a||l||m)!a||l&&m?!l||a&&m?(A=x(t,s,a,l,T/m),a=A.width,l=A.height):(A=x(t,s,a,m,T/l),a=A.width,m=A.height):(A=x(t,s,l,m,T/a),l=A.width,m=A.height);else{var I=Math.cbrt(T);if(I%1!=0)throw"can't guess cube size of array of numElements: "+T;a=I,l=I,m=I}else A=x(t,s,a,l,T),a=A.width,l=A.height;if(M(t),t.pixelStorei(t.UNPACK_ALIGNMENT,o.unpackAlignment||1),B(t,o),s===t.TEXTURE_CUBE_MAP){var P=T/6*(w/r.BYTES_PER_ELEMENT);L(t,o).forEach(function(e){var n=P*e.ndx,i=r.subarray(n,n+P);t.texImage2D(e.face,h,f,a,l,0,p,d,i)})}else s===t.TEXTURE_3D?t.texImage3D(s,h,f,a,l,m,0,p,d,r):t.texImage2D(s,h,f,a,l,0,p,d,r);return E(t,o),S(t),{width:a,height:l,depth:m,type:d}}function W(t,e,r){var n=r.target||t.TEXTURE_2D;t.bindTexture(n,e);var i=r.level||0,o=r.internalFormat||r.format||t.RGBA,s=v(o),a=r.format||s.format,u=r.type||s.type;if(B(t,r),n===t.TEXTURE_CUBE_MAP)for(var c=0;c<6;++c)t.texImage2D(t.TEXTURE_CUBE_MAP_POSITIVE_X+c,i,o,r.width,r.height,0,a,u,null);else n===t.TEXTURE_3D?t.texImage3D(n,i,o,r.width,r.height,r.depth,0,a,u,null):t.texImage2D(n,i,o,r.width,r.height,0,a,u,null);E(t,r)}function Y(t,e,r){r=r||k,e=e||u.textureOptions;var n=t.createTexture(),i=e.target||t.TEXTURE_2D,o=e.width||1,s=e.height||1,a=e.internalFormat||t.RGBA,l=v(a),m=e.type||l.type;t.bindTexture(i,n),i===t.TEXTURE_CUBE_MAP&&(t.texParameteri(i,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(i,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE));var h=e.src;if(h)if("function"==typeof h&&(h=h(t,e)),"string"==typeof h)V(t,n,e,r);else if(c(h)||Array.isArray(h)&&("number"==typeof h[0]||Array.isArray(h[0])||c(h[0]))){var f=G(t,n,h,e);o=f.width,s=f.height,m=f.type}else if(Array.isArray(h)&&("string"==typeof h[0]||U(h[0])))i===t.TEXTURE_CUBE_MAP?N(t,n,e,r):q(t,n,e,r);else{if(!U(h))throw"unsupported src type";O(t,n,h,e),o=h.width,s=h.height}else W(t,n,e);return F(e)&&R(t,n,e,o,s,a,m),I(t,n,e),n}},function(t,e,r){"use strict";e.__esModule=!0;var n={m4:!0,v3:!0,primitives:!0};e.primitives=e.v3=e.m4=void 0;var i=u(r(6));e.m4=i;var o=u(r(3));e.v3=o;var s=u(r(10));e.primitives=s;var a=r(11);function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}Object.keys(a).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(e[t]=a[t]))})},function(t,e,r){"use strict";e.__esModule=!0,e.create3DFVertices=S,e.createAugmentedTypedArray=h,e.createCubeVertices=B,e.createPlaneVertices=x,e.createSphereVertices=A,e.createTruncatedConeVertices=E,e.createXYQuadVertices=g,e.createCresentVertices=T,e.createCylinderVertices=I,e.createTorusVertices=P,e.createDiscVertices=C,e.deindexVertices=function(t){var e=t.indices,r={},n=e.length;return Object.keys(t).filter(f).forEach(function(i){for(var o=t[i],s=o.numComponents,a=h(s,n,o.constructor),u=0;u<n;++u)for(var c=e[u],l=c*s,m=0;m<s;++m)a.push(o[l+m]);r[i]=a}),r},e.flattenNormals=function(t){if(t.indices)throw"can't flatten normals of indexed vertices. deindex them first";for(var e=t.normal,r=e.length,n=0;n<r;n+=9){var i=e[n+0],o=e[n+1],s=e[n+2],a=e[n+3],u=e[n+4],c=e[n+5],l=e[n+6],m=e[n+7],h=e[n+8],f=i+a+l,_=o+u+m,p=s+c+h,d=Math.sqrt(f*f+_*_+p*p);f/=d,_/=d,p/=d,e[n+0]=f,e[n+1]=_,e[n+2]=p,e[n+3]=f,e[n+4]=_,e[n+5]=p,e[n+6]=f,e[n+7]=_,e[n+8]=p}return t},e.makeRandomVertexColors=function(t,e){e=e||{};var r=t.position.numElements,n=h(4,r,Uint8Array),i=e.rand||function(t,e){return e<3?function(t){return Math.random()*t|0}(256):255};if(t.color=n,t.indices)for(var o=0;o<r;++o)n.push(i(o,0),i(o,1),i(o,2),i(o,3));else for(var s=e.vertsPerColor||3,a=r/s,u=0;u<a;++u)for(var c=[i(u,0),i(u,1),i(u,2),i(u,3)],l=0;l<s;++l)n.push(c);return t},e.reorientDirections=d,e.reorientNormals=y,e.reorientPositions=v,e.reorientVertices=b,e.concatVertices=function(t){for(var e,r={},n=function(n){var i=t[n];Object.keys(i).forEach(function(t){r[t]||(r[t]=[]),e||"indices"===t||(e=t);var n=i[t],o=l(n,t),s=c(n),a=s.length/o;r[t].push(a)})},i=0;i<t.length;++i)n(i);var o=r[e],s={};return Object.keys(r).forEach(function(e){var r=function(e){for(var r,n=0,i=0;i<t.length;++i){var o=t[i],s=o[e],a=c(s);n+=a.length,r&&!s.data||(r=s)}return{length:n,spec:r}}(e),n=O(r.spec,r.length);!function(e,r,n){for(var i=0,o=0,s=0;s<t.length;++s){var a=t[s],u=a[e],l=c(u);"indices"===e?(L(l,n,o,i),i+=r[s]):L(l,n,o),o+=l.length}}(e,o,c(n)),s[e]=n}),s},e.duplicateVertices=function(t){var e={};return Object.keys(t).forEach(function(r){var n=t[r],i=c(n),o=O(n,i.length);L(i,c(o),0),e[r]=o}),e},e.createDiscBuffers=e.createDiscBufferInfo=e.createTorusBuffers=e.createTorusBufferInfo=e.createCylinderBuffers=e.createCylinderBufferInfo=e.createCresentBuffers=e.createCresentBufferInfo=e.createXYQuadBuffers=e.createXYQuadBufferInfo=e.createTruncatedConeBuffers=e.createTruncatedConeBufferInfo=e.createSphereBuffers=e.createSphereBufferInfo=e.createPlaneBuffers=e.createPlaneBufferInfo=e.createCubeBuffers=e.createCubeBufferInfo=e.create3DFBuffers=e.create3DFBufferInfo=void 0;var n=u(r(7)),i=u(r(0)),o=u(r(1)),s=u(r(6)),a=u(r(3));function u(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}var c=n.getArray_,l=n.getNumComponents_;function m(t,e){var r=0;return t.push=function(){for(var e=0;e<arguments.length;++e){var n=arguments[e];if(n instanceof Array||o.isArrayBuffer(n))for(var i=0;i<n.length;++i)t[r++]=n[i];else t[r++]=n}},t.reset=function(t){r=t||0},t.numComponents=e,Object.defineProperty(t,"numElements",{get:function(){return this.length/this.numComponents|0}}),t}function h(t,e,r){return m(new(r||Float32Array)(t*e),t)}function f(t){return"indices"!==t}function _(t,e,r){for(var n=t.length,i=new Float32Array(3),o=0;o<n;o+=3)r(e,[t[o],t[o+1],t[o+2]],i),t[o]=i[0],t[o+1]=i[1],t[o+2]=i[2]}function p(t,e,r){r=r||a.create();var n=e[0],i=e[1],o=e[2];return r[0]=n*t[0]+i*t[1]+o*t[2],r[1]=n*t[4]+i*t[5]+o*t[6],r[2]=n*t[8]+i*t[9]+o*t[10],r}function d(t,e){return _(t,e,s.transformDirection),t}function y(t,e){return _(t,s.inverse(e),p),t}function v(t,e){return _(t,e,s.transformPoint),t}function b(t,e){return Object.keys(t).forEach(function(r){var n=t[r];r.indexOf("pos")>=0?v(n,e):r.indexOf("tan")>=0||r.indexOf("binorm")>=0?d(n,e):r.indexOf("norm")>=0&&y(n,e)}),t}function g(t,e,r){return t=t||2,{position:{numComponents:2,data:[(e=e||0)+-1*(t*=.5),(r=r||0)+-1*t,e+1*t,r+-1*t,e+-1*t,r+1*t,e+1*t,r+1*t]},normal:[0,0,1,0,0,1,0,0,1,0,0,1],texcoord:[0,0,1,0,0,1,1,1],indices:[0,1,2,2,1,3]}}function x(t,e,r,n,i){t=t||1,e=e||1,r=r||1,n=n||1,i=i||s.identity();for(var o=(r+1)*(n+1),a=h(3,o),u=h(3,o),c=h(2,o),l=0;l<=n;l++)for(var m=0;m<=r;m++){var f=m/r,_=l/n;a.push(t*f-.5*t,0,e*_-.5*e),u.push(0,1,0),c.push(f,_)}for(var p=r+1,d=h(3,r*n*2,Uint16Array),y=0;y<n;y++)for(var v=0;v<r;v++)d.push((y+0)*p+v,(y+1)*p+v,(y+0)*p+v+1),d.push((y+1)*p+v,(y+1)*p+v+1,(y+0)*p+v+1);return b({position:a,normal:u,texcoord:c,indices:d},i)}function A(t,e,r,n,i,o,s){if(e<=0||r<=0)throw Error("subdivisionAxis and subdivisionHeight must be > 0");n=n||0,i=i||Math.PI,o=o||0;for(var a=i-n,u=(s=s||2*Math.PI)-o,c=(e+1)*(r+1),l=h(3,c),m=h(3,c),f=h(2,c),_=0;_<=r;_++)for(var p=0;p<=e;p++){var d=p/e,y=_/r,v=u*d,b=a*y,g=Math.sin(v),x=Math.cos(v),A=Math.sin(b),w=x*A,B=Math.cos(b),E=g*A;l.push(t*w,t*B,t*E),m.push(w,B,E),f.push(1-d,y)}for(var M=e+1,S=h(3,e*r*2,Uint16Array),T=0;T<e;T++)for(var I=0;I<r;I++)S.push((I+0)*M+T,(I+0)*M+T+1,(I+1)*M+T),S.push((I+1)*M+T,(I+0)*M+T+1,(I+1)*M+T+1);return{position:l,normal:m,texcoord:f,indices:S}}var w=[[3,7,5,1],[6,2,0,4],[6,7,3,2],[0,1,5,4],[7,6,4,5],[2,3,1,0]];function B(t){for(var e=(t=t||1)/2,r=[[-e,-e,-e],[+e,-e,-e],[-e,+e,-e],[+e,+e,-e],[-e,-e,+e],[+e,-e,+e],[-e,+e,+e],[+e,+e,+e]],n=[[1,0,0],[-1,0,0],[0,1,0],[0,-1,0],[0,0,1],[0,0,-1]],i=[[1,0],[0,0],[0,1],[1,1]],o=h(3,24),s=h(3,24),a=h(2,24),u=h(3,12,Uint16Array),c=0;c<6;++c){for(var l=w[c],m=0;m<4;++m){var f=r[l[m]],_=n[c],p=i[m];o.push(f),s.push(_),a.push(p)}var d=4*c;u.push(d+0,d+1,d+2),u.push(d+0,d+2,d+3)}return{position:o,normal:s,texcoord:a,indices:u}}function E(t,e,r,n,i,o,s){if(n<3)throw Error("radialSubdivisions must be 3 or greater");if(i<1)throw Error("verticalSubdivisions must be 1 or greater");for(var a=void 0===o||o,u=void 0===s||s,c=(a?2:0)+(u?2:0),l=(n+1)*(i+1+c),m=h(3,l),f=h(3,l),_=h(2,l),p=h(3,n*(i+c)*2,Uint16Array),d=n+1,y=Math.atan2(t-e,r),v=Math.cos(y),b=Math.sin(y),g=i+(u?2:0),x=a?-2:0;x<=g;++x){var A=x/i,w=r*A,B=void 0;x<0?(w=0,A=1,B=t):x>i?(w=r,A=1,B=e):B=t+x/i*(e-t),-2!==x&&x!==i+2||(B=0,A=0),w-=r/2;for(var E=0;E<d;++E){var M=Math.sin(E*Math.PI*2/n),S=Math.cos(E*Math.PI*2/n);m.push(M*B,w,S*B),f.push(x<0||x>i?0:M*v,x<0?-1:x>i?1:b,x<0||x>i?0:S*v),_.push(E/n,1-A)}}for(var T=0;T<i+c;++T)for(var I=0;I<n;++I)p.push(d*(T+0)+0+I,d*(T+0)+1+I,d*(T+1)+1+I),p.push(d*(T+0)+0+I,d*(T+1)+1+I,d*(T+1)+0+I);return{position:m,normal:f,texcoord:_,indices:p}}function M(t,e){e=e||[];for(var r=[],n=0;n<t.length;n+=4){var i=t[n],o=t.slice(n+1,n+4);o.push.apply(o,e);for(var s=0;s<i;++s)r.push.apply(r,o)}return r}function S(){var t=[0,0,0,0,150,0,30,0,0,0,150,0,30,150,0,30,0,0,30,0,0,30,30,0,100,0,0,30,30,0,100,30,0,100,0,0,30,60,0,30,90,0,67,60,0,30,90,0,67,90,0,67,60,0,0,0,30,30,0,30,0,150,30,0,150,30,30,0,30,30,150,30,30,0,30,100,0,30,30,30,30,30,30,30,100,0,30,100,30,30,30,60,30,67,60,30,30,90,30,30,90,30,67,60,30,67,90,30,0,0,0,100,0,0,100,0,30,0,0,0,100,0,30,0,0,30,100,0,0,100,30,0,100,30,30,100,0,0,100,30,30,100,0,30,30,30,0,30,30,30,100,30,30,30,30,0,100,30,30,100,30,0,30,30,0,30,60,30,30,30,30,30,30,0,30,60,0,30,60,30,30,60,0,67,60,30,30,60,30,30,60,0,67,60,0,67,60,30,67,60,0,67,90,30,67,60,30,67,60,0,67,90,0,67,90,30,30,90,0,30,90,30,67,90,30,30,90,0,67,90,30,67,90,0,30,90,0,30,150,30,30,90,30,30,90,0,30,150,0,30,150,30,0,150,0,0,150,30,30,150,30,0,150,0,30,150,30,30,150,0,0,0,0,0,0,30,0,150,30,0,0,0,0,150,30,0,150,0],e=M([18,0,0,1,18,0,0,-1,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,1,0,6,1,0,0,6,0,-1,0,6,1,0,0,6,0,-1,0,6,-1,0,0]),r=M([18,200,70,120,18,80,70,200,6,70,200,210,6,200,200,70,6,210,100,70,6,210,160,70,6,70,180,210,6,100,70,210,6,76,210,100,6,140,210,80,6,90,130,110,6,160,160,220],[255]),n=t.length/3,i={position:h(3,n),texcoord:h(2,n),normal:h(3,n),color:h(4,n,Uint8Array),indices:h(3,n/3,Uint16Array)};i.position.push(t),i.texcoord.push([.22,.19,.22,.79,.34,.19,.22,.79,.34,.79,.34,.19,.34,.19,.34,.31,.62,.19,.34,.31,.62,.31,.62,.19,.34,.43,.34,.55,.49,.43,.34,.55,.49,.55,.49,.43,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,0,1,0,1,1,0,1,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,1,1,0,1,0,0,1,0,1,1,0,0,0,1,1,1,0,0,1,1,1,0,0,0,0,1,1,1,0,0,1,1,1,0]),i.normal.push(e),i.color.push(r);for(var o=0;o<n;++o)i.indices.push(o);return i}function T(t,e,r,n,i,o,s){if(i<=0)throw Error("subdivisionDown must be > 0");o=o||0;var u=2,c=(s=s||1)-o,l=2*(i+1)*(2+u),m=h(3,l),f=h(3,l),_=h(2,l);function p(t,e,r){return t+(e-t)*r}function d(e,r,s,l,h,d){for(var y=0;y<=i;y++){var v=r/(u-1),b=y/i,g=2*(v-.5),x=(o+b*c)*Math.PI,A=Math.sin(x),w=Math.cos(x),B=p(t,e,A),E=g*n,M=w*t,S=A*B;m.push(E,M,S);var T=a.add(a.multiply([0,A,w],s),l);f.push(T),_.push(v*h+d,b)}}for(var y=0;y<u;y++){var v=2*(y/(u-1)-.5);d(e,y,[1,1,1],[0,0,0],1,0),d(e,y,[0,0,0],[v,0,0],0,0),d(r,y,[1,1,1],[0,0,0],1,0),d(r,y,[0,0,0],[v,0,0],0,1)}var b=h(3,2*i*(2+u),Uint16Array);function g(t,e){for(var r=0;r<i;++r)b.push(t+r+0,t+r+1,e+r+0),b.push(t+r+1,e+r+1,e+r+0)}var x=i+1;return g(0*x,4*x),g(5*x,7*x),g(6*x,2*x),g(3*x,1*x),{position:m,normal:f,texcoord:_,indices:b}}function I(t,e,r,n,i,o){return E(t,t,e,r,n,i,o)}function P(t,e,r,n,i,o){if(r<3)throw Error("radialSubdivisions must be 3 or greater");if(n<3)throw Error("verticalSubdivisions must be 3 or greater");i=i||0;for(var s=(o=o||2*Math.PI)-i,a=r+1,u=n+1,c=a*u,l=h(3,c),m=h(3,c),f=h(2,c),_=h(3,r*n*2,Uint16Array),p=0;p<u;++p)for(var d=p/n,y=d*Math.PI*2,v=Math.sin(y),b=t+v*e,g=Math.cos(y),x=g*e,A=0;A<a;++A){var w=A/r,B=i+w*s,E=Math.sin(B),M=Math.cos(B),S=E*b,T=M*b,I=E*v,P=M*v;l.push(S,x,T),m.push(I,g,P),f.push(w,1-d)}for(var C=0;C<n;++C)for(var R=0;R<r;++R){var F=1+R,D=1+C;_.push(a*C+R,a*D+R,a*C+F),_.push(a*D+R,a*D+F,a*C+F)}return{position:l,normal:m,texcoord:f,indices:_}}function C(t,e,r,n,i){if(e<3)throw Error("divisions must be at least 3");r=r||1,i=i||1,n=n||0;for(var o=(e+1)*(r+1),s=h(3,o),a=h(3,o),u=h(2,o),c=h(3,r*e*2,Uint16Array),l=0,m=t-n,f=e+1,_=0;_<=r;++_){for(var p=n+m*Math.pow(_/r,i),d=0;d<=e;++d){var y=2*Math.PI*d/e,v=p*Math.cos(y),b=p*Math.sin(y);if(s.push(v,0,b),a.push(0,1,0),u.push(1-d/e,_/r),_>0&&d!==e){var g=l+(d+1),x=l+d,A=l+d-f,w=l+(d+1)-f;c.push(g,x,A),c.push(g,A,w)}}l+=e+1}return{position:s,normal:a,texcoord:u,indices:c}}function R(t){return function(e){var r=t.apply(this,Array.prototype.slice.call(arguments,1));return n.createBuffersFromArrays(e,r)}}function F(t){return function(e){var r=t.apply(null,Array.prototype.slice.call(arguments,1));return n.createBufferInfoFromArrays(e,r)}}var D=["numComponents","size","type","normalize","stride","offset","attrib","name","attribName"];function L(t,e,r,n){n=n||0;for(var i=t.length,o=0;o<i;++o)e[r+o]=t[o]+n}function O(t,e){var r=c(t),n=new r.constructor(e),o=n;return r.numComponents&&r.numElements&&m(n,r.numComponents),t.data&&(o={data:n},i.copyNamedProperties(D,t,o)),o}var k=F(S);e.create3DFBufferInfo=k;var U=R(S);e.create3DFBuffers=U;var z=F(B);e.createCubeBufferInfo=z;var j=R(B);e.createCubeBuffers=j;var V=F(x);e.createPlaneBufferInfo=V;var N=R(x);e.createPlaneBuffers=N;var q=F(A);e.createSphereBufferInfo=q;var G=R(A);e.createSphereBuffers=G;var W=F(E);e.createTruncatedConeBufferInfo=W;var Y=R(E);e.createTruncatedConeBuffers=Y;var X=F(g);e.createXYQuadBufferInfo=X;var K=R(g);e.createXYQuadBuffers=K;var H=F(T);e.createCresentBufferInfo=H;var J=R(T);e.createCresentBuffers=J;var Z=F(I);e.createCylinderBufferInfo=Z;var Q=R(I);e.createCylinderBuffers=Q;var $=F(P);e.createTorusBufferInfo=$;var tt=R(P);e.createTorusBuffers=tt;var et=F(C);e.createDiscBufferInfo=et;var rt=R(C);e.createDiscBuffers=rt},function(t,e,r){"use strict";e.__esModule=!0;var n={addExtensionsToContext:!0,getContext:!0,getWebGLContext:!0,resizeCanvasToDisplaySize:!0,setDefaults:!0};e.addExtensionsToContext=v,e.getContext=function(t,e){return function(t,e){for(var r=["webgl2","webgl","experimental-webgl"],n=null,i=0;i<r.length;++i)if(n=t.getContext(r[i],e)){_.addExtensionsToContext&&v(n);break}return n}(t,e)},e.getWebGLContext=function(t,e){return function(t,e){for(var r=["webgl","experimental-webgl"],n=null,i=0;i<r.length;++i)if(n=t.getContext(r[i],e)){_.addExtensionsToContext&&v(n);break}return n}(t,e)},e.resizeCanvasToDisplaySize=function(t,e){e=e||1,e=Math.max(0,e);var r=t.clientWidth*e|0,n=t.clientHeight*e|0;if(t.width!==r||t.height!==n)return t.width=r,t.height=n,!0;return!1},e.setDefaults=function(t){s.copyExistingProperties(t,_),i.setAttributeDefaults_(t),o.setTextureDefaults_(t)};var i=f(r(7));Object.keys(i).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(e[t]=i[t]))});var o=f(r(8));Object.keys(o).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(e[t]=o[t]))});var s=f(r(0)),a=f(r(4));Object.keys(a).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(e[t]=a[t]))});var u=r(12);Object.keys(u).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(e[t]=u[t]))});var c=r(13);Object.keys(c).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(e[t]=c[t]))});var l=r(5);Object.keys(l).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(e[t]=l[t]))});var m=r(1);Object.keys(m).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(e[t]=m[t]))});var h=r(14);function f(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}Object.keys(h).forEach(function(t){"default"!==t&&"__esModule"!==t&&(Object.prototype.hasOwnProperty.call(n,t)||(e[t]=h[t]))});var _={addExtensionsToContext:!0};var p=/^(.*?)_/;function d(t,e){a.glEnumToString(t,0);var r=t.getExtension(e);if(r){var n={},i=p.exec(e)[1],o="_"+i;for(var u in r){var c=r[u],l="function"==typeof c,m=l?i:o,h=u;u.endsWith(m)&&(h=u.substring(0,u.length-m.length)),void 0!==t[h]?l||t[h]===c||s.warn(h,t[h],c,u):l?t[h]=function(t){return function(){return t.apply(r,arguments)}}(c):(t[h]=c,n[h]=c)}n.constructor={name:r.constructor.name},a.glEnumToString(n,0)}return r}var y=["ANGLE_instanced_arrays","EXT_blend_minmax","EXT_color_buffer_float","EXT_color_buffer_half_float","EXT_disjoint_timer_query","EXT_disjoint_timer_query_webgl2","EXT_frag_depth","EXT_sRGB","EXT_shader_texture_lod","EXT_texture_filter_anisotropic","OES_element_index_uint","OES_standard_derivatives","OES_texture_float","OES_texture_float_linear","OES_texture_half_float","OES_texture_half_float_linear","OES_vertex_array_object","WEBGL_color_buffer_float","WEBGL_compressed_texture_atc","WEBGL_compressed_texture_etc1","WEBGL_compressed_texture_pvrtc","WEBGL_compressed_texture_s3tc","WEBGL_compressed_texture_s3tc_srgb","WEBGL_depth_texture","WEBGL_draw_buffers"];function v(t){for(var e=0;e<y.length;++e)d(t,y[e])}},function(t,e,r){"use strict";e.__esModule=!0,e.drawBufferInfo=i,e.drawObjectList=function(t,e){var r=null,o=null;e.forEach(function(e){if(!1!==e.active){var s=e.programInfo,a=e.vertexArrayInfo||e.bufferInfo,u=!1,c=void 0===e.type?t.TRIANGLES:e.type;s!==r&&(r=s,t.useProgram(s.program),u=!0),(u||a!==o)&&(o&&o.vertexArrayObject&&!a.vertexArrayObject&&t.bindVertexArray(null),o=a,n.setBuffersAndAttributes(t,s,a)),n.setUniforms(s,e.uniforms),i(t,a,c,e.count,e.offset,e.instanceCount)}}),o.vertexArrayObject&&t.bindVertexArray(null)};var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}(r(5));function i(t,e,r,n,i,o){r=void 0===r?t.TRIANGLES:r;var s=e.indices,a=e.elementType,u=void 0===n?e.numElements:n;i=void 0===i?0:i,a||s?void 0!==o?t.drawElementsInstanced(r,u,void 0===a?t.UNSIGNED_SHORT:e.elementType,i,o):t.drawElements(r,u,void 0===a?t.UNSIGNED_SHORT:e.elementType,i):void 0!==o?t.drawArraysInstanced(r,i,u,o):t.drawArrays(r,i,u)}},function(t,e,r){"use strict";e.__esModule=!0,e.bindFramebufferInfo=function(t,e,r){r=r||t.FRAMEBUFFER,e?(t.bindFramebuffer(r,e.framebuffer),t.viewport(0,0,e.width,e.height)):(t.bindFramebuffer(r,null),t.viewport(0,0,t.drawingBufferWidth,t.drawingBufferHeight))},e.createFramebufferInfo=function(t,e,r,o){var l=t.FRAMEBUFFER,m=t.createFramebuffer();t.bindFramebuffer(l,m),r=r||t.drawingBufferWidth,o=o||t.drawingBufferHeight;var h=0,f={framebuffer:m,attachments:[],width:r,height:o};return(e=e||a).forEach(function(e){var a=e.attachment,m=e.format,_=function(t){return u[t]}(m);if(_||(_=s+h++),!a)if(function(t){return c[t]}(m))a=t.createRenderbuffer(),t.bindRenderbuffer(t.RENDERBUFFER,a),t.renderbufferStorage(t.RENDERBUFFER,m,r,o);else{var p=Object.assign({},e);p.width=r,p.height=o,void 0===p.auto&&(p.auto=!1,p.min=p.min||p.minMag||t.LINEAR,p.mag=p.mag||p.minMag||t.LINEAR,p.wrapS=p.wrapS||p.wrap||t.CLAMP_TO_EDGE,p.wrapT=p.wrapT||p.wrap||t.CLAMP_TO_EDGE),a=n.createTexture(t,p)}if(i.isRenderbuffer(t,a))t.framebufferRenderbuffer(l,_,t.RENDERBUFFER,a);else{if(!i.isTexture(t,a))throw"unknown attachment type";t.framebufferTexture2D(l,_,e.texTarget||t.TEXTURE_2D,a,e.level||0)}f.attachments.push(a)}),f},e.resizeFramebufferInfo=function(t,e,r,o,s){o=o||t.drawingBufferWidth,s=s||t.drawingBufferHeight,e.width=o,e.height=s,(r=r||a).forEach(function(r,a){var u=e.attachments[a],c=r.format;if(i.isRenderbuffer(t,u))t.bindRenderbuffer(t.RENDERBUFFER,u),t.renderbufferStorage(t.RENDERBUFFER,c,o,s);else{if(!i.isTexture(t,u))throw"unknown attachment type";n.resizeTexture(t,u,r,o,s)}})};var n=o(r(8)),i=o(r(0));function o(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}var s=36064,a=[{format:6408,type:5121,min:9729,wrap:33071},{format:34041}],u={};u[34041]=33306,u[6401]=36128,u[36168]=36128,u[6402]=36096,u[33189]=36096;var c={};c[32854]=!0,c[32855]=!0,c[36194]=!0,c[34041]=!0,c[33189]=!0,c[6401]=!0,c[36168]=!0},function(t,e,r){"use strict";e.__esModule=!0,e.createVertexArrayInfo=function(t,e,r){var i=t.createVertexArray();t.bindVertexArray(i),e.length||(e=[e]);return e.forEach(function(e){n.setBuffersAndAttributes(t,e,r)}),t.bindVertexArray(null),{numElements:r.numElements,elementType:r.elementType,vertexArrayObject:i}},e.createVAOAndSetAttributes=i,e.createVAOFromBufferInfo=function(t,e,r){return i(t,e.attribSetters||e,r.attribs,r.indices)};var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}(r(5));function i(t,e,r,i){var o=t.createVertexArray();return t.bindVertexArray(o),n.setAttributes(e,r),i&&t.bindBuffer(t.ELEMENT_ARRAY_BUFFER,i),t.bindVertexArray(null),o}}])})},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Loader=void 0;var n=r(27),i=function(t){return t&&t.__esModule?t:{default:t}}(r(5)),o=r(1);function s(){var t=u(["No texture value for key ",""]);return s=function(){return t},t}function a(){var t=u(["No value for key ",""]);return a=function(){return t},t}function u(t,e){return e||(e=t.slice(0)),Object.freeze(Object.defineProperties(t,{raw:{value:Object.freeze(e)}}))}function c(t,e,r,n,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,i)}function l(t){return function(){var e=this,r=arguments;return new Promise(function(n,i){var o=t.apply(e,r);function s(t){c(o,n,i,s,a,"next",t)}function a(t){c(o,n,i,s,a,"throw",t)}s(void 0)})}}function m(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function h(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function f(t){return new Promise(function(e,r){i.default.createTextures(o.gl,t,function(t,r,n){e({errors:t,textures:r,images:n})})})}o.gl;var _=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.cache=new Map,this.textureCache=new Map,this.programCache=new Map,this.errors={programs:new Map,textures:new Map,paths:new Map},this.loading=null,this.load(e)}return function(t,e,r){e&&h(t.prototype,e),r&&h(t,r)}(t,[{key:"load",value:function(t){var e=this,r=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){m(t,e,r[e])})}return t}({basePath:"",raiseOnFailure:!0},t),s=r.basePath,a=r.raiseOnFailure,u=r.paths,c=r.textures,h=r.programs;s=s.replace(/\/+$/,"");var _=new Promise(function(){var t=l(regeneratorRuntime.mark(function t(r,l){var m,_,p,d,y,v,b,g,x,A,w,B,E,M;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(!u){t.next=3;break}return t.next=3,e.loadPaths(u,s,a);case 3:if(!c){t.next=12;break}return t.next=6,f(c);case 6:m=t.sent,_=m.errors,p=m.textures,m.images,_&&console.log(_),Object.keys(p).forEach(function(t){e.textureCache.set(t,p[t])});case 12:if(!h){t.next=49;break}d=!0,y=!1,v=void 0,t.prev=16,b=h[Symbol.iterator]();case 18:if(d=(g=b.next()).done){t.next=35;break}if(x=g.value,A=x,w=void 0,n._.isObject(x)&&(A=x.name,w=x.opts),!e.programCache.has(A)){t.next=26;break}return console.log("Warning: attempted to load already loaded program '".concat(A,"'")),t.abrupt("continue",32);case 26:return B=n._.compact([s,A.split(".").join("/")]).join("/"),E="".concat(B,".vert"),M="".concat(B,".frag"),t.next=31,e.loadPaths([E,M],"",a);case 31:e.programCache.set(A,i.default.createProgramInfo(o.gl,[e.get(E),e.get(M)],w));case 32:d=!0,t.next=18;break;case 35:t.next=41;break;case 37:t.prev=37,t.t0=t.catch(16),y=!0,v=t.t0;case 41:t.prev=41,t.prev=42,d||null==b.return||b.return();case 44:if(t.prev=44,!y){t.next=47;break}throw v;case 47:return t.finish(44);case 48:return t.finish(41);case 49:r(e);case 50:case"end":return t.stop()}},t,this,[[16,37,41,49],[42,,44,48]])}));return function(e,r){return t.apply(this,arguments)}}());return this.loading=this.loading?this.loading.then(function(t){return _}):_,this.loading}},{key:"get",value:function(t){var e=this.cache.get(t);return void 0===e&&raise(a(),t),e}},{key:"getTexture",value:function(t){var e=this.textureCache.get(t);return void 0===e&&raise(s(),path),e}},{key:"getProgram",value:function(t){return this.programCache.get(t)}},{key:"loadPaths",value:function(){var t=l(regeneratorRuntime.mark(function t(e,r){var n,i,o,s,a,u,c,l,m=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:n=!(m.length>2&&void 0!==m[2])||m[2],i=!0,o=!1,s=void 0,t.prev=4,a=e[Symbol.iterator]();case 6:if(i=(u=a.next()).done){t.next=18;break}if(c=u.value,!this.cache.has(r+c)){t.next=11;break}return console.log("Warning: attempted to load already loaded path '".concat(r+c,"'")),t.abrupt("continue",15);case 11:return t.next=13,this.fetch(r+c,n);case 13:(l=t.sent)&&this.cache.set(r+c,l);case 15:i=!0,t.next=6;break;case 18:t.next=24;break;case 20:t.prev=20,t.t0=t.catch(4),o=!0,s=t.t0;case 24:t.prev=24,t.prev=25,i||null==a.return||a.return();case 27:if(t.prev=27,!o){t.next=30;break}throw s;case 30:return t.finish(27);case 31:return t.finish(24);case 32:case"end":return t.stop()}},t,this,[[4,20,24,32],[25,,27,31]])}));return function(e,r){return t.apply(this,arguments)}}()},{key:"fetch",value:function(t){function e(e){return t.apply(this,arguments)}return e.toString=function(){return t.toString()},e}(function(){var t=l(regeneratorRuntime.mark(function t(e){var r,n,i=arguments;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return r=!(i.length>1&&void 0!==i[1])||i[1],t.next=3,fetch(e);case 3:if(!(n=t.sent).ok){t.next=10;break}return t.next=7,n.text();case 7:return t.abrupt("return",t.sent);case 10:if(!r){t.next=14;break}throw"failed to fetch resource '".concat(e,"'; got status ").concat(n.status," '").concat(n.statusText,"'");case 14:return this.errors.paths.set(e,n.statusText),t.abrupt("return",!1);case 16:case"end":return t.stop()}},t,this)}));return function(e){return t.apply(this,arguments)}}())}]),t}();e.Loader=_},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.initCanvas=e.App=e.default=void 0;var n=r(38),i=r(26),o=r(2),s=r(1),a=r(15);r(35);var u=r(17),c=r(18),l=r(29);function m(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function h(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _(t,e){console.log("gl."+t+"("+WebGLDebugUtils.glFunctionArgsToString(t,e)+")")}e.initCanvas=function(t,e){if(!t)throw new Error("argument containerId, id of containing element required");var r=document.getElementById(t),n=document.createElement("canvas");return e&&n.classList.add(e),r.appendChild(n),n};var p=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.clearColor=e.clearColor||[.4,.4,.4,1],this.resolution=e.resolution||{width:352,height:224},this.pixelMultiplier=e.pixelMultiplier||2,this.debug=e.debug,"string"==typeof e.el?this.canvas=document.getElementById(e.el):this.canvas=e.el,this.gl=this.canvas.getContext("webgl2"),this.debug&&(WebGLDebugUtils.init(this.gl),this.gl=WebGLDebugUtils.makeDebugContext(this.gl,void 0,_)),(0,s.registerContext)(this.gl),s.gl.blendFunc(s.gl.SRC_ALPHA,s.gl.ONE_MINUS_SRC_ALPHA),s.gl.enable(s.gl.BLEND),this.framebuffer=(0,a.attachFramebuffer)(s.gl,this.resolution.width,this.resolution.height),this.framebufferRenderer=new c.SpriteRenderer({game:this,textureInfo:function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){h(t,e,r[e])})}return t}({texture:this.framebuffer.texture},this.resolution)}),this.loader=new n.Loader,this.projection=o.mat4.ortho(o.mat4.create(),0,this.resolution.width,0,this.resolution.height,-1,1),this.camera=new l.Camera(this.resolution),this.cameraEnabled=!0,this.updateCanvasSize(),this.adjustViewport()}return function(t,e,r){e&&f(t.prototype,e),r&&f(t,r)}(t,[{key:"updateCanvasSize",value:function(){var t=this.resolution.width*this.pixelMultiplier,e=this.resolution.height*this.pixelMultiplier;this.canvas.style.width="".concat(t,"px"),this.canvas.style.height="".concat(e,"px"),this.canvas.width=t*(window.devicePixelRatio||1),this.canvas.height=e*(window.devicePixelRatio||1)}},{key:"adjustViewport",value:function(){var t=this.canvas.width,e=this.canvas.height;this.gl.viewport(0,0,this.canvas.width,this.canvas.height),this._canvasToWorld=i.CoordinateConversions.canvasToWorldMatrix(this.camera.matrix,{width:t,height:e},this.resolution)}},{key:"clear",value:function(){var t;(t=this.gl).clearColor.apply(t,m(this.clearColor)),this.gl.clear(this.gl.COLOR_BUFFER_BIT)}},{key:"load",value:function(t){return this.loader.load(t)}},{key:"getProgram",value:function(t){var e=this.loader.getProgram(t);if(!e)throw"No program loaded for key '".concat(t,"'");return e}},{key:"enableCamera",value:function(){this.cameraEnabled=!0}},{key:"disableCamera",value:function(){this.cameraEnabled=!1}},{key:"beginRenderToTexture",value:function(){this.framebuffer.attach(),this.clear()}},{key:"endRenderToTexture",value:function(){this.framebuffer.detach(),this.adjustViewport()}},{key:"start",value:function(){var t,e=this;this.running||(requestAnimationFrame(function r(n){t||(t=n);var i=n-t;t=n,e.stage&&(e.stage.prerender(i),e.beginRenderToTexture(),e.stage.render(i),e.stage.postrender(i),e.endRenderToTexture(),e.clear(),e.framebufferRenderer.render([new u.Sprite({position:[0,0],size:[e.resolution.width,e.resolution.height]})],e.projection)),e.running&&requestAnimationFrame(r)}),this.running=!0)}},{key:"setStage",value:function(t){this.stage=t,t.app=this,t.init(this)}},{key:"canvasToWorld",get:function(){return this._canvasToWorld}},{key:"viewMatrix",get:function(){var t=o.mat4.create();return this.cameraEnabled&&(t=this.camera.matrix),o.mat4.multiply(o.mat4.create(),this.projection,t)}}]),t}();e.App=p;var d=p;e.default=d},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=c;var i=r(7),o=r(4),s=r(3),a=r(12),u=r(14);function c(t,e){n&&i.assert(void 0===t),n&&i.assert(void 0===e),this.localCenter=s.zero(),this.c=s.zero(),this.a=0,this.alpha0=0,this.c0=s.zero(),this.a0=0}c.prototype.setTransform=function(t){var e=u.mul(t,this.localCenter);this.c.set(e),this.c0.set(e),this.a=t.q.getAngle(),this.a0=t.q.getAngle()},c.prototype.setLocalCenter=function(t,e){this.localCenter.set(t);var r=u.mul(e,this.localCenter);this.c.set(r),this.c0.set(r)},c.prototype.getTransform=function(t,e){e=void 0===e?0:e,t.q.setAngle((1-e)*this.a0+e*this.a),t.p.wSet(1-e,this.c0,e,this.c),t.p.sub(a.mul(t.q,this.localCenter))},c.prototype.advance=function(t){n&&i.assert(this.alpha0<1);var e=(t-this.alpha0)/(1-this.alpha0);this.c0.wSet(e,this.c,1-e,this.c0),this.a0=e*this.a+(1-e)*this.a0,this.alpha0=t},c.prototype.forward=function(){this.a0=this.a,this.c0.set(this.c)},c.prototype.normalize=function(){var t=o.mod(this.a0,-o.PI,+o.PI);this.a-=this.a0-t,this.a0=t},c.prototype.clone=function(){var t=new c;return t.localCenter.set(this.localCenter),t.alpha0=this.alpha0,t.a0=this.a0,t.a=this.a,t.c0.set(this.c0),t.c.set(this.c),t},c.prototype.set=function(t){this.localCenter.set(t.localCenter),this.alpha0=t.alpha0,this.a0=t.a0,this.a=t.a,this.c0.set(t.c0),this.c.set(t.c)}},,function(t,e,r){var n="undefined"!=typeof DEBUG&&DEBUG,i="undefined"!=typeof ASSERT&&ASSERT;t.exports=a;var o=r(7),s=r(4);function a(t,e,r){if(!(this instanceof a))return new a(t,e,r);void 0===t?(this.x=0,this.y=0,this.z=0):"object"==typeof t?(this.x=t.x,this.y=t.y,this.z=t.z):(this.x=t,this.y=e,this.z=r),i&&a.assert(this)}a.prototype.toString=function(){return JSON.stringify(this)},a.isValid=function(t){return t&&s.isFinite(t.x)&&s.isFinite(t.y)&&s.isFinite(t.z)},a.assert=function(t){if(i&&!a.isValid(t))throw n&&o.debug(t),new Error("Invalid Vec3!")},a.prototype.setZero=function(){return this.x=0,this.y=0,this.z=0,this},a.prototype.set=function(t,e,r){return this.x=t,this.y=e,this.z=r,this},a.prototype.add=function(t){return this.x+=t.x,this.y+=t.y,this.z+=t.z,this},a.prototype.sub=function(t){return this.x-=t.x,this.y-=t.y,this.z-=t.z,this},a.prototype.mul=function(t){return this.x*=t,this.y*=t,this.z*=t,this},a.areEqual=function(t,e){return t==e||"object"==typeof e&&null!==e&&t.x==e.x&&t.y==e.y&&t.z==e.z},a.dot=function(t,e){return t.x*e.x+t.y*e.y+t.z*e.z},a.cross=function(t,e){return new a(t.y*e.z-t.z*e.y,t.z*e.x-t.x*e.z,t.x*e.y-t.y*e.x)},a.add=function(t,e){return new a(t.x+e.x,t.y+e.y,t.z+e.z)},a.sub=function(t,e){return new a(t.x-e.x,t.y-e.y,t.z-e.z)},a.mul=function(t,e){return new a(e*t.x,e*t.y,e*t.z)},a.prototype.neg=function(t){return this.x=-this.x,this.y=-this.y,this.z=-this.z,this},a.neg=function(t){return new a(-t.x,-t.y,-t.z)}},function(t,e,r){var n="undefined"!=typeof DEBUG&&DEBUG,i="undefined"!=typeof ASSERT&&ASSERT;t.exports=a;var o=r(7),s=(r(4),r(3));function a(t,e,r,n){"object"==typeof t&&null!==t?(this.ex=s.clone(t),this.ey=s.clone(e)):"number"==typeof t?(this.ex=s.neo(t,r),this.ey=s.neo(e,n)):(this.ex=s.zero(),this.ey=s.zero())}a.prototype.toString=function(){return JSON.stringify(this)},a.isValid=function(t){return t&&s.isValid(t.ex)&&s.isValid(t.ey)},a.assert=function(t){if(i&&!a.isValid(t))throw n&&o.debug(t),new Error("Invalid Mat22!")},a.prototype.set=function(t,e,r,n){"number"==typeof t&&"number"==typeof e&&"number"==typeof r&&"number"==typeof n?(this.ex.set(t,r),this.ey.set(e,n)):"object"==typeof t&&"object"==typeof e?(this.ex.set(t),this.ey.set(e)):"object"==typeof t?(i&&a.assert(t),this.ex.set(t.ex),this.ey.set(t.ey)):i&&o.assert(!1)},a.prototype.setIdentity=function(){this.ex.x=1,this.ey.x=0,this.ex.y=0,this.ey.y=1},a.prototype.setZero=function(){this.ex.x=0,this.ey.x=0,this.ex.y=0,this.ey.y=0},a.prototype.getInverse=function(){var t=this.ex.x,e=this.ey.x,r=this.ex.y,n=this.ey.y,i=t*n-e*r;0!=i&&(i=1/i);var o=new a;return o.ex.x=i*n,o.ey.x=-i*e,o.ex.y=-i*r,o.ey.y=i*t,o},a.prototype.solve=function(t){i&&s.assert(t);var e=this.ex.x,r=this.ey.x,n=this.ex.y,o=this.ey.y,a=e*o-r*n;0!=a&&(a=1/a);var u=s.zero();return u.x=a*(o*t.x-r*t.y),u.y=a*(e*t.y-n*t.x),u},a.mul=function(t,e){if(e&&"x"in e&&"y"in e){i&&s.assert(e);var r=t.ex.x*e.x+t.ey.x*e.y,n=t.ex.y*e.x+t.ey.y*e.y;return s.neo(r,n)}if(e&&"ex"in e&&"ey"in e)return i&&a.assert(e),new a(s.mul(t,e.ex),s.mul(t,e.ey));i&&o.assert(!1)},a.mulT=function(t,e){return e&&"x"in e&&"y"in e?(i&&s.assert(e),s.neo(s.dot(e,t.ex),s.dot(e,t.ey))):e&&"ex"in e&&"ey"in e?(i&&a.assert(e),new a(s.neo(s.dot(t.ex,e.ex),s.dot(t.ey,e.ex)),s.neo(s.dot(t.ex,e.ey),s.dot(t.ey,e.ey)))):void(i&&o.assert(!1))},a.abs=function(t){return i&&a.assert(t),new a(s.abs(t.ex),s.abs(t.ey))},a.add=function(t,e){return i&&a.assert(t),i&&a.assert(e),new a(s.add(t.ex+e.ex),s.add(t.ey+e.ey))}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports=o;var n=r(3),i=r(12);function o(){this.c=n.zero(),this.a=0}o.prototype.getTransform=function(t,e){return t.q.set(this.a),t.p.set(n.sub(this.c,i.mul(t.q,e))),t}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports=function(){this.v=n.zero(),this.w=0};var n=r(3)},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=s;var i=r(7);function o(){this.other=null,this.joint=null,this.prev=null,this.next=null}function s(t,e,r){e=t.bodyA||e,r=t.bodyB||r,n&&i.assert(e),n&&i.assert(r),n&&i.assert(e!=r),this.m_type="unknown-joint",this.m_bodyA=e,this.m_bodyB=r,this.m_index=0,this.m_collideConnected=!!t.collideConnected,this.m_prev=null,this.m_next=null,this.m_edgeA=new o,this.m_edgeB=new o,this.m_islandFlag=!1,this.m_userData=t.userData}s.prototype.isActive=function(){return this.m_bodyA.isActive()&&this.m_bodyB.isActive()},s.prototype.getType=function(){return this.m_type},s.prototype.getBodyA=function(){return this.m_bodyA},s.prototype.getBodyB=function(){return this.m_bodyB},s.prototype.getNext=function(){return this.m_next},s.prototype.getUserData=function(){return this.m_userData},s.prototype.setUserData=function(t){this.m_userData=t},s.prototype.getCollideConnected=function(){return this.m_collideConnected},s.prototype.getAnchorA=function(){},s.prototype.getAnchorB=function(){},s.prototype.getReactionForce=function(t){},s.prototype.getReactionTorque=function(t){},s.prototype.shiftOrigin=function(t){},s.prototype.initVelocityConstraints=function(t){},s.prototype.solveVelocityConstraints=function(t){},s.prototype.solvePositionConstraints=function(t){}},function(t,e,r){var n="undefined"!=typeof DEBUG&&DEBUG,i="undefined"!=typeof ASSERT&&ASSERT;t.exports=u;var o=r(7),s=(r(4),r(3)),a=r(42);function u(t,e,r){"object"==typeof t&&null!==t?(this.ex=a.clone(t),this.ey=a.clone(e),this.ez=a.clone(r)):(this.ex=a(),this.ey=a(),this.ez=a())}u.prototype.toString=function(){return JSON.stringify(this)},u.isValid=function(t){return t&&a.isValid(t.ex)&&a.isValid(t.ey)&&a.isValid(t.ez)},u.assert=function(t){if(i&&!u.isValid(t))throw n&&o.debug(t),new Error("Invalid Mat33!")},u.prototype.setZero=function(){return this.ex.setZero(),this.ey.setZero(),this.ez.setZero(),this},u.prototype.solve33=function(t){var e=a.dot(this.ex,a.cross(this.ey,this.ez));0!=e&&(e=1/e);var r=new a;return r.x=e*a.dot(t,a.cross(this.ey,this.ez)),r.y=e*a.dot(this.ex,a.cross(t,this.ez)),r.z=e*a.dot(this.ex,a.cross(this.ey,t)),r},u.prototype.solve22=function(t){var e=this.ex.x,r=this.ey.x,n=this.ex.y,i=this.ey.y,o=e*i-r*n;0!=o&&(o=1/o);var a=s.zero();return a.x=o*(i*t.x-r*t.y),a.y=o*(e*t.y-n*t.x),a},u.prototype.getInverse22=function(t){var e=this.ex.x,r=this.ey.x,n=this.ex.y,i=this.ey.y,o=e*i-r*n;0!=o&&(o=1/o),t.ex.x=o*i,t.ey.x=-o*r,t.ex.z=0,t.ex.y=-o*n,t.ey.y=o*e,t.ey.z=0,t.ez.x=0,t.ez.y=0,t.ez.z=0},u.prototype.getSymInverse33=function(t){var e=a.dot(this.ex,a.cross(this.ey,this.ez));0!=e&&(e=1/e);var r=this.ex.x,n=this.ey.x,i=this.ez.x,o=this.ey.y,s=this.ez.y,u=this.ez.z;t.ex.x=e*(o*u-s*s),t.ex.y=e*(i*s-n*u),t.ex.z=e*(n*s-i*o),t.ey.x=t.ex.y,t.ey.y=e*(r*u-i*i),t.ey.z=e*(i*n-r*s),t.ez.x=t.ex.z,t.ez.y=t.ey.z,t.ez.z=e*(r*o-n*n)},u.mul=function(t,e){if(i&&u.assert(t),e&&"z"in e&&"y"in e&&"x"in e){i&&a.assert(e);var r=t.ex.x*e.x+t.ey.x*e.y+t.ez.x*e.z,n=t.ex.y*e.x+t.ey.y*e.y+t.ez.y*e.z,c=t.ex.z*e.x+t.ey.z*e.y+t.ez.z*e.z;return new a(r,n,c)}if(e&&"y"in e&&"x"in e){i&&s.assert(e);r=t.ex.x*e.x+t.ey.x*e.y,n=t.ex.y*e.x+t.ey.y*e.y;return s.neo(r,n)}i&&o.assert(!1)},u.add=function(t,e){return i&&u.assert(t),i&&u.assert(e),new a(t.x+e.x,t.y+e.y,t.z+e.z)}},,,,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Grid=void 0;var n=a(r(5)),i=r(1),o=a(r(58)),s=a(r(57));function a(t){return t&&t.__esModule?t:{default:t}}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=new Float32Array([0,0,1,0,0,1,1,1]);var l=null,m=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.resolution=e.resolution,l||(l=n.default.createProgramInfo(i.gl,[o.default,s.default])),this.programInfo=l,this.bufferInfo=n.default.createBufferInfoFromArrays(i.gl,{vertex:{data:c,numComponents:2,divisor:0,drawType:i.gl.STATIC_DRAW},position:{numComponents:2,divisor:1,drawType:i.gl.DYNAMIC_DRAW},size:{numComponents:2,divisor:1,drawType:i.gl.DYNAMIC_DRAW},indices:{data:[0,1,2,3]}}),this.vao=n.default.createVertexArrayInfo(i.gl,this.programInfo,this.bufferInfo),this.grids=[]}return function(t,e,r){e&&u(t.prototype,e),r&&u(t,r)}(t,[{key:"addGrid",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:32,e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:32,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:[1,1,1,1],n=arguments.length>3&&void 0!==arguments[3]?arguments[3]:2,i=Math.ceil(this.resolution.width/t)+1,o=Math.ceil(this.resolution.height/e)+1,s=i+o,a=function(t,e,r){for(var n=t.xcells,i=t.ycells,o=e.w,s=e.h,a=r.lineWidth,u=new Float32Array(2*(n+i)),c=new Float32Array(2*(n+i)),l=o*(n+1),m=s*(i+1),h=0;h<i;++h)u[2*h]=0,u[2*h+1]=h*s,c[2*h]=l,c[2*h+1]=a;for(var f=0;f<n;++f)u[2*i+2*f]=f*o,u[2*i+2*f+1]=0,c[2*i+2*f]=a,c[2*i+2*f+1]=m;return{position:u,size:c}}({xcells:i,ycells:o},{w:t,h:e},{lineWidth:n}),u=a.position,c=a.size;this.grids.push({position:u,size:c,instanceCount:s,lineColor:r,sx:t,sy:e})}},{key:"render",value:function(t,e,r){var o=this;i.gl.useProgram(this.programInfo.program),n.default.setBuffersAndAttributes(i.gl,this.programInfo,this.vao);var s=[t,e];this.grids.forEach(function(t){var e=t.position,a=t.size,u=t.instanceCount,c=t.lineColor,l=t.sx,m=t.sy,h=[s[0]%l,s[1]%m];h[0]>0&&(h[0]=h[0]-l),h[1]>0&&(h[1]=h[1]-m),n.default.setAttribInfoBufferFromArray(i.gl,o.bufferInfo.attribs.position,e),n.default.setAttribInfoBufferFromArray(i.gl,o.bufferInfo.attribs.size,a),n.default.setUniforms(o.programInfo,{line_color:c,projection:r,offset:h}),n.default.drawBufferInfo(i.gl,o.vao,i.gl.TRIANGLE_STRIP,void 0,void 0,u)})}}]),t}();e.Grid=m},,,,,function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports=n;r(4);function n(){this.m_type,this.m_radius}n.isValid=function(t){return!!t},n.prototype.getRadius=function(){return this.m_radius},n.prototype.getType=function(){return this.m_type},n.prototype._clone=function(){},n.prototype.getChildCount=function(){},n.prototype.testPoint=function(t,e){},n.prototype.rayCast=function(t,e,r,n){},n.prototype.computeAABB=function(t,e,r){},n.prototype.computeMass=function(t,e){},n.prototype.computeDistanceProxy=function(t){}},function(t,e){t.exports="#version 300 es\n\nprecision mediump float;\n\nuniform vec4 line_color;\n\nout vec4 out_color;\n\nvoid main() {\n    out_color = line_color;\n}\n"},function(t,e){t.exports="#version 300 es\n\nlayout(location = 0) in vec2 vertex;\nlayout(location = 1) in vec2 position;\nlayout(location = 2) in vec2 size;\n\nuniform mat4 projection;\nuniform vec2 offset;\n\nvoid main() {\n    vec4 transformed_position = projection * vec4(position + size * vertex + offset, 0, 1);\n    gl_Position = transformed_position;\n}\n"},,,,function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,r(13);var n=r(4),i=r(3);function o(t,e){if(!(this instanceof o))return new o(t,e);this.lowerBound=i.zero(),this.upperBound=i.zero(),"object"==typeof t&&this.lowerBound.set(t),"object"==typeof e&&this.upperBound.set(e)}t.exports=o,o.prototype.isValid=function(){return o.isValid(this)},o.isValid=function(t){var e=i.sub(t.upperBound,t.lowerBound);return e.x>=0&&e.y>=0&&i.isValid(t.lowerBound)&&i.isValid(t.upperBound)},o.prototype.getCenter=function(){return i.neo(.5*(this.lowerBound.x+this.upperBound.x),.5*(this.lowerBound.y+this.upperBound.y))},o.prototype.getExtents=function(){return i.neo(.5*(this.upperBound.x-this.lowerBound.x),.5*(this.upperBound.y-this.lowerBound.y))},o.prototype.getPerimeter=function(){return 2*(this.upperBound.x-this.lowerBound.x+this.upperBound.y-this.lowerBound.y)},o.prototype.combine=function(t,e){e=e||this,this.lowerBound.set(n.min(t.lowerBound.x,e.lowerBound.x),n.min(t.lowerBound.y,e.lowerBound.y)),this.upperBound.set(n.max(t.upperBound.x,e.upperBound.x),n.max(t.upperBound.y,e.upperBound.y))},o.prototype.combinePoints=function(t,e){this.lowerBound.set(n.min(t.x,e.x),n.min(t.y,e.y)),this.upperBound.set(n.max(t.x,e.x),n.max(t.y,e.y))},o.prototype.set=function(t){this.lowerBound.set(t.lowerBound.x,t.lowerBound.y),this.upperBound.set(t.upperBound.x,t.upperBound.y)},o.prototype.contains=function(t){var e=!0;return e=(e=(e=(e=e&&this.lowerBound.x<=t.lowerBound.x)&&this.lowerBound.y<=t.lowerBound.y)&&t.upperBound.x<=this.upperBound.x)&&t.upperBound.y<=this.upperBound.y},o.prototype.extend=function(t){o.extend(this,t)},o.extend=function(t,e){t.lowerBound.x-=e,t.lowerBound.y-=e,t.upperBound.x+=e,t.upperBound.y+=e},o.testOverlap=function(t,e){var r=e.lowerBound.x-t.upperBound.x,n=t.lowerBound.x-e.upperBound.x,i=e.lowerBound.y-t.upperBound.y,o=t.lowerBound.y-e.upperBound.y;return!(r>0||i>0||n>0||o>0)},o.areEqual=function(t,e){return i.areEqual(t.lowerBound,e.lowerBound)&&i.areEqual(t.upperBound,e.upperBound)},o.diff=function(t,e){var r=n.max(0,n.min(t.upperBound.x,e.upperBound.x)-n.max(e.lowerBound.x,t.lowerBound.x)),i=n.max(0,n.min(t.upperBound.y,e.upperBound.y)-n.max(e.lowerBound.y,t.lowerBound.y));return(t.upperBound.x-t.lowerBound.x)*(t.upperBound.y-t.lowerBound.y)+(e.upperBound.x-e.lowerBound.x)*(e.upperBound.y-e.lowerBound.y)-r*i},o.prototype.rayCast=function(t,e){for(var r=-1/0,o=1/0,s=e.p1,a=i.sub(e.p2,e.p1),u=i.abs(a),c=i.zero(),l="x";null!==l;l="x"===l?"y":null)if(u.x<n.EPSILON){if(s[l]<this.lowerBound[l]||this.upperBound[l]<s[l])return!1}else{var m=1/a[l],h=(this.lowerBound[l]-s[l])*m,f=(this.upperBound[l]-s[l])*m,_=-1;if(h>f){var p=h;h=f,f=p,_=1}if(h>r&&(c.setZero(),c[l]=_,r=h),r>(o=n.min(o,f)))return!1}return!(r<0||e.maxFraction<r)&&(t.fraction=r,t.normal=c,!0)},o.prototype.toString=function(){return JSON.stringify(this)}},,,,,,,,,,,function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,i=r(7),o=r(4),s=r(3),a=r(14),u=r(43),c=r(12),l=r(13),m=r(78),h=r(107);function f(t){this.contact=t,this.prev,this.next,this.other}function _(t,e,r,n,i){this.m_nodeA=new f(this),this.m_nodeB=new f(this),this.m_fixtureA=t,this.m_fixtureB=r,this.m_indexA=e,this.m_indexB=n,this.m_evaluateFcn=i,this.m_manifold=new m,this.m_prev=null,this.m_next=null,this.m_toi=1,this.m_toiCount=0,this.m_toiFlag=!1,this.m_friction=d(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction),this.m_restitution=y(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution),this.m_tangentSpeed=0,this.m_enabledFlag=!0,this.m_islandFlag=!1,this.m_touchingFlag=!1,this.m_filterFlag=!1,this.m_bulletHitFlag=!1,this.v_points=[],this.v_normal=s.zero(),this.v_normalMass=new u,this.v_K=new u,this.v_pointCount,this.v_tangentSpeed,this.v_friction,this.v_restitution,this.v_invMassA,this.v_invMassB,this.v_invIA,this.v_invIB,this.p_localPoints=[],this.p_localNormal=s.zero(),this.p_localPoint=s.zero(),this.p_localCenterA=s.zero(),this.p_localCenterB=s.zero(),this.p_type,this.p_radiusA,this.p_radiusB,this.p_pointCount,this.p_invMassA,this.p_invMassB,this.p_invIA,this.p_invIB}function p(){this.rA=s.zero(),this.rB=s.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.normalMass=0,this.tangentMass=0,this.velocityBias=0}function d(t,e){return o.sqrt(t*e)}function y(t,e){return t>e?t:e}t.exports=_,_.prototype.initConstraint=function(t){var e=this.m_fixtureA,r=this.m_fixtureB,o=e.getShape(),a=r.getShape(),u=e.getBody(),c=r.getBody(),l=this.getManifold(),m=l.pointCount;n&&i.assert(m>0),this.v_invMassA=u.m_invMass,this.v_invMassB=c.m_invMass,this.v_invIA=u.m_invI,this.v_invIB=c.m_invI,this.v_friction=this.m_friction,this.v_restitution=this.m_restitution,this.v_tangentSpeed=this.m_tangentSpeed,this.v_pointCount=m,this.v_K.setZero(),this.v_normalMass.setZero(),this.p_invMassA=u.m_invMass,this.p_invMassB=c.m_invMass,this.p_invIA=u.m_invI,this.p_invIB=c.m_invI,this.p_localCenterA=s.clone(u.m_sweep.localCenter),this.p_localCenterB=s.clone(c.m_sweep.localCenter),this.p_radiusA=o.m_radius,this.p_radiusB=a.m_radius,this.p_type=l.type,this.p_localNormal=s.clone(l.localNormal),this.p_localPoint=s.clone(l.localPoint),this.p_pointCount=m;for(var h=0;h<m;++h){var f=l.points[h],_=this.v_points[h]=new p;t.warmStarting?(_.normalImpulse=t.dtRatio*f.normalImpulse,_.tangentImpulse=t.dtRatio*f.tangentImpulse):(_.normalImpulse=0,_.tangentImpulse=0),_.rA.setZero(),_.rB.setZero(),_.normalMass=0,_.tangentMass=0,_.velocityBias=0,this.p_localPoints[h]=s.clone(f.localPoint)}},_.prototype.getManifold=function(){return this.m_manifold},_.prototype.getWorldManifold=function(t){var e=this.m_fixtureA.getBody(),r=this.m_fixtureB.getBody(),n=this.m_fixtureA.getShape(),i=this.m_fixtureB.getShape();return this.m_manifold.getWorldManifold(t,e.getTransform(),n.m_radius,r.getTransform(),i.m_radius)},_.prototype.setEnabled=function(t){this.m_enabledFlag=!!t},_.prototype.isEnabled=function(){return this.m_enabledFlag},_.prototype.isTouching=function(){return this.m_touchingFlag},_.prototype.getNext=function(){return this.m_next},_.prototype.getFixtureA=function(){return this.m_fixtureA},_.prototype.getFixtureB=function(){return this.m_fixtureB},_.prototype.getChildIndexA=function(){return this.m_indexA},_.prototype.getChildIndexB=function(){return this.m_indexB},_.prototype.flagForFiltering=function(){this.m_filterFlag=!0},_.prototype.setFriction=function(t){this.m_friction=t},_.prototype.getFriction=function(){return this.m_friction},_.prototype.resetFriction=function(){this.m_friction=d(this.m_fixtureA.m_friction,this.m_fixtureB.m_friction)},_.prototype.setRestitution=function(t){this.m_restitution=t},_.prototype.getRestitution=function(){return this.m_restitution},_.prototype.resetRestitution=function(){this.m_restitution=y(this.m_fixtureA.m_restitution,this.m_fixtureB.m_restitution)},_.prototype.setTangentSpeed=function(t){this.m_tangentSpeed=t},_.prototype.getTangentSpeed=function(){return this.m_tangentSpeed},_.prototype.evaluate=function(t,e,r){this.m_evaluateFcn(t,e,this.m_fixtureA,this.m_indexA,r,this.m_fixtureB,this.m_indexB)},_.prototype.update=function(t){this.m_enabledFlag=!0;var e=!1,r=this.m_touchingFlag,n=this.m_fixtureA.isSensor(),i=this.m_fixtureB.isSensor(),o=n||i,s=this.m_fixtureA.getBody(),a=this.m_fixtureB.getBody(),u=s.getTransform(),c=a.getTransform();if(o){var l=this.m_fixtureA.getShape(),f=this.m_fixtureB.getShape();e=h.testOverlap(l,this.m_indexA,f,this.m_indexB,u,c),this.m_manifold.pointCount=0}else{var _=this.m_manifold;this.m_manifold=new m,this.evaluate(this.m_manifold,u,c),e=this.m_manifold.pointCount>0;for(var p=0;p<this.m_manifold.pointCount;++p){var d=this.m_manifold.points[p];d.normalImpulse=0,d.tangentImpulse=0;for(var y=0;y<_.pointCount;++y){var v=_.points[y];if(v.id.key==d.id.key){d.normalImpulse=v.normalImpulse,d.tangentImpulse=v.tangentImpulse;break}}}e!=r&&(s.setAwake(!0),a.setAwake(!0))}this.m_touchingFlag=e,0==r&&1==e&&t&&t.beginContact(this),1==r&&0==e&&t&&t.endContact(this),0==o&&e&&t&&t.preSolve(this,_)},_.prototype.solvePositionConstraint=function(t){return this._solvePositionConstraint(t,!1)},_.prototype.solvePositionConstraintTOI=function(t,e,r){return this._solvePositionConstraint(t,!0,e,r)},_.prototype._solvePositionConstraint=function(t,e,r,n){var i=this.m_fixtureA,u=this.m_fixtureB,h=i.getBody(),f=u.getBody(),_=(h.c_velocity,f.c_velocity,h.c_position),p=f.c_position,d=s.clone(this.p_localCenterA),y=s.clone(this.p_localCenterB),v=0,b=0;e&&h!=r&&h!=n||(v=this.p_invMassA,b=this.p_invIA);var g=0,x=0;e&&f!=r&&f!=n||(g=this.p_invMassB,x=this.p_invIB);for(var A=s.clone(_.c),w=_.a,B=s.clone(p.c),E=p.a,M=0,S=0;S<this.p_pointCount;++S){var T,I,P,C=a.identity(),R=a.identity();switch(C.q.set(w),R.q.set(E),C.p=s.sub(A,c.mul(C.q,d)),R.p=s.sub(B,c.mul(R.q,y)),this.p_type){case m.e_circles:var F=a.mul(C,this.p_localPoint),D=a.mul(R,this.p_localPoints[0]);(T=s.sub(D,F)).normalize(),I=s.wAdd(.5,F,.5,D),P=s.dot(s.sub(D,F),T)-this.p_radiusA-this.p_radiusB;break;case m.e_faceA:T=c.mul(C.q,this.p_localNormal);var L=a.mul(C,this.p_localPoint),O=a.mul(R,this.p_localPoints[S]);P=s.dot(s.sub(O,L),T)-this.p_radiusA-this.p_radiusB,I=O;break;case m.e_faceB:T=c.mul(R.q,this.p_localNormal);L=a.mul(R,this.p_localPoint),O=a.mul(C,this.p_localPoints[S]);P=s.dot(s.sub(O,L),T)-this.p_radiusA-this.p_radiusB,I=O,T.mul(-1)}var k=s.sub(I,A),U=s.sub(I,B);M=o.min(M,P);var z=e?l.toiBaugarte:l.baumgarte,j=l.linearSlop,V=l.maxLinearCorrection,N=o.clamp(z*(P+j),-V,0),q=s.cross(k,T),G=s.cross(U,T),W=v+g+b*q*q+x*G*G,Y=W>0?-N/W:0,X=s.mul(Y,T);A.wSub(v,X),w-=b*s.cross(k,X),B.wAdd(g,X),E+=x*s.cross(U,X)}return _.c.set(A),_.a=w,p.c.set(B),p.a=E,M},_.prototype.initVelocityConstraint=function(t){var e=this.m_fixtureA,r=this.m_fixtureB,o=e.getBody(),u=r.getBody(),m=o.c_velocity,h=u.c_velocity,f=o.c_position,_=u.c_position,p=this.p_radiusA,d=this.p_radiusB,y=this.getManifold(),v=this.v_invMassA,b=this.v_invMassB,g=this.v_invIA,x=this.v_invIB,A=s.clone(this.p_localCenterA),w=s.clone(this.p_localCenterB),B=s.clone(f.c),E=f.a,M=s.clone(m.v),S=m.w,T=s.clone(_.c),I=_.a,P=s.clone(h.v),C=h.w;n&&i.assert(y.pointCount>0);var R=a.identity(),F=a.identity();R.q.set(E),F.q.set(I),R.p.wSet(1,B,-1,c.mul(R.q,A)),F.p.wSet(1,T,-1,c.mul(F.q,w));var D=y.getWorldManifold(null,R,p,F,d);this.v_normal.set(D.normal);for(var L=0;L<this.v_pointCount;++L){var O=this.v_points[L];O.rA.set(s.sub(D.points[L],B)),O.rB.set(s.sub(D.points[L],T));var k=s.cross(O.rA,this.v_normal),U=s.cross(O.rB,this.v_normal),z=v+b+g*k*k+x*U*U;O.normalMass=z>0?1/z:0;var j=s.cross(this.v_normal,1),V=s.cross(O.rA,j),N=s.cross(O.rB,j),q=v+b+g*V*V+x*N*N;O.tangentMass=q>0?1/q:0,O.velocityBias=0;var G=s.dot(this.v_normal,P)+s.dot(this.v_normal,s.cross(C,O.rB))-s.dot(this.v_normal,M)-s.dot(this.v_normal,s.cross(S,O.rA));G<-l.velocityThreshold&&(O.velocityBias=-this.v_restitution*G)}if(2==this.v_pointCount&&t.blockSolve){var W=this.v_points[0],Y=this.v_points[1],X=s.cross(W.rA,this.v_normal),K=s.cross(W.rB,this.v_normal),H=s.cross(Y.rA,this.v_normal),J=s.cross(Y.rB,this.v_normal),Z=v+b+g*X*X+x*K*K,Q=v+b+g*H*H+x*J*J,$=v+b+g*X*H+x*K*J;Z*Z<1e3*(Z*Q-$*$)?(this.v_K.ex.set(Z,$),this.v_K.ey.set($,Q),this.v_normalMass.set(this.v_K.getInverse())):this.v_pointCount=1}f.c.set(B),f.a=E,m.v.set(M),m.w=S,_.c.set(T),_.a=I,h.v.set(P),h.w=C},_.prototype.warmStartConstraint=function(t){for(var e=this.m_fixtureA,r=this.m_fixtureB,n=e.getBody(),i=r.getBody(),o=n.c_velocity,a=i.c_velocity,u=(n.c_position,i.c_position,this.v_invMassA),c=this.v_invIA,l=this.v_invMassB,m=this.v_invIB,h=s.clone(o.v),f=o.w,_=s.clone(a.v),p=a.w,d=this.v_normal,y=s.cross(d,1),v=0;v<this.v_pointCount;++v){var b=this.v_points[v],g=s.wAdd(b.normalImpulse,d,b.tangentImpulse,y);f-=c*s.cross(b.rA,g),h.wSub(u,g),p+=m*s.cross(b.rB,g),_.wAdd(l,g)}o.v.set(h),o.w=f,a.v.set(_),a.w=p},_.prototype.storeConstraintImpulses=function(t){for(var e=this.m_manifold,r=0;r<this.v_pointCount;++r)e.points[r].normalImpulse=this.v_points[r].normalImpulse,e.points[r].tangentImpulse=this.v_points[r].tangentImpulse},_.prototype.solveVelocityConstraint=function(t){var e=this.m_fixtureA.m_body,r=this.m_fixtureB.m_body,a=e.c_velocity,c=(e.c_position,r.c_velocity),l=(r.c_position,this.v_invMassA),m=this.v_invIA,h=this.v_invMassB,f=this.v_invIB,_=s.clone(a.v),p=a.w,d=s.clone(c.v),y=c.w,v=this.v_normal,b=s.cross(v,1),g=this.v_friction;n&&i.assert(1==this.v_pointCount||2==this.v_pointCount);for(var x=0;x<this.v_pointCount;++x){var A=this.v_points[x];(T=s.zero()).wAdd(1,d,1,s.cross(y,A.rB)),T.wSub(1,_,1,s.cross(p,A.rA));var w=s.dot(T,b)-this.v_tangentSpeed,B=A.tangentMass*-w,E=g*A.normalImpulse;B=(I=o.clamp(A.tangentImpulse+B,-E,E))-A.tangentImpulse,A.tangentImpulse=I;var M=s.mul(B,b);_.wSub(l,M),p-=m*s.cross(A.rA,M),d.wAdd(h,M),y+=f*s.cross(A.rB,M)}if(1==this.v_pointCount||0==t.blockSolve)for(var S=0;S<this.v_pointCount;++S){var T;A=this.v_points[S];(T=s.zero()).wAdd(1,d,1,s.cross(y,A.rB)),T.wSub(1,_,1,s.cross(p,A.rA));var I,P=s.dot(T,v);B=-A.normalMass*(P-A.velocityBias);B=(I=o.max(A.normalImpulse+B,0))-A.normalImpulse,A.normalImpulse=I;M=s.mul(B,v);_.wSub(l,M),p-=m*s.cross(A.rA,M),d.wAdd(h,M),y+=f*s.cross(A.rB,M)}else{var C=this.v_points[0],R=this.v_points[1],F=s.neo(C.normalImpulse,R.normalImpulse);n&&i.assert(F.x>=0&&F.y>=0);var D=s.zero().add(d).add(s.cross(y,C.rB)).sub(_).sub(s.cross(p,C.rA)),L=s.zero().add(d).add(s.cross(y,R.rB)).sub(_).sub(s.cross(p,R.rA)),O=s.dot(D,v),k=s.dot(L,v),U=s.neo(O-C.velocityBias,k-R.velocityBias);U.sub(u.mul(this.v_K,F));for(;;){var z=s.neg(u.mul(this.v_normalMass,U));if(z.x>=0&&z.y>=0){var j=s.sub(z,F),V=s.mul(j.x,v),N=s.mul(j.y,v);_.wSub(l,V,l,N),p-=m*(s.cross(C.rA,V)+s.cross(R.rA,N)),d.wAdd(h,V,h,N),y+=f*(s.cross(C.rB,V)+s.cross(R.rB,N)),C.normalImpulse=z.x,R.normalImpulse=z.y;break}if(z.x=-C.normalMass*U.x,z.y=0,O=0,k=this.v_K.ex.y*z.x+U.y,z.x>=0&&k>=0){j=s.sub(z,F),V=s.mul(j.x,v),N=s.mul(j.y,v);_.wSub(l,V,l,N),p-=m*(s.cross(C.rA,V)+s.cross(R.rA,N)),d.wAdd(h,V,h,N),y+=f*(s.cross(C.rB,V)+s.cross(R.rB,N)),C.normalImpulse=z.x,R.normalImpulse=z.y;break}if(z.x=0,z.y=-R.normalMass*U.y,O=this.v_K.ey.x*z.y+U.x,k=0,z.y>=0&&O>=0){j=s.sub(z,F),V=s.mul(j.x,v),N=s.mul(j.y,v);_.wSub(l,V,l,N),p-=m*(s.cross(C.rA,V)+s.cross(R.rA,N)),d.wAdd(h,V,h,N),y+=f*(s.cross(C.rB,V)+s.cross(R.rB,N)),C.normalImpulse=z.x,R.normalImpulse=z.y;break}if(z.x=0,z.y=0,O=U.x,k=U.y,O>=0&&k>=0){j=s.sub(z,F),V=s.mul(j.x,v),N=s.mul(j.y,v);_.wSub(l,V,l,N),p-=m*(s.cross(C.rA,V)+s.cross(R.rA,N)),d.wAdd(h,V,h,N),y+=f*(s.cross(C.rB,V)+s.cross(R.rB,N)),C.normalImpulse=z.x,R.normalImpulse=z.y;break}break}}a.v.set(_),a.w=p,c.v.set(d),c.w=y};var v=[];_.addType=function(t,e,r){v[t]=v[t]||{},v[t][e]=r},_.create=function(t,e,r,n){var i,o,s=t.getType(),a=r.getType();if(o=v[s]&&v[s][a])i=new _(t,e,r,n,o);else{if(!(o=v[a]&&v[a][s]))return null;i=new _(r,n,t,e,o)}t=i.getFixtureA(),r=i.getFixtureB(),e=i.getChildIndexA(),n=i.getChildIndexB();var u=t.getBody(),c=r.getBody();return i.m_nodeA.contact=i,i.m_nodeA.other=c,i.m_nodeA.prev=null,i.m_nodeA.next=u.m_contactList,null!=u.m_contactList&&(u.m_contactList.prev=i.m_nodeA),u.m_contactList=i.m_nodeA,i.m_nodeB.contact=i,i.m_nodeB.other=u,i.m_nodeB.prev=null,i.m_nodeB.next=c.m_contactList,null!=c.m_contactList&&(c.m_contactList.prev=i.m_nodeB),c.m_contactList=i.m_nodeB,0==t.isSensor()&&0==r.isSensor()&&(u.setAwake(!0),c.setAwake(!0)),i},_.destroy=function(t,e){var r=t.m_fixtureA,n=t.m_fixtureB,i=r.getBody(),o=n.getBody();t.isTouching()&&e.endContact(t),t.m_nodeA.prev&&(t.m_nodeA.prev.next=t.m_nodeA.next),t.m_nodeA.next&&(t.m_nodeA.next.prev=t.m_nodeA.prev),t.m_nodeA==i.m_contactList&&(i.m_contactList=t.m_nodeA.next),t.m_nodeB.prev&&(t.m_nodeB.prev.next=t.m_nodeB.next),t.m_nodeB.next&&(t.m_nodeB.next.prev=t.m_nodeB.prev),t.m_nodeB==o.m_contactList&&(o.m_contactList=t.m_nodeB.next),t.m_manifold.pointCount>0&&0==r.isSensor()&&0==n.isSensor()&&(i.setAwake(!0),o.setAwake(!0));var s=r.getType(),a=n.getType(),u=v[s][a].destroyFcn;"function"==typeof u&&u(t)}},,,,,function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT,r(7);var n=r(3),i=r(14),o=r(4),s=r(12);function a(){this.type,this.localNormal=n.zero(),this.localPoint=n.zero(),this.points=[new u,new u],this.pointCount=0}function u(){this.localPoint=n.zero(),this.normalImpulse=0,this.tangentImpulse=0,this.id=new c}function c(){this.cf=new l;Object.defineProperty(this,"key",{get:function(){return this.cf.indexA+4*this.cf.indexB+16*this.cf.typeA+64*this.cf.typeB},enumerable:!0,configurable:!0})}function l(){this.indexA,this.indexB,this.typeA,this.typeB}t.exports=a,t.exports.clipSegmentToLine=function(t,e,r,i,o){var s=0,u=n.dot(r,e[0].v)-i,c=n.dot(r,e[1].v)-i;u<=0&&t[s++].set(e[0]);c<=0&&t[s++].set(e[1]);if(u*c<0){var l=u/(u-c);t[s].v.wSet(1-l,e[0].v,l,e[1].v),t[s].id.cf.indexA=o,t[s].id.cf.indexB=e[0].id.cf.indexB,t[s].id.cf.typeA=a.e_vertex,t[s].id.cf.typeB=a.e_face,++s}return s},t.exports.clipVertex=h,t.exports.getPointStates=function(t,e,r,n){for(var i=0;i<r.pointCount;++i){var o=r.points[i].id;t[i]=m.removeState;for(var s=0;s<n.pointCount;++s)if(n.points[s].id.key==o.key){t[i]=m.persistState;break}}for(var i=0;i<n.pointCount;++i){var o=n.points[i].id;e[i]=m.addState;for(var s=0;s<r.pointCount;++s)if(r.points[s].id.key==o.key){e[i]=m.persistState;break}}},t.exports.PointState=m,a.e_circles=0,a.e_faceA=1,a.e_faceB=2,a.e_vertex=0,a.e_face=1,c.prototype.set=function(t){this.cf.set(t.cf)},l.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.typeA=t.typeA,this.typeB=t.typeB},a.prototype.getWorldManifold=function(t,e,r,u,c){if(0!=this.pointCount){var l=(t=t||new function(){this.normal,this.points=[],this.separations=[]}).normal,m=t.points,h=t.separations;switch(this.type){case a.e_circles:l=n.neo(1,0);var f=i.mul(e,this.localPoint),_=i.mul(u,this.points[0].localPoint),p=n.sub(_,f);n.lengthSquared(p)>o.EPSILON*o.EPSILON&&(l.set(p),l.normalize()),m[0]=n.mid(f,_),h[0]=-c-r,m.length=1,h.length=1;break;case a.e_faceA:l=s.mul(e.q,this.localNormal);for(var d=i.mul(e,this.localPoint),y=0;y<this.pointCount;++y){var v=i.mul(u,this.points[y].localPoint),b=n.clone(v).wAdd(r-n.dot(n.sub(v,d),l),l),g=n.clone(v).wSub(c,l);m[y]=n.mid(b,g),h[y]=n.dot(n.sub(g,b),l)}m.length=this.pointCount,h.length=this.pointCount;break;case a.e_faceB:l=s.mul(u.q,this.localNormal);for(d=i.mul(u,this.localPoint),y=0;y<this.pointCount;++y){v=i.mul(e,this.points[y].localPoint),g=n.zero().wSet(1,v,c-n.dot(n.sub(v,d),l),l),b=n.zero().wSet(1,v,-r,l);m[y]=n.mid(b,g),h[y]=n.dot(n.sub(b,g),l)}m.length=this.pointCount,h.length=this.pointCount,l.mul(-1)}return t.normal=l,t.points=m,t.separations=h,t}};var m={nullState:0,addState:1,persistState:2,removeState:3};function h(){this.v=n.zero(),this.id=new c}h.prototype.set=function(t){this.v.set(t.v),this.id.set(t.id)}},,,,,,,,,,,,,,,,,,,,,function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=h;var i=r(7),o=r(22),s=(r(28),r(4)),a=r(14),u=r(12),c=r(3),l=(r(62),r(13)),m=r(56);function h(t){if(!(this instanceof h))return new h(t);h._super.call(this),this.m_type=h.TYPE,this.m_radius=l.polygonRadius,this.m_centroid=c.zero(),this.m_vertices=[],this.m_normals=[],this.m_count=0,t&&t.length&&this._set(t)}h._super=m,h.prototype=o(h._super.prototype),h.TYPE="polygon",h.prototype.getVertex=function(t){return n&&i.assert(0<=t&&t<this.m_count),this.m_vertices[t]},h.prototype._clone=function(){var t=new h;t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_count=this.m_count,t.m_centroid.set(this.m_centroid);for(var e=0;e<this.m_count;e++)t.m_vertices.push(this.m_vertices[e].clone());for(e=0;e<this.m_normals.length;e++)t.m_normals.push(this.m_normals[e].clone());return t},h.prototype.getChildCount=function(){return 1},h.prototype._set=function(t){if(n&&i.assert(3<=t.length&&t.length<=l.maxPolygonVertices),t.length<3)this._setAsBox(1,1);else{for(var e=s.min(t.length,l.maxPolygonVertices),r=[],o=0,a=0;a<e;++a){for(var u=t[a],m=!0,h=0;h<o;++h)if(c.distanceSquared(u,r[h])<.25*l.linearSlopSquared){m=!1;break}m&&(r[o++]=u)}if((e=o)<3)return n&&i.assert(!1),void this._setAsBox(1,1);var f=0,_=r[0].x;for(a=1;a<e;++a){var p=r[a].x;(p>_||p==_&&r[a].y<r[f].y)&&(f=a,_=p)}for(var d=[],y=0,v=f;;){d[y]=v;var b=0;for(h=1;h<e;++h)if(b!=v){var g=c.sub(r[b],r[d[y]]),x=(u=c.sub(r[h],r[d[y]]),c.cross(g,u));x<0&&(b=h),0==x&&u.lengthSquared()>g.lengthSquared()&&(b=h)}else b=h;if(++y,v=b,b==f)break}if(y<3)return n&&i.assert(!1),void this._setAsBox(1,1);this.m_count=y;for(a=0;a<y;++a)this.m_vertices[a]=r[d[a]];for(a=0;a<y;++a){var A=a,w=a+1<y?a+1:0,B=c.sub(this.m_vertices[w],this.m_vertices[A]);n&&i.assert(B.lengthSquared()>s.EPSILON*s.EPSILON),this.m_normals[a]=c.cross(B,1),this.m_normals[a].normalize()}this.m_centroid=function(t,e){n&&i.assert(e>=3);for(var r=c.zero(),o=0,a=c.zero(),u=0;u<e;++u){var l=a,m=t[u],h=u+1<e?t[u+1]:t[0],f=c.sub(m,l),_=c.sub(h,l),p=.5*c.cross(f,_);o+=p,r.wAdd(p*(1/3),l),r.wAdd(p*(1/3),m),r.wAdd(p*(1/3),h)}return n&&i.assert(o>s.EPSILON),r.mul(1/o),r}(this.m_vertices,y)}},h.prototype._setAsBox=function(t,e,r,n){if(this.m_vertices[0]=c.neo(-t,-e),this.m_vertices[1]=c.neo(t,-e),this.m_vertices[2]=c.neo(t,e),this.m_vertices[3]=c.neo(-t,e),this.m_normals[0]=c.neo(0,-1),this.m_normals[1]=c.neo(1,0),this.m_normals[2]=c.neo(0,1),this.m_normals[3]=c.neo(-1,0),this.m_count=4,c.isValid(r)){n=n||0,this.m_centroid.set(r);var i=a.identity();i.p.set(r),i.q.set(n);for(var o=0;o<this.m_count;++o)this.m_vertices[o]=a.mul(i,this.m_vertices[o]),this.m_normals[o]=u.mul(i.q,this.m_normals[o])}},h.prototype.testPoint=function(t,e){for(var r=u.mulT(t.q,c.sub(e,t.p)),n=0;n<this.m_count;++n){if(c.dot(this.m_normals[n],c.sub(r,this.m_vertices[n]))>0)return!1}return!0},h.prototype.rayCast=function(t,e,r,o){for(var s=u.mulT(r.q,c.sub(e.p1,r.p)),a=u.mulT(r.q,c.sub(e.p2,r.p)),l=c.sub(a,s),m=0,h=e.maxFraction,f=-1,_=0;_<this.m_count;++_){var p=c.dot(this.m_normals[_],c.sub(this.m_vertices[_],s)),d=c.dot(this.m_normals[_],l);if(0==d){if(p<0)return!1}else d<0&&p<m*d?(m=p/d,f=_):d>0&&p<h*d&&(h=p/d);if(h<m)return!1}return n&&i.assert(0<=m&&m<=e.maxFraction),f>=0&&(t.fraction=m,t.normal=u.mul(r.q,this.m_normals[f]),!0)},h.prototype.computeAABB=function(t,e,r){for(var n=1/0,i=1/0,o=-1/0,u=-1/0,c=0;c<this.m_count;++c){var l=a.mul(e,this.m_vertices[c]);n=s.min(n,l.x),o=s.max(o,l.x),i=s.min(i,l.y),u=s.max(u,l.y)}t.lowerBound.set(n,i),t.upperBound.set(o,u),t.extend(this.m_radius)},h.prototype.computeMass=function(t,e){n&&i.assert(this.m_count>=3);for(var r=c.zero(),o=0,a=0,u=c.zero(),l=0;l<this.m_count;++l)u.add(this.m_vertices[l]);u.mul(1/this.m_count);for(l=0;l<this.m_count;++l){var m=c.sub(this.m_vertices[l],u),h=l+1<this.m_count?c.sub(this.m_vertices[l+1],u):c.sub(this.m_vertices[0],u),f=c.cross(m,h),_=.5*f;o+=_,r.wAdd(_*(1/3),m,_*(1/3),h);var p=m.x,d=m.y,y=h.x,v=h.y;a+=1/3*.25*f*(p*p+y*p+y*y+(d*d+v*d+v*v))}t.mass=e*o,n&&i.assert(o>s.EPSILON),r.mul(1/o),t.center.wSet(1,r,1,u),t.I=e*a,t.I+=t.mass*(c.dot(t.center,t.center)-c.dot(r,r))},h.prototype.validate=function(){for(var t=0;t<this.m_count;++t)for(var e=t,r=t<this.m_count-1?e+1:0,n=this.m_vertices[e],i=c.sub(this.m_vertices[r],n),o=0;o<this.m_count;++o)if(o!=e&&o!=r){var s=c.sub(this.m_vertices[o],n);if(c.cross(i,s)<0)return!1}return!0},h.prototype.computeDistanceProxy=function(t){t.m_vertices=this.m_vertices,t.m_count=this.m_count,t.m_radius=this.m_radius}},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.Keyboard=e.MouseDrawing=e.CameraBodyTracker=e.CameraPan=void 0;var n=r(2);function i(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function s(t,e,r){return e&&o(t.prototype,e),r&&o(t,r),t}var a=["vertexadded","lineadded","drawingstart","drawingend"],u=function(){function t(e){var r=this;i(this,t),this.game=e.game,this.connected=e.connected||!0,this.endKeys=e.endKeys||["Shift"],this.endKeys.length||(this.endKeys=[this.endKeys]),this.listeners=a.reduce(function(t,e){return t[e]=[],t},{}),e.listeners&&Object.keys(e.listeners).forEach(function(t){return r.addListener(t,e.listeners[t])}),this._lineData=new Float32Array(4096),this.currentLineIdx=0,this.available=0,this.isDrawing=!1,this.game.canvas.addEventListener("mousemove",function(t){r.update(r.convertMouseCoordinates({x:t.offsetX,y:t.offsetY}))}),this.game.canvas.addEventListener("mousedown",function(t){r.isDrawing?r.endLine(r.convertMouseCoordinates({x:t.offsetX,y:t.offsetY})):r.startLine(r.convertMouseCoordinates({x:t.offsetX,y:t.offsetY}))}),window.addEventListener("keydown",function(t){r.endKeys.includes(t.key)&&r.isDrawing&&r.endDrawing(t)})}return s(t,[{key:"addListener",value:function(t,e){this.listeners[t]||(this.listeners[t]=[]),this.listeners[t].push(e)}},{key:"notifyListeners",value:function(t){for(var e=arguments.length,r=new Array(e>1?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];this.listeners[t].forEach(function(t){return t.apply(void 0,r)})}},{key:"convertMouseCoordinates",value:function(t){var e=n.vec4.fromValues(t.x,t.y,0,1);return n.vec4.transformMat4(e,e,this.game.canvasToWorld),{x:e[0],y:e[1]}}},{key:"inBounds",value:function(t){return!0}},{key:"startLine",value:function(t){this.inBounds(t)&&!this.isDrawing&&(this.isDrawing=!0,this.available++,this._lineData[this.lineIndex+0]=t.x,this._lineData[this.lineIndex+1]=t.y,this.update(t),this.notifyListeners("drawingstart",{}),this.notifyListeners("vertexadded",this.currentLineStart))}},{key:"endLine",value:function(t){this.isDrawing&&(this._lineData[this.lineIndex+2]=t.x,this._lineData[this.lineIndex+3]=t.y,this.notifyListeners("lineadded",this.currentLine),this.notifyListeners("vertexadded",this.currentLineEnd),this.currentLineIdx++,this.connected?(this.available++,this._lineData[this.lineIndex+0]=t.x,this._lineData[this.lineIndex+1]=t.y,this.update(t)):this.isDrawing=!1)}},{key:"endDrawing",value:function(t){this.isDrawing=!1,this.notifyListeners("drawingend",t)}},{key:"update",value:function(t){this.isDrawing&&(this._lineData[this.lineIndex+2]=t.x,this._lineData[this.lineIndex+3]=t.y)}},{key:"clear",value:function(){this.available=0,this.currentLineIdx=0,this._lineData.fill(0)}},{key:"lineIndex",get:function(){return 4*this.currentLineIdx}},{key:"lineData",get:function(){return this._lineData.slice(0,4*this.available)}},{key:"currentLine",get:function(){return{start:this.currentLineStart,end:this.currentLineEnd}}},{key:"currentLineStart",get:function(){return{x:this._lineData[this.lineIndex],y:this._lineData[this.lineIndex+1]}}},{key:"currentLineEnd",get:function(){return{x:this._lineData[this.lineIndex+2],y:this._lineData[this.lineIndex+3]}}}]),t}();e.MouseDrawing=u;var c=function(){function t(e){i(this,t),this.keys=new Map,document.addEventListener("keydown",this.keydown.bind(this)),document.addEventListener("keyup",this.keyup.bind(this))}return s(t,[{key:"keydown",value:function(t){this.keys.set(t.key,!0),t.key.startsWith("Arrow")&&t.preventDefault()}},{key:"keyup",value:function(t){this.keys.delete(t.key)}},{key:"isdown",value:function(t){return this.keys.get(t)}}]),t}();e.Keyboard=c;e.CameraPan=function t(e){var r=this;i(this,t),this.pandir=[0,0],this.speed=200,this.keyboard=new c;var n=null;this.loopId=requestAnimationFrame(function t(i){n||(n=i);var o=(i-n)/1e3;n=i,r.pandir=[r.keyboard.isdown("ArrowLeft")?-1:r.keyboard.isdown("ArrowRight")?1:0,r.keyboard.isdown("ArrowDown")?-1:r.keyboard.isdown("ArrowUp")?1:0],r.keyboard.isdown("+")?r.speed+=10:r.keyboard.isdown("-")&&(r.speed-=10,r.speed=Math.max(200,r.speed)),0===r.pandir[0]&&0===r.pandir[1]||e.camera.translate(r.speed*o*r.pandir[0],r.speed*o*r.pandir[1]),r.loopId=requestAnimationFrame(t)})};var l=function(){function t(e,r){i(this,t),this.body=r,this.game=e,this.loopId=null}return s(t,[{key:"start",value:function(){this.loopId||(this.loopId=requestAnimationFrame(this.loop.bind(this)))}},{key:"stop",value:function(){cancelAnimationFrame(this.loopId),this.loopId=null}},{key:"loop",value:function(){this.body&&this.game.camera.centerAt(this.body.position.x,this.body.position.y),this.loopId=requestAnimationFrame(this.loop.bind(this))}}]),t}();e.CameraBodyTracker=l},,,,,function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports=c;var n=r(22),i=(r(28),r(13)),o=r(56),s=(r(4),r(14)),a=r(12),u=r(3);r(62);function c(t,e){if(!(this instanceof c))return new c(t,e);c._super.call(this),this.m_type=c.TYPE,this.m_radius=i.polygonRadius,this.m_vertex1=t?u.clone(t):u.zero(),this.m_vertex2=e?u.clone(e):u.zero(),this.m_vertex0=u.zero(),this.m_vertex3=u.zero(),this.m_hasVertex0=!1,this.m_hasVertex3=!1}c._super=o,c.prototype=n(c._super.prototype),c.TYPE="edge",c.prototype.setNext=function(t){return t?(this.m_vertex3.set(t),this.m_hasVertex3=!0):(this.m_vertex3.setZero(),this.m_hasVertex3=!1),this},c.prototype.setPrev=function(t){return t?(this.m_vertex0.set(t),this.m_hasVertex0=!0):(this.m_vertex0.setZero(),this.m_hasVertex0=!1),this},c.prototype._set=function(t,e){return this.m_vertex1.set(t),this.m_vertex2.set(e),this.m_hasVertex0=!1,this.m_hasVertex3=!1,this},c.prototype._clone=function(){var t=new c;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_vertex1.set(this.m_vertex1),t.m_vertex2.set(this.m_vertex2),t.m_vertex0.set(this.m_vertex0),t.m_vertex3.set(this.m_vertex3),t.m_hasVertex0=this.m_hasVertex0,t.m_hasVertex3=this.m_hasVertex3,t},c.prototype.getChildCount=function(){return 1},c.prototype.testPoint=function(t,e){return!1},c.prototype.rayCast=function(t,e,r,n){var i=a.mulT(r.q,u.sub(e.p1,r.p)),o=a.mulT(r.q,u.sub(e.p2,r.p)),s=u.sub(o,i),c=this.m_vertex1,l=this.m_vertex2,m=u.sub(l,c),h=u.neo(m.y,-m.x);h.normalize();var f=u.dot(h,u.sub(c,i)),_=u.dot(h,s);if(0==_)return!1;var p=f/_;if(p<0||e.maxFraction<p)return!1;var d=u.add(i,u.mul(p,s)),y=u.sub(l,c),v=u.dot(y,y);if(0==v)return!1;var b=u.dot(u.sub(d,c),y)/v;return!(b<0||1<b)&&(t.fraction=p,t.normal=f>0?a.mul(r.q,h).neg():a.mul(r.q,h),!0)},c.prototype.computeAABB=function(t,e,r){var n=s.mul(e,this.m_vertex1),i=s.mul(e,this.m_vertex2);t.combinePoints(n,i),t.extend(this.m_radius)},c.prototype.computeMass=function(t,e){t.mass=0,t.center.wSet(.5,this.m_vertex1,.5,this.m_vertex2),t.I=0},c.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_vertex1),t.m_vertices.push(this.m_vertex2),t.m_count=2,t.m_radius=this.m_radius}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=l;var i=r(7),o=r(22),s=(r(28),r(4)),a=(r(14),r(12)),u=r(3),c=(r(62),r(13),r(56));function l(t,e){if(!(this instanceof l))return new l(t,e);l._super.call(this),this.m_type=l.TYPE,this.m_p=u.zero(),this.m_radius=1,"object"==typeof t&&u.isValid(t)?(this.m_p.set(t),"number"==typeof e&&(this.m_radius=e)):"number"==typeof t&&(this.m_radius=t)}l._super=c,l.prototype=o(l._super.prototype),l.TYPE="circle",l.prototype.getRadius=function(){return this.m_radius},l.prototype.getCenter=function(){return this.m_p},l.prototype.getSupportVertex=function(t){return this.m_p},l.prototype.getVertex=function(t){return n&&i.assert(0==t),this.m_p},l.prototype.getVertexCount=function(t){return 1},l.prototype._clone=function(){var t=new l;return t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_p=this.m_p.clone(),t},l.prototype.getChildCount=function(){return 1},l.prototype.testPoint=function(t,e){var r=u.add(t.p,a.mul(t.q,this.m_p)),n=u.sub(e,r);return u.dot(n,n)<=this.m_radius*this.m_radius},l.prototype.rayCast=function(t,e,r,n){var i=u.add(r.p,a.mul(r.q,this.m_p)),o=u.sub(e.p1,i),c=u.dot(o,o)-this.m_radius*this.m_radius,l=u.sub(e.p2,e.p1),m=u.dot(o,l),h=u.dot(l,l),f=m*m-h*c;if(f<0||h<s.EPSILON)return!1;var _=-(m+s.sqrt(f));return 0<=_&&_<=e.maxFraction*h&&(_/=h,t.fraction=_,t.normal=u.add(o,u.mul(_,l)),t.normal.normalize(),!0)},l.prototype.computeAABB=function(t,e,r){var n=u.add(e.p,a.mul(e.q,this.m_p));t.lowerBound.set(n.x-this.m_radius,n.y-this.m_radius),t.upperBound.set(n.x+this.m_radius,n.y+this.m_radius)},l.prototype.computeMass=function(t,e){t.mass=e*s.PI*this.m_radius*this.m_radius,t.center=this.m_p,t.I=t.mass*(.5*this.m_radius*this.m_radius+u.dot(this.m_p,this.m_p))},l.prototype.computeDistanceProxy=function(t){t.m_vertices.push(this.m_p),t.m_count=1,t.m_radius=this.m_radius}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=_,t.exports.Input=m,t.exports.Output=h,t.exports.Proxy=p,t.exports.Cache=f;var i=r(13),o=r(7),s=r(134),a=r(4),u=r(3),c=(r(42),r(43),r(47),r(12)),l=(r(40),r(14));r(45),r(44);function m(){this.proxyA=new p,this.proxyB=new p,this.transformA=null,this.transformB=null,this.useRadii=!1}function h(){this.pointA=u.zero(),this.pointB=u.zero(),this.distance,this.iterations}function f(){this.metric=0,this.indexA=[],this.indexB=[],this.count=0}function _(t,e,r){++s.gjkCalls;var n=r.proxyA,o=r.proxyB,m=r.transformA,h=r.transformB,f=new y;f.readCache(e,n,m,o,h);for(var _=f.m_v,p=i.maxDistnceIterations,d=[],v=[],b=0,g=0;g<p;){b=f.m_count;for(var x=0;x<b;++x)d[x]=_[x].indexA,v[x]=_[x].indexB;if(f.solve(),3==f.m_count)break;(T=f.getClosestPoint()).lengthSquared();var A=f.getSearchDirection();if(A.lengthSquared()<a.EPSILON*a.EPSILON)break;var w=_[f.m_count];w.indexA=n.getSupport(c.mulT(m.q,u.neg(A))),w.wA=l.mul(m,n.getVertex(w.indexA)),w.indexB=o.getSupport(c.mulT(h.q,A)),w.wB=l.mul(h,o.getVertex(w.indexB)),w.w=u.sub(w.wB,w.wA),++g,++s.gjkIters;var B=!1;for(x=0;x<b;++x)if(w.indexA==d[x]&&w.indexB==v[x]){B=!0;break}if(B)break;++f.m_count}if(s.gjkMaxIters=a.max(s.gjkMaxIters,g),f.getWitnessPoints(t.pointA,t.pointB),t.distance=u.distance(t.pointA,t.pointB),t.iterations=g,f.writeCache(e),r.useRadii){var E=n.m_radius,M=o.m_radius;if(t.distance>E+M&&t.distance>a.EPSILON){t.distance-=E+M;var S=u.sub(t.pointB,t.pointA);S.normalize(),t.pointA.wAdd(E,S),t.pointB.wSub(M,S)}else{var T=u.mid(t.pointA,t.pointB);t.pointA.set(T),t.pointB.set(T),t.distance=0}}}function p(){this.m_buffer=[],this.m_vertices=[],this.m_count=0,this.m_radius=0}function d(){this.indexA,this.indexB,this.wA=u.zero(),this.wB=u.zero(),this.w=u.zero(),this.a}function y(){this.m_v1=new d,this.m_v2=new d,this.m_v3=new d,this.m_v=[this.m_v1,this.m_v2,this.m_v3],this.m_count}s.gjkCalls=0,s.gjkIters=0,s.gjkMaxIters=0,p.prototype.getVertexCount=function(){return this.m_count},p.prototype.getVertex=function(t){return n&&o.assert(0<=t&&t<this.m_count),this.m_vertices[t]},p.prototype.getSupport=function(t){for(var e=0,r=u.dot(this.m_vertices[0],t),n=0;n<this.m_count;++n){var i=u.dot(this.m_vertices[n],t);i>r&&(e=n,r=i)}return e},p.prototype.getSupportVertex=function(t){return this.m_vertices[this.getSupport(t)]},p.prototype.set=function(t,e){n&&o.assert("function"==typeof t.computeDistanceProxy),t.computeDistanceProxy(this,e)},d.prototype.set=function(t){this.indexA=t.indexA,this.indexB=t.indexB,this.wA=u.clone(t.wA),this.wB=u.clone(t.wB),this.w=u.clone(t.w),this.a=t.a},y.prototype.print=function(){return 3==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y,this.m_v3.a,this.m_v3.wA.x,this.m_v3.wA.y,this.m_v3.wB.x,this.m_v3.wB.y].toString():2==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y,this.m_v2.a,this.m_v2.wA.x,this.m_v2.wA.y,this.m_v2.wB.x,this.m_v2.wB.y].toString():1==this.m_count?["+"+this.m_count,this.m_v1.a,this.m_v1.wA.x,this.m_v1.wA.y,this.m_v1.wB.x,this.m_v1.wB.y].toString():"+"+this.m_count},y.prototype.readCache=function(t,e,r,i,s){n&&o.assert(t.count<=3),this.m_count=t.count;for(var c=0;c<this.m_count;++c){(p=this.m_v[c]).indexA=t.indexA[c],p.indexB=t.indexB[c];var m=e.getVertex(p.indexA),h=i.getVertex(p.indexB);p.wA=l.mul(r,m),p.wB=l.mul(s,h),p.w=u.sub(p.wB,p.wA),p.a=0}if(this.m_count>1){var f=t.metric,_=this.getMetric();(_<.5*f||2*f<_||_<a.EPSILON)&&(this.m_count=0)}if(0==this.m_count){var p;(p=this.m_v[0]).indexA=0,p.indexB=0;m=e.getVertex(0),h=i.getVertex(0);p.wA=l.mul(r,m),p.wB=l.mul(s,h),p.w=u.sub(p.wB,p.wA),p.a=1,this.m_count=1}},y.prototype.writeCache=function(t){t.metric=this.getMetric(),t.count=this.m_count;for(var e=0;e<this.m_count;++e)t.indexA[e]=this.m_v[e].indexA,t.indexB[e]=this.m_v[e].indexB},y.prototype.getSearchDirection=function(){switch(this.m_count){case 1:return u.neg(this.m_v1.w);case 2:var t=u.sub(this.m_v2.w,this.m_v1.w);return u.cross(t,u.neg(this.m_v1.w))>0?u.cross(1,t):u.cross(t,1);default:return n&&o.assert(!1),u.zero()}},y.prototype.getClosestPoint=function(){switch(this.m_count){case 0:return n&&o.assert(!1),u.zero();case 1:return u.clone(this.m_v1.w);case 2:return u.wAdd(this.m_v1.a,this.m_v1.w,this.m_v2.a,this.m_v2.w);case 3:return u.zero();default:return n&&o.assert(!1),u.zero()}},y.prototype.getWitnessPoints=function(t,e){switch(this.m_count){case 0:n&&o.assert(!1);break;case 1:t.set(this.m_v1.wA),e.set(this.m_v1.wB);break;case 2:t.wSet(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),e.wSet(this.m_v1.a,this.m_v1.wB,this.m_v2.a,this.m_v2.wB);break;case 3:t.wSet(this.m_v1.a,this.m_v1.wA,this.m_v2.a,this.m_v2.wA),t.wAdd(this.m_v3.a,this.m_v3.wA),e.set(t);break;default:n&&o.assert(!1)}},y.prototype.getMetric=function(){switch(this.m_count){case 0:return n&&o.assert(!1),0;case 1:return 0;case 2:return u.distance(this.m_v1.w,this.m_v2.w);case 3:return u.cross(u.sub(this.m_v2.w,this.m_v1.w),u.sub(this.m_v3.w,this.m_v1.w));default:return n&&o.assert(!1),0}},y.prototype.solve=function(){switch(this.m_count){case 1:break;case 2:this.solve2();break;case 3:this.solve3();break;default:n&&o.assert(!1)}},y.prototype.solve2=function(){var t=this.m_v1.w,e=this.m_v2.w,r=u.sub(e,t),n=-u.dot(t,r);if(n<=0)return this.m_v1.a=1,void(this.m_count=1);var i=u.dot(e,r);if(i<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);var o=1/(i+n);this.m_v1.a=i*o,this.m_v2.a=n*o,this.m_count=2},y.prototype.solve3=function(){var t=this.m_v1.w,e=this.m_v2.w,r=this.m_v3.w,n=u.sub(e,t),i=u.dot(t,n),o=u.dot(e,n),s=-i,a=u.sub(r,t),c=u.dot(t,a),l=u.dot(r,a),m=-c,h=u.sub(r,e),f=u.dot(e,h),_=u.dot(r,h),p=-f,d=u.cross(n,a),y=d*u.cross(e,r),v=d*u.cross(r,t),b=d*u.cross(t,e);if(s<=0&&m<=0)return this.m_v1.a=1,void(this.m_count=1);if(o>0&&s>0&&b<=0){var g=1/(o+s);return this.m_v1.a=o*g,this.m_v2.a=s*g,void(this.m_count=2)}if(l>0&&m>0&&v<=0){var x=1/(l+m);return this.m_v1.a=l*x,this.m_v3.a=m*x,this.m_count=2,void this.m_v2.set(this.m_v3)}if(o<=0&&p<=0)return this.m_v2.a=1,this.m_count=1,void this.m_v1.set(this.m_v2);if(l<=0&&_<=0)return this.m_v3.a=1,this.m_count=1,void this.m_v1.set(this.m_v3);if(_>0&&p>0&&y<=0){var A=1/(_+p);return this.m_v2.a=_*A,this.m_v3.a=p*A,this.m_count=2,void this.m_v1.set(this.m_v3)}var w=1/(y+v+b);this.m_v1.a=y*w,this.m_v2.a=v*w,this.m_v3.a=b*w,this.m_count=3},_.testOverlap=function(t,e,r,n,i,o){var s=new m;s.proxyA.set(t,e),s.proxyB.set(r,n),s.transformA=i,s.transformB=o,s.useRadii=!0;var u=new f,c=new h;return _(c,u,s),c.distance<10*a.EPSILON}},,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=m;var i=r(7),o=r(22),s=(r(28),r(4),r(14)),a=(r(12),r(3)),u=(r(62),r(13)),c=r(56),l=r(105);function m(t,e){if(!(this instanceof m))return new m(t,e);m._super.call(this),this.m_type=m.TYPE,this.m_radius=u.polygonRadius,this.m_vertices=[],this.m_count=0,this.m_prevVertex=null,this.m_nextVertex=null,this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,t&&t.length&&(e?this._createLoop(t):this._createChain(t))}m._super=c,m.prototype=o(m._super.prototype),m.TYPE="chain",m.prototype._createLoop=function(t){n&&i.assert(0==this.m_vertices.length&&0==this.m_count),n&&i.assert(t.length>=3);for(var e=1;e<t.length;++e){var r=t[e-1],o=t[e];n&&i.assert(a.distanceSquared(r,o)>u.linearSlopSquared)}this.m_vertices.length=0,this.m_count=t.length+1;for(e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_vertices[t.length]=t[0].clone(),this.m_prevVertex=this.m_vertices[this.m_count-2],this.m_nextVertex=this.m_vertices[1],this.m_hasPrevVertex=!0,this.m_hasNextVertex=!0,this},m.prototype._createChain=function(t){n&&i.assert(0==this.m_vertices.length&&0==this.m_count),n&&i.assert(t.length>=2);for(var e=1;e<t.length;++e){var r=t[e-1],o=t[e];n&&i.assert(a.distanceSquared(r,o)>u.linearSlopSquared)}this.m_count=t.length;for(e=0;e<t.length;++e)this.m_vertices[e]=t[e].clone();return this.m_hasPrevVertex=!1,this.m_hasNextVertex=!1,this.m_prevVertex=null,this.m_nextVertex=null,this},m.prototype._setPrevVertex=function(t){this.m_prevVertex=t,this.m_hasPrevVertex=!0},m.prototype._setNextVertex=function(t){this.m_nextVertex=t,this.m_hasNextVertex=!0},m.prototype._clone=function(){var t=new m;return t.createChain(this.m_vertices),t.m_type=this.m_type,t.m_radius=this.m_radius,t.m_prevVertex=this.m_prevVertex,t.m_nextVertex=this.m_nextVertex,t.m_hasPrevVertex=this.m_hasPrevVertex,t.m_hasNextVertex=this.m_hasNextVertex,t},m.prototype.getChildCount=function(){return this.m_count-1},m.prototype.getChildEdge=function(t,e){n&&i.assert(0<=e&&e<this.m_count-1),t.m_type=l.TYPE,t.m_radius=this.m_radius,t.m_vertex1=this.m_vertices[e],t.m_vertex2=this.m_vertices[e+1],e>0?(t.m_vertex0=this.m_vertices[e-1],t.m_hasVertex0=!0):(t.m_vertex0=this.m_prevVertex,t.m_hasVertex0=this.m_hasPrevVertex),e<this.m_count-2?(t.m_vertex3=this.m_vertices[e+2],t.m_hasVertex3=!0):(t.m_vertex3=this.m_nextVertex,t.m_hasVertex3=this.m_hasNextVertex)},m.prototype.getVertex=function(t){return n&&i.assert(0<=t&&t<=this.m_count),t<this.m_count?this.m_vertices[t]:this.m_vertices[0]},m.prototype.testPoint=function(t,e){return!1},m.prototype.rayCast=function(t,e,r,o){return n&&i.assert(0<=o&&o<this.m_count),new l(this.getVertex(o),this.getVertex(o+1)).rayCast(t,e,r,0)},m.prototype.computeAABB=function(t,e,r){n&&i.assert(0<=r&&r<this.m_count);var o=s.mul(e,this.getVertex(r)),a=s.mul(e,this.getVertex(r+1));t.combinePoints(o,a)},m.prototype.computeMass=function(t,e){t.mass=0,t.center=a.neo(),t.I=0},m.prototype.computeDistanceProxy=function(t,e){n&&i.assert(0<=e&&e<this.m_count),t.m_buffer[0]=this.getVertex(e),t.m_buffer[1]=this.getVertex(e+1),t.m_vertices=t.m_buffer,t.m_count=2,t.m_radius=this.m_radius}},function(t,e){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;e.toString=function(t){t="string"==typeof t?t:"\n";var e="";for(var r in this)"function"!=typeof this[r]&&"object"!=typeof this[r]&&(e+=r+": "+this[r]+t);return e}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=v;var i=r(7),o=r(28),s=r(3),a=r(12),u=r(4),c=r(40),l=r(14),m=r(45),h=r(44),f=r(180),_=(r(56),r(179),v.STATIC="static"),p=v.KINEMATIC="kinematic",d=v.DYNAMIC="dynamic",y={type:_,position:s.zero(),angle:0,linearVelocity:s.zero(),angularVelocity:0,linearDamping:0,angularDamping:0,fixedRotation:!1,bullet:!1,gravityScale:1,allowSleep:!0,awake:!0,active:!0,userData:null};function v(t,e){e=o(e,y),n&&i.assert(s.isValid(e.position)),n&&i.assert(s.isValid(e.linearVelocity)),n&&i.assert(u.isFinite(e.angle)),n&&i.assert(u.isFinite(e.angularVelocity)),n&&i.assert(u.isFinite(e.angularDamping)&&e.angularDamping>=0),n&&i.assert(u.isFinite(e.linearDamping)&&e.linearDamping>=0),this.m_world=t,this.m_awakeFlag=e.awake,this.m_autoSleepFlag=e.allowSleep,this.m_bulletFlag=e.bullet,this.m_fixedRotationFlag=e.fixedRotation,this.m_activeFlag=e.active,this.m_islandFlag=!1,this.m_toiFlag=!1,this.m_userData=e.userData,this.m_type=e.type,this.m_type==d?(this.m_mass=1,this.m_invMass=1):(this.m_mass=0,this.m_invMass=0),this.m_I=0,this.m_invI=0,this.m_xf=l.identity(),this.m_xf.p=s.clone(e.position),this.m_xf.q.setAngle(e.angle),this.m_sweep=new c,this.m_sweep.setTransform(this.m_xf),this.c_velocity=new m,this.c_position=new h,this.m_force=s.zero(),this.m_torque=0,this.m_linearVelocity=s.clone(e.linearVelocity),this.m_angularVelocity=e.angularVelocity,this.m_linearDamping=e.linearDamping,this.m_angularDamping=e.angularDamping,this.m_gravityScale=e.gravityScale,this.m_sleepTime=0,this.m_jointList=null,this.m_contactList=null,this.m_fixtureList=null,this.m_prev=null,this.m_next=null}function b(){this.mass=0,this.center=s.zero(),this.I=0}v.prototype.isWorldLocked=function(){return!(!this.m_world||!this.m_world.isLocked())},v.prototype.getWorld=function(){return this.m_world},v.prototype.getNext=function(){return this.m_next},v.prototype.setUserData=function(t){this.m_userData=t},v.prototype.getUserData=function(){return this.m_userData},v.prototype.getFixtureList=function(){return this.m_fixtureList},v.prototype.getJointList=function(){return this.m_jointList},v.prototype.getContactList=function(){return this.m_contactList},v.prototype.isStatic=function(){return this.m_type==_},v.prototype.isDynamic=function(){return this.m_type==d},v.prototype.isKinematic=function(){return this.m_type==p},v.prototype.setStatic=function(){return this.setType(_),this},v.prototype.setDynamic=function(){return this.setType(d),this},v.prototype.setKinematic=function(){return this.setType(p),this},v.prototype.getType=function(){return this.m_type},v.prototype.setType=function(t){if(n&&i.assert(t===_||t===p||t===d),n&&i.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()&&this.m_type!=t){this.m_type=t,this.resetMassData(),this.m_type==_&&(this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_sweep.forward(),this.synchronizeFixtures()),this.setAwake(!0),this.m_force.setZero(),this.m_torque=0;for(var e=this.m_contactList;e;){var r=e;e=e.next,this.m_world.destroyContact(r.contact)}this.m_contactList=null;for(var o=this.m_world.m_broadPhase,s=this.m_fixtureList;s;s=s.m_next)for(var a=s.m_proxyCount,u=0;u<a;++u)o.touchProxy(s.m_proxies[u].proxyId)}},v.prototype.isBullet=function(){return this.m_bulletFlag},v.prototype.setBullet=function(t){this.m_bulletFlag=!!t},v.prototype.isSleepingAllowed=function(){return this.m_autoSleepFlag},v.prototype.setSleepingAllowed=function(t){this.m_autoSleepFlag=!!t,0==this.m_autoSleepFlag&&this.setAwake(!0)},v.prototype.isAwake=function(){return this.m_awakeFlag},v.prototype.setAwake=function(t){t?0==this.m_awakeFlag&&(this.m_awakeFlag=!0,this.m_sleepTime=0):(this.m_awakeFlag=!1,this.m_sleepTime=0,this.m_linearVelocity.setZero(),this.m_angularVelocity=0,this.m_force.setZero(),this.m_torque=0)},v.prototype.isActive=function(){return this.m_activeFlag},v.prototype.setActive=function(t){if(n&&i.assert(0==this.isWorldLocked()),t!=this.m_activeFlag)if(this.m_activeFlag=!!t,this.m_activeFlag)for(var e=this.m_world.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)r.createProxies(e,this.m_xf);else{for(e=this.m_world.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)r.destroyProxies(e);for(var o=this.m_contactList;o;){var s=o;o=o.next,this.m_world.destroyContact(s.contact)}this.m_contactList=null}},v.prototype.isFixedRotation=function(){return this.m_fixedRotationFlag},v.prototype.setFixedRotation=function(t){this.m_fixedRotationFlag!=t&&(this.m_fixedRotationFlag=!!t,this.m_angularVelocity=0,this.resetMassData())},v.prototype.getTransform=function(){return this.m_xf},v.prototype.setTransform=function(t,e){if(n&&i.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()){this.m_xf.set(t,e),this.m_sweep.setTransform(this.m_xf);for(var r=this.m_world.m_broadPhase,o=this.m_fixtureList;o;o=o.m_next)o.synchronize(r,this.m_xf,this.m_xf)}},v.prototype.synchronizeTransform=function(){this.m_sweep.getTransform(this.m_xf,1)},v.prototype.synchronizeFixtures=function(){var t=l.identity();this.m_sweep.getTransform(t,0);for(var e=this.m_world.m_broadPhase,r=this.m_fixtureList;r;r=r.m_next)r.synchronize(e,t,this.m_xf)},v.prototype.advance=function(t){this.m_sweep.advance(t),this.m_sweep.c.set(this.m_sweep.c0),this.m_sweep.a=this.m_sweep.a0,this.m_sweep.getTransform(this.m_xf,1)},v.prototype.getPosition=function(){return this.m_xf.p},v.prototype.setPosition=function(t){this.setTransform(t,this.m_sweep.a)},v.prototype.getAngle=function(){return this.m_sweep.a},v.prototype.setAngle=function(t){this.setTransform(this.m_xf.p,t)},v.prototype.getWorldCenter=function(){return this.m_sweep.c},v.prototype.getLocalCenter=function(){return this.m_sweep.localCenter},v.prototype.getLinearVelocity=function(){return this.m_linearVelocity},v.prototype.getLinearVelocityFromWorldPoint=function(t){var e=s.sub(t,this.m_sweep.c);return s.add(this.m_linearVelocity,s.cross(this.m_angularVelocity,e))},v.prototype.getLinearVelocityFromLocalPoint=function(t){return this.getLinearVelocityFromWorldPoint(this.getWorldPoint(t))},v.prototype.setLinearVelocity=function(t){this.m_type!=_&&(s.dot(t,t)>0&&this.setAwake(!0),this.m_linearVelocity.set(t))},v.prototype.getAngularVelocity=function(){return this.m_angularVelocity},v.prototype.setAngularVelocity=function(t){this.m_type!=_&&(t*t>0&&this.setAwake(!0),this.m_angularVelocity=t)},v.prototype.getLinearDamping=function(){return this.m_linearDamping},v.prototype.setLinearDamping=function(t){this.m_linearDamping=t},v.prototype.getAngularDamping=function(){return this.m_angularDamping},v.prototype.setAngularDamping=function(t){this.m_angularDamping=t},v.prototype.getGravityScale=function(){return this.m_gravityScale},v.prototype.setGravityScale=function(t){this.m_gravityScale=t},v.prototype.getMass=function(){return this.m_mass},v.prototype.getInertia=function(){return this.m_I+this.m_mass*s.dot(this.m_sweep.localCenter,this.m_sweep.localCenter)},v.prototype.getMassData=function(t){t.mass=this.m_mass,t.I=this.getInertia(),t.center.set(this.m_sweep.localCenter)},v.prototype.resetMassData=function(){if(this.m_mass=0,this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_sweep.localCenter.setZero(),this.isStatic()||this.isKinematic())return this.m_sweep.c0.set(this.m_xf.p),this.m_sweep.c.set(this.m_xf.p),void(this.m_sweep.a0=this.m_sweep.a);n&&i.assert(this.isDynamic());for(var t=s.zero(),e=this.m_fixtureList;e;e=e.m_next)if(0!=e.m_density){var r=new b;e.getMassData(r),this.m_mass+=r.mass,t.wAdd(r.mass,r.center),this.m_I+=r.I}this.m_mass>0?(this.m_invMass=1/this.m_mass,t.mul(this.m_invMass)):(this.m_mass=1,this.m_invMass=1),this.m_I>0&&0==this.m_fixedRotationFlag?(this.m_I-=this.m_mass*s.dot(t,t),n&&i.assert(this.m_I>0),this.m_invI=1/this.m_I):(this.m_I=0,this.m_invI=0);var o=s.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t,this.m_xf),this.m_linearVelocity.add(s.cross(this.m_angularVelocity,s.sub(this.m_sweep.c,o)))},v.prototype.setMassData=function(t){if(n&&i.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()&&this.m_type==d){this.m_invMass=0,this.m_I=0,this.m_invI=0,this.m_mass=t.mass,this.m_mass<=0&&(this.m_mass=1),this.m_invMass=1/this.m_mass,t.I>0&&0==this.m_fixedRotationFlag&&(this.m_I=t.I-this.m_mass*s.dot(t.center,t.center),n&&i.assert(this.m_I>0),this.m_invI=1/this.m_I);var e=s.clone(this.m_sweep.c);this.m_sweep.setLocalCenter(t.center,this.m_xf),this.m_linearVelocity.add(s.cross(this.m_angularVelocity,s.sub(this.m_sweep.c,e)))}},v.prototype.applyForce=function(t,e,r){this.m_type==d&&(r&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_force.add(t),this.m_torque+=s.cross(s.sub(e,this.m_sweep.c),t)))},v.prototype.applyForceToCenter=function(t,e){this.m_type==d&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&this.m_force.add(t))},v.prototype.applyTorque=function(t,e){this.m_type==d&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_torque+=t))},v.prototype.applyLinearImpulse=function(t,e,r){this.m_type==d&&(r&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_linearVelocity.wAdd(this.m_invMass,t),this.m_angularVelocity+=this.m_invI*s.cross(s.sub(e,this.m_sweep.c),t)))},v.prototype.applyAngularImpulse=function(t,e){this.m_type==d&&(e&&0==this.m_awakeFlag&&this.setAwake(!0),this.m_awakeFlag&&(this.m_angularVelocity+=this.m_invI*t))},v.prototype.shouldCollide=function(t){if(this.m_type!=d&&t.m_type!=d)return!1;for(var e=this.m_jointList;e;e=e.next)if(e.other==t&&0==e.joint.m_collideConnected)return!1;return!0},v.prototype.createFixture=function(t,e){if(n&&i.assert(0==this.isWorldLocked()),1==this.isWorldLocked())return null;var r=new f(this,t,e);if(this.m_activeFlag){var o=this.m_world.m_broadPhase;r.createProxies(o,this.m_xf)}return r.m_next=this.m_fixtureList,this.m_fixtureList=r,r.m_density>0&&this.resetMassData(),this.m_world.m_newFixture=!0,r},v.prototype.destroyFixture=function(t){if(n&&i.assert(0==this.isWorldLocked()),1!=this.isWorldLocked()){n&&i.assert(t.m_body==this);var e=!1;if(this.m_fixtureList===t)this.m_fixtureList=t.m_next,e=!0;else for(var r=this.m_fixtureList;null!=r;){if(r.m_next===t){r.m_next=t.m_next,e=!0;break}r=r.m_next}n&&i.assert(e);for(var o=this.m_contactList;o;){var s=o.contact;o=o.next;var a=s.getFixtureA(),u=s.getFixtureB();t!=a&&t!=u||this.m_world.destroyContact(s)}if(this.m_activeFlag){var c=this.m_world.m_broadPhase;t.destroyProxies(c)}t.m_body=null,t.m_next=null,this.m_world.publish("remove-fixture",t),this.resetMassData()}},v.prototype.getWorldPoint=function(t){return l.mul(this.m_xf,t)},v.prototype.getWorldVector=function(t){return a.mul(this.m_xf.q,t)},v.prototype.getLocalPoint=function(t){return l.mulT(this.m_xf,t)},v.prototype.getLocalVector=function(t){return a.mulT(this.m_xf.q,t)}},function(t,e){t.exports="#version 300 es\n\nprecision mediump float;\nprecision mediump int;\n\nout vec4 out_color;\n\nuniform highp vec4 color;\n\nvoid main() {\n    out_color = color;\n}\n"},function(t,e){t.exports="#version 300 es\n\nlayout(location = 0) in vec2 position;\n\nuniform mat4 projection;\n\nvoid main() {\n    vec4 transformed_position = projection * vec4(position, 0, 1);\n    gl_Position = transformed_position;\n}\n"},function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.LineRenderer=void 0;var n=u(r(5)),i=r(1),o=r(15),s=u(r(137)),a=u(r(136));function u(t){return t&&t.__esModule?t:{default:t}}function c(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var m=null,h=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){c(t,e,r[e])})}return t}({maxLines:32768},e),o=r.game,u=r.maxLines;this.game=o,this.maxLines=u,m||(m=n.default.createProgramInfo(i.gl,[s.default,a.default])),this.programInfo=m,this.setup()}return function(t,e,r){e&&l(t.prototype,e),r&&l(t,r)}(t,[{key:"setup",value:function(){this.bufferInfo=n.default.createBufferInfoFromArrays(i.gl,{position:{numComponents:2,drawType:i.gl.DYNAMIC_DRAW},translation:{numComponents:2,drawType:i.gl.DYNAMIC_DRAW}}),this.arrays={position:new Float32Array(4*this.maxLines)},this.vao=n.default.createVertexArrayInfo(i.gl,this.programInfo,this.bufferInfo),n.default.setBuffersAndAttributes(i.gl,this.programInfo,this.vao)}},{key:"render",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1,1];this.arrays.position.set(t),i.gl.useProgram(this.programInfo.program),n.default.setUniforms(this.programInfo,{projection:this.game.viewMatrix,color:e}),n.default.setAttribInfoBufferFromArray(i.gl,this.bufferInfo.attribs.position,this.arrays.position),n.default.setBuffersAndAttributes(i.gl,this.programInfo,this.vao),n.default.drawBufferInfo(i.gl,this.vao,i.gl.LINES,t.length/2)}},{key:"renderPolygons",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[1,1,1,1],r=(0,o.arraySetter)(this.arrays.position),s=0;t.forEach(function(t){r(t.vertices[0]),t.vertices.slice(1).forEach(function(t){return r(t.concat(t))}),r(t.vertices[0]),s+=t.vertices.length}),n.default.setAttribInfoBufferFromArray(i.gl,this.bufferInfo.attribs.position,this.arrays.position),i.gl.useProgram(this.programInfo.program),n.default.setUniforms(this.programInfo,{projection:this.game.viewMatrix,color:e}),n.default.setBuffersAndAttributes(i.gl,this.programInfo,this.vao),n.default.drawBufferInfo(i.gl,this.vao,i.gl.LINES,2*s)}}]),t}();e.LineRenderer=h},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=y;var i=r(7),o=r(28),s=r(22),a=r(13),u=r(4),c=r(3),l=r(42),m=r(43),h=r(47),f=r(12),_=(r(40),r(14),r(45),r(44),r(46)),p=0;y.TYPE="prismatic-joint",y._super=_,y.prototype=s(y._super.prototype);var d={enableLimit:!1,lowerTranslation:0,upperTranslation:0,enableMotor:!1,maxMotorForce:0,motorSpeed:0};function y(t,e,r,n,i){if(!(this instanceof y))return new y(t,e,r,n,i);t=o(t,d),_.call(this,t,e,r),this.m_type=y.TYPE,this.m_localAnchorA=t.localAnchorA||e.getLocalPoint(n),this.m_localAnchorB=t.localAnchorB||r.getLocalPoint(n),this.m_localXAxisA=t.localAxisA||e.getLocalVector(i),this.m_localXAxisA.normalize(),this.m_localYAxisA=c.cross(1,this.m_localXAxisA),this.m_referenceAngle=r.getAngle()-e.getAngle(),this.m_impulse=l(),this.m_motorMass=0,this.m_motorImpulse=0,this.m_lowerTranslation=t.lowerTranslation,this.m_upperTranslation=t.upperTranslation,this.m_maxMotorForce=t.maxMotorForce,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_limitState=p,this.m_axis=c.zero(),this.m_perp=c.zero(),this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_axis,this.m_perp,this.m_s1,this.m_s2,this.m_a1,this.m_a2,this.m_K=new h,this.m_motorMass}y.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},y.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},y.prototype.getLocalAxisA=function(){return this.m_localXAxisA},y.prototype.getReferenceAngle=function(){return this.m_referenceAngle},y.prototype.getJointTranslation=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_bodyB.getWorldPoint(this.m_localAnchorB),r=c.sub(e,t),n=this.m_bodyA.getWorldVector(this.m_localXAxisA);return c.dot(r,n)},y.prototype.getJointSpeed=function(){var t=this.m_bodyA,e=this.m_bodyB,r=Mul(t.m_xf.q,this.m_localAnchorA-t.m_sweep.localCenter),n=Mul(e.m_xf.q,this.m_localAnchorB-e.m_sweep.localCenter),i=t.m_sweep.c+r,o=e.m_sweep.c+n-i,s=Mul(t.m_xf.q,this.m_localXAxisA),a=t.m_linearVelocity,u=e.m_linearVelocity,c=t.m_angularVelocity,l=e.m_angularVelocity;return Dot(o,Cross(c,s))+Dot(s,u+Cross(l,n)-a-Cross(c,r))},y.prototype.isLimitEnabled=function(){return this.m_enableLimit},y.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},y.prototype.getLowerLimit=function(){return this.m_lowerTranslation},y.prototype.getUpperLimit=function(){return this.m_upperTranslation},y.prototype.setLimits=function(t,e){n&&i.assert(t<=e),t==this.m_lowerTranslation&&e==this.m_upperTranslation||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_lowerTranslation=t,this.m_upperTranslation=e,this.m_impulse.z=0)},y.prototype.isMotorEnabled=function(){return this.m_enableMotor},y.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},y.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},y.prototype.setMaxMotorForce=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorForce=t},y.prototype.getMotorSpeed=function(){return this.m_motorSpeed},y.prototype.getMotorForce=function(t){return t*this.m_motorImpulse},y.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},y.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},y.prototype.getReactionForce=function(t){return t*(this.m_impulse.x*this.m_perp+(this.m_motorImpulse+this.m_impulse.z)*this.m_axis)},y.prototype.getReactionTorque=function(t){return t*this.m_impulse.y},y.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,l=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,h=f.neo(r),_=f.neo(s),d=f.mul(h,c.sub(this.m_localAnchorA,this.m_localCenterA)),y=f.mul(_,c.sub(this.m_localAnchorB,this.m_localCenterB)),v=c.zero();v.wAdd(1,o,1,y),v.wSub(1,e,1,d);var b=this.m_invMassA,g=this.m_invMassB,x=this.m_invIA,A=this.m_invIB;this.m_axis=f.mul(h,this.m_localXAxisA),this.m_a1=c.cross(c.add(v,d),this.m_axis),this.m_a2=c.cross(y,this.m_axis),this.m_motorMass=b+g+x*this.m_a1*this.m_a1+A*this.m_a2*this.m_a2,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),this.m_perp=f.mul(h,this.m_localYAxisA),this.m_s1=c.cross(c.add(v,d),this.m_perp),this.m_s2=c.cross(y,this.m_perp);c.cross(d,this.m_perp);var w=b+g+x*this.m_s1*this.m_s1+A*this.m_s2*this.m_s2,B=x*this.m_s1+A*this.m_s2,E=x*this.m_s1*this.m_a1+A*this.m_s2*this.m_a2,M=x+A;0==M&&(M=1);var S=x*this.m_a1+A*this.m_a2,T=b+g+x*this.m_a1*this.m_a1+A*this.m_a2*this.m_a2;if(this.m_K.ex.set(w,B,E),this.m_K.ey.set(B,M,S),this.m_K.ez.set(E,S,T),this.m_enableLimit){var I=c.dot(this.m_axis,v);u.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*a.linearSlop?this.m_limitState=3:I<=this.m_lowerTranslation?1!=this.m_limitState&&(this.m_limitState=1,this.m_impulse.z=0):I>=this.m_upperTranslation?2!=this.m_limitState&&(this.m_limitState=2,this.m_impulse.z=0):(this.m_limitState=p,this.m_impulse.z=0)}else this.m_limitState=p,this.m_impulse.z=0;if(0==this.m_enableMotor&&(this.m_motorImpulse=0),t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var P=c.wAdd(this.m_impulse.x,this.m_perp,this.m_motorImpulse+this.m_impulse.z,this.m_axis),C=this.m_impulse.x*this.m_s1+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a1,R=this.m_impulse.x*this.m_s2+this.m_impulse.y+(this.m_motorImpulse+this.m_impulse.z)*this.m_a2;n.wSub(b,P),i-=x*C,l.wAdd(g,P),m+=A*R}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(n),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(l),this.m_bodyB.c_velocity.w=m},y.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,i=this.m_bodyB.c_velocity.w,o=this.m_invMassA,s=this.m_invMassB,a=this.m_invIA,m=this.m_invIB;if(this.m_enableMotor&&3!=this.m_limitState){var h=c.dot(this.m_axis,c.sub(n,e))+this.m_a2*i-this.m_a1*r,f=this.m_motorMass*(this.m_motorSpeed-h),_=this.m_motorImpulse,d=t.dt*this.m_maxMotorForce;this.m_motorImpulse=u.clamp(this.m_motorImpulse+f,-d,d),f=this.m_motorImpulse-_;var y=c.zero().wSet(f,this.m_axis),v=f*this.m_a1,b=f*this.m_a2;e.wSub(o,y),r-=a*v,n.wAdd(s,y),i+=m*b}var g=c.zero();if(g.x+=c.dot(this.m_perp,n)+this.m_s2*i,g.x-=c.dot(this.m_perp,e)+this.m_s1*r,g.y=i-r,this.m_enableLimit&&this.m_limitState!=p){var x=0;x+=c.dot(this.m_axis,n)+this.m_a2*i,x-=c.dot(this.m_axis,e)+this.m_a1*r;h=l(g.x,g.y,x);var A=l(this.m_impulse),w=this.m_K.solve33(l.neg(h));this.m_impulse.add(w),1==this.m_limitState?this.m_impulse.z=u.max(this.m_impulse.z,0):2==this.m_limitState&&(this.m_impulse.z=u.min(this.m_impulse.z,0));var B=c.wAdd(-1,g,-(this.m_impulse.z-A.z),c.neo(this.m_K.ez.x,this.m_K.ez.y)),E=c.add(this.m_K.solve22(B),c.neo(A.x,A.y));this.m_impulse.x=E.x,this.m_impulse.y=E.y,w=l.sub(this.m_impulse,A);y=c.wAdd(w.x,this.m_perp,w.z,this.m_axis),v=w.x*this.m_s1+w.y+w.z*this.m_a1,b=w.x*this.m_s2+w.y+w.z*this.m_a2;e.wSub(o,y),r-=a*v,n.wAdd(s,y),i+=m*b}else{w=this.m_K.solve22(c.neg(g));this.m_impulse.x+=w.x,this.m_impulse.y+=w.y;y=c.zero().wAdd(w.x,this.m_perp),v=w.x*this.m_s1+w.y,b=w.x*this.m_s2+w.y;e.wSub(o,y),r-=a*v,n.wAdd(s,y),i+=m*b}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=i},y.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,i=this.m_bodyB.c_position.a,o=f.neo(r),s=f.neo(i),_=this.m_invMassA,p=this.m_invMassB,d=this.m_invIA,y=this.m_invIB,v=f.mul(o,c.sub(this.m_localAnchorA,this.m_localCenterA)),b=f.mul(s,c.sub(this.m_localAnchorB,this.m_localCenterB)),g=c.sub(c.add(n,b),c.add(e,v)),x=f.mul(o,this.m_localXAxisA),A=c.cross(c.add(g,v),x),w=c.cross(b,x),B=f.mul(o,this.m_localYAxisA),E=c.cross(c.add(g,v),B),M=c.cross(b,B),S=l(),T=c.zero();T.x=c.dot(B,g),T.y=i-r-this.m_referenceAngle;var I=u.abs(T.x),P=u.abs(T.y),C=a.linearSlop,R=a.maxLinearCorrection,F=!1,D=0;if(this.m_enableLimit){var L=c.dot(x,g);u.abs(this.m_upperTranslation-this.m_lowerTranslation)<2*C?(D=u.clamp(L,-R,R),I=u.max(I,u.abs(L)),F=!0):L<=this.m_lowerTranslation?(D=u.clamp(L-this.m_lowerTranslation+C,-R,0),I=u.max(I,this.m_lowerTranslation-L),F=!0):L>=this.m_upperTranslation&&(D=u.clamp(L-this.m_upperTranslation-C,0,R),I=u.max(I,L-this.m_upperTranslation),F=!0)}if(F){var O=_+p+d*E*E+y*M*M,k=d*E+y*M,U=d*E*A+y*M*w;0==(N=d+y)&&(N=1);var z=d*A+y*w,j=_+p+d*A*A+y*w*w;(q=new h).ex.set(O,k,U),q.ey.set(k,N,z),q.ez.set(U,z,j);var V=l();V.x=T.x,V.y=T.y,V.z=D,S=q.solve33(l.neg(V))}else{var N,q;O=_+p+d*E*E+y*M*M,k=d*E+y*M;0==(N=d+y)&&(N=1),(q=new m).ex.set(O,k),q.ey.set(k,N);var G=q.solve(c.neg(T));S.x=G.x,S.y=G.y,S.z=0}var W=c.wAdd(S.x,B,S.z,x),Y=S.x*E+S.y+S.z*A,X=S.x*M+S.y+S.z*w;return e.wSub(_,W),r-=d*Y,n.wAdd(p,W),i+=y*X,this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c=n,this.m_bodyB.c_position.a=i,I<=a.linearSlop&&P<=a.angularSlop}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=y;var i=r(7),o=r(28),s=r(22),a=r(13),u=r(4),c=r(3),l=r(42),m=r(43),h=r(47),f=r(12),_=(r(40),r(14),r(45),r(44),r(46)),p=0;y.TYPE="revolute-joint",y._super=_,y.prototype=s(y._super.prototype);var d={lowerAngle:0,upperAngle:0,maxMotorTorque:0,motorSpeed:0,enableLimit:!1,enableMotor:!1};function y(t,e,r,n){if(!(this instanceof y))return new y(t,e,r,n);t=o(t,d),_.call(this,t,e,r),this.m_type=y.TYPE,this.m_localAnchorA=t.localAnchorA||e.getLocalPoint(n),this.m_localAnchorB=t.localAnchorB||r.getLocalPoint(n),this.m_referenceAngle=r.getAngle()-e.getAngle(),this.m_impulse=l(),this.m_motorImpulse=0,this.m_lowerAngle=t.lowerAngle,this.m_upperAngle=t.upperAngle,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableLimit=t.enableLimit,this.m_enableMotor=t.enableMotor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass=new h,this.m_motorMass,this.m_limitState=p}y.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},y.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},y.prototype.getReferenceAngle=function(){return this.m_referenceAngle},y.prototype.getJointAngle=function(){var t=this.m_bodyA;return this.m_bodyB.m_sweep.a-t.m_sweep.a-this.m_referenceAngle},y.prototype.getJointSpeed=function(){var t=this.m_bodyA;return this.m_bodyB.m_angularVelocity-t.m_angularVelocity},y.prototype.isMotorEnabled=function(){return this.m_enableMotor},y.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},y.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},y.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},y.prototype.getMotorSpeed=function(){return this.m_motorSpeed},y.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},y.prototype.isLimitEnabled=function(){return this.m_enableLimit},y.prototype.enableLimit=function(t){t!=this.m_enableLimit&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableLimit=t,this.m_impulse.z=0)},y.prototype.getLowerLimit=function(){return this.m_lowerAngle},y.prototype.getUpperLimit=function(){return this.m_upperAngle},y.prototype.setLimits=function(t,e){n&&i.assert(t<=e),t==this.m_lowerAngle&&e==this.m_upperAngle||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_impulse.z=0,this.m_lowerAngle=t,this.m_upperAngle=e)},y.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},y.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},y.prototype.getReactionForce=function(t){return t*c.neo(this.m_impulse.x,this.m_impulse.y)},y.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},y.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,l=f.neo(e),m=f.neo(i);this.m_rA=f.mul(l,c.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=f.mul(m,c.sub(this.m_localAnchorB,this.m_localCenterB));var h=this.m_invMassA,_=this.m_invMassB,d=this.m_invIA,y=this.m_invIB,v=d+y==0;if(this.m_mass.ex.x=h+_+this.m_rA.y*this.m_rA.y*d+this.m_rB.y*this.m_rB.y*y,this.m_mass.ey.x=-this.m_rA.y*this.m_rA.x*d-this.m_rB.y*this.m_rB.x*y,this.m_mass.ez.x=-this.m_rA.y*d-this.m_rB.y*y,this.m_mass.ex.y=this.m_mass.ey.x,this.m_mass.ey.y=h+_+this.m_rA.x*this.m_rA.x*d+this.m_rB.x*this.m_rB.x*y,this.m_mass.ez.y=this.m_rA.x*d+this.m_rB.x*y,this.m_mass.ex.z=this.m_mass.ez.x,this.m_mass.ey.z=this.m_mass.ez.y,this.m_mass.ez.z=d+y,this.m_motorMass=d+y,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass),(0==this.m_enableMotor||v)&&(this.m_motorImpulse=0),this.m_enableLimit&&0==v){var b=i-e-this.m_referenceAngle;u.abs(this.m_upperAngle-this.m_lowerAngle)<2*a.angularSlop?this.m_limitState=3:b<=this.m_lowerAngle?(1!=this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=1):b>=this.m_upperAngle?(2!=this.m_limitState&&(this.m_impulse.z=0),this.m_limitState=2):(this.m_limitState=p,this.m_impulse.z=0)}else this.m_limitState=p;if(t.warmStarting){this.m_impulse.mul(t.dtRatio),this.m_motorImpulse*=t.dtRatio;var g=c.neo(this.m_impulse.x,this.m_impulse.y);r.wSub(h,g),n-=d*(c.cross(this.m_rA,g)+this.m_motorImpulse+this.m_impulse.z),o.wAdd(_,g),s+=y*(c.cross(this.m_rB,g)+this.m_motorImpulse+this.m_impulse.z)}else this.m_impulse.setZero(),this.m_motorImpulse=0;this.m_bodyA.c_velocity.v=r,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},y.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,i=this.m_bodyB.c_velocity.w,o=this.m_invMassA,s=this.m_invMassB,a=this.m_invIA,m=this.m_invIB,h=a+m==0;if(this.m_enableMotor&&3!=this.m_limitState&&0==h){var f=i-r-this.m_motorSpeed,_=-this.m_motorMass*f,d=this.m_motorImpulse,y=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=u.clamp(this.m_motorImpulse+_,-y,y),r-=a*(_=this.m_motorImpulse-d),i+=m*_}if(this.m_enableLimit&&this.m_limitState!=p&&0==h){var v=c.zero();v.wAdd(1,n,1,c.cross(i,this.m_rB)),v.wSub(1,e,1,c.cross(r,this.m_rA));var b=i-r;f=l(v.x,v.y,b),_=l.neg(this.m_mass.solve33(f));if(3==this.m_limitState)this.m_impulse.add(_);else if(1==this.m_limitState){if(this.m_impulse.z+_.z<0){var g=c.wAdd(-1,v,this.m_impulse.z,c.neo(this.m_mass.ez.x,this.m_mass.ez.y)),x=this.m_mass.solve22(g);_.x=x.x,_.y=x.y,_.z=-this.m_impulse.z,this.m_impulse.x+=x.x,this.m_impulse.y+=x.y,this.m_impulse.z=0}else this.m_impulse.add(_)}else if(2==this.m_limitState){if(this.m_impulse.z+_.z>0){g=c.wAdd(-1,v,this.m_impulse.z,c.neo(this.m_mass.ez.x,this.m_mass.ez.y)),x=this.m_mass.solve22(g);_.x=x.x,_.y=x.y,_.z=-this.m_impulse.z,this.m_impulse.x+=x.x,this.m_impulse.y+=x.y,this.m_impulse.z=0}else this.m_impulse.add(_)}var A=c.neo(_.x,_.y);e.wSub(o,A),r-=a*(c.cross(this.m_rA,A)+_.z),n.wAdd(s,A),i+=m*(c.cross(this.m_rB,A)+_.z)}else{(f=c.zero()).wAdd(1,n,1,c.cross(i,this.m_rB)),f.wSub(1,e,1,c.cross(r,this.m_rA));_=this.m_mass.solve22(c.neg(f));this.m_impulse.x+=_.x,this.m_impulse.y+=_.y,e.wSub(o,_),r-=a*c.cross(this.m_rA,_),n.wAdd(s,_),i+=m*c.cross(this.m_rB,_)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=i},y.prototype.solvePositionConstraints=function(t){var e,r=this.m_bodyA.c_position.c,n=this.m_bodyA.c_position.a,i=this.m_bodyB.c_position.c,o=this.m_bodyB.c_position.a,s=f.neo(n),l=f.neo(o),h=0,_=this.m_invIA+this.m_invIB==0;if(this.m_enableLimit&&this.m_limitState!=p&&0==_){var d=o-n-this.m_referenceAngle,y=0;if(3==this.m_limitState){var v=u.clamp(d-this.m_lowerAngle,-a.maxAngularCorrection,a.maxAngularCorrection);y=-this.m_motorMass*v,h=u.abs(v)}else if(1==this.m_limitState){h=-(v=d-this.m_lowerAngle),v=u.clamp(v+a.angularSlop,-a.maxAngularCorrection,0),y=-this.m_motorMass*v}else if(2==this.m_limitState){h=v=d-this.m_upperAngle,v=u.clamp(v-a.angularSlop,0,a.maxAngularCorrection),y=-this.m_motorMass*v}n-=this.m_invIA*y,o+=this.m_invIB*y}s.set(n),l.set(o);var b=f.mul(s,c.sub(this.m_localAnchorA,this.m_localCenterA)),g=f.mul(l,c.sub(this.m_localAnchorB,this.m_localCenterB));(v=c.zero()).wAdd(1,i,1,g),v.wSub(1,r,1,b),e=v.length();var x=this.m_invMassA,A=this.m_invMassB,w=this.m_invIA,B=this.m_invIB,E=new m;E.ex.x=x+A+w*b.y*b.y+B*g.y*g.y,E.ex.y=-w*b.x*b.y-B*g.x*g.y,E.ey.x=E.ex.y,E.ey.y=x+A+w*b.x*b.x+B*g.x*g.x;var M=c.neg(E.solve(v));return r.wSub(x,M),n-=w*c.cross(b,M),i.wAdd(A,M),o+=B*c.cross(g,M),this.m_bodyA.c_position.c.set(r),this.m_bodyA.c_position.a=n,this.m_bodyB.c_position.c.set(i),this.m_bodyB.c_position.a=o,e<=a.linearSlop&&h<=a.angularSlop}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=function(t,e){var r=s.now();++a.toiCalls,t.state=v.e_unknown,t.t=e.tMax;var c=e.proxyA,l=e.proxyB,m=e.sweepA,d=e.sweepB;m.normalize(),d.normalize();var g=e.tMax,x=c.m_radius+l.m_radius,A=u.max(i.linearSlop,x-3*i.linearSlop),w=.25*i.linearSlop;n&&o.assert(A>w);var B=0,E=i.maxTOIIterations,M=0,S=new y,T=new _;for(T.proxyA=e.proxyA,T.proxyB=e.proxyB,T.useRadii=!1;;){var I=h.identity(),P=h.identity();m.getTransform(I,B),d.getTransform(P,B),T.transformA=I,T.transformB=P;var C=new p;if(f(C,S,T),C.distance<=0){t.state=v.e_overlapped,t.t=0;break}if(C.distance<A+w){t.state=v.e_touching,t.t=B;break}var R=new b;R.initialize(S,c,m,l,d,B);for(var F=!1,D=g,L=0;;){var O=R.findMinSeparation(D);R.indexA,R.indexB;if(O>A+w){t.state=v.e_separated,t.t=g,F=!0;break}if(O>A-w){B=D;break}var k=R.evaluate(B);R.indexA,R.indexB;if(k<A-w){t.state=v.e_failed,t.t=B,F=!0;break}if(k<=A+w){t.state=v.e_touching,t.t=B,F=!0;break}for(var U=0,z=B,j=D;;){var V;V=1&U?z+(A-k)*(j-z)/(O-k):.5*(z+j),++U,++a.toiRootIters;var N=R.evaluate(V);R.indexA,R.indexB;if(u.abs(N-A)<w){D=V;break}if(N>A?(z=V,k=N):(j=V,O=N),50==U)break}if(a.toiMaxRootIters=u.max(a.toiMaxRootIters,U),++L==i.maxPolygonVertices)break}if(++M,++a.toiIters,F)break;if(M==E){t.state=v.e_failed,t.t=B;break}}a.toiMaxIters=u.max(a.toiMaxIters,M);var q=s.diff(r);a.toiMaxTime=u.max(a.toiMaxTime,q),a.toiTime+=q},t.exports.Input=function(){this.proxyA=new d,this.proxyB=new d,this.sweepA=new m,this.sweepB=new m,this.tMax},t.exports.Output=v;var i=r(13),o=r(7),s=r(257),a=r(134),u=r(4),c=r(3),l=(r(42),r(43),r(47),r(12)),m=r(40),h=r(14),f=(r(45),r(44),r(107)),_=f.Input,p=f.Output,d=f.Proxy,y=f.Cache;function v(){this.state,this.t}v.e_unknown=0,v.e_failed=1,v.e_overlapped=2,v.e_touching=3,v.e_separated=4,a.toiTime=0,a.toiMaxTime=0,a.toiCalls=0,a.toiIters=0,a.toiMaxIters=0,a.toiRootIters=0,a.toiMaxRootIters=0;function b(){this.m_proxyA=new d,this.m_proxyB=new d,this.m_sweepA,this.m_sweepB,this.m_type,this.m_localPoint=c.zero(),this.m_axis=c.zero()}b.prototype.initialize=function(t,e,r,i,s,a){this.m_proxyA=e,this.m_proxyB=i;var u=t.count;n&&o.assert(0<u&&u<3),this.m_sweepA=r,this.m_sweepB=s;var m=h.identity(),f=h.identity();if(this.m_sweepA.getTransform(m,a),this.m_sweepB.getTransform(f,a),1==u){this.m_type=1;var _=this.m_proxyA.getVertex(t.indexA[0]),p=this.m_proxyB.getVertex(t.indexB[0]),d=h.mul(m,_),y=h.mul(f,p);return this.m_axis.wSet(1,y,-1,d),w=this.m_axis.normalize()}if(t.indexA[0]==t.indexA[1]){this.m_type=3;var v=i.getVertex(t.indexB[0]),b=i.getVertex(t.indexB[1]);this.m_axis=c.cross(c.sub(b,v),1),this.m_axis.normalize();var g=l.mul(f.q,this.m_axis);this.m_localPoint=c.mid(v,b);y=h.mul(f,this.m_localPoint),_=e.getVertex(t.indexA[0]),d=h.mul(m,_);return(w=c.dot(d,g)-c.dot(y,g))<0&&(this.m_axis=c.neg(this.m_axis),w=-w),w}this.m_type=2;var x=this.m_proxyA.getVertex(t.indexA[0]),A=this.m_proxyA.getVertex(t.indexA[1]);this.m_axis=c.cross(c.sub(A,x),1),this.m_axis.normalize();g=l.mul(m.q,this.m_axis);this.m_localPoint=c.mid(x,A);var w;d=h.mul(m,this.m_localPoint),p=this.m_proxyB.getVertex(t.indexB[0]),y=h.mul(f,p);return(w=c.dot(y,g)-c.dot(d,g))<0&&(this.m_axis=c.neg(this.m_axis),w=-w),w},b.prototype.compute=function(t,e){var r=h.identity(),i=h.identity();switch(this.m_sweepA.getTransform(r,e),this.m_sweepB.getTransform(i,e),this.m_type){case 1:if(t){var s=l.mulT(r.q,this.m_axis),a=l.mulT(i.q,c.neg(this.m_axis));this.indexA=this.m_proxyA.getSupport(s),this.indexB=this.m_proxyB.getSupport(a)}var u=this.m_proxyA.getVertex(this.indexA),m=this.m_proxyB.getVertex(this.indexB),f=h.mul(r,u),_=h.mul(i,m);return c.dot(_,this.m_axis)-c.dot(f,this.m_axis);case 2:var p=l.mul(r.q,this.m_axis);f=h.mul(r,this.m_localPoint);if(t){a=l.mulT(i.q,c.neg(p));this.indexA=-1,this.indexB=this.m_proxyB.getSupport(a)}m=this.m_proxyB.getVertex(this.indexB),_=h.mul(i,m);return c.dot(_,p)-c.dot(f,p);case 3:p=l.mul(i.q,this.m_axis),_=h.mul(i,this.m_localPoint);if(t){s=l.mulT(r.q,c.neg(p));this.indexB=-1,this.indexA=this.m_proxyA.getSupport(s)}u=this.m_proxyA.getVertex(this.indexA),f=h.mul(r,u);return c.dot(f,p)-c.dot(_,p);default:return n&&o.assert(!1),t&&(this.indexA=-1,this.indexB=-1),0}},b.prototype.findMinSeparation=function(t){return this.compute(!0,t)},b.prototype.evaluate=function(t){return this.compute(!1,t)}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,i=r(13),o=r(7),s=r(259),a=r(3),u=r(4),c=r(62);function l(t){this.id=t,this.aabb=new c,this.userData=null,this.parent=null,this.child1=null,this.child2=null,this.height=-1,this.toString=function(){return this.id+": "+this.userData}}function m(){this.m_root=null,this.m_nodes={},this.m_lastProxyId=0,this.m_pool=new s({create:function(){return new l}})}t.exports=m,l.prototype.isLeaf=function(){return null==this.child1},m.prototype.getUserData=function(t){var e=this.m_nodes[t];return n&&o.assert(!!e),e.userData},m.prototype.getFatAABB=function(t){var e=this.m_nodes[t];return n&&o.assert(!!e),e.aabb},m.prototype.allocateNode=function(){var t=this.m_pool.allocate();return t.id=++this.m_lastProxyId,t.userData=null,t.parent=null,t.child1=null,t.child2=null,t.height=-1,this.m_nodes[t.id]=t,t},m.prototype.freeNode=function(t){this.m_pool.release(t),t.height=-1,delete this.m_nodes[t.id]},m.prototype.createProxy=function(t,e){n&&o.assert(c.isValid(t));var r=this.allocateNode();return r.aabb.set(t),c.extend(r.aabb,i.aabbExtension),r.userData=e,r.height=0,this.insertLeaf(r),r.id},m.prototype.destroyProxy=function(t){var e=this.m_nodes[t];n&&o.assert(!!e),n&&o.assert(e.isLeaf()),this.removeLeaf(e),this.freeNode(e)},m.prototype.moveProxy=function(t,e,r){n&&o.assert(c.isValid(e)),n&&o.assert(!r||a.isValid(r));var s=this.m_nodes[t];return n&&o.assert(!!s),n&&o.assert(s.isLeaf()),!s.aabb.contains(e)&&(this.removeLeaf(s),s.aabb.set(e),e=s.aabb,c.extend(e,i.aabbExtension),r.x<0?e.lowerBound.x+=r.x*i.aabbMultiplier:e.upperBound.x+=r.x*i.aabbMultiplier,r.y<0?e.lowerBound.y+=r.y*i.aabbMultiplier:e.upperBound.y+=r.y*i.aabbMultiplier,this.insertLeaf(s),!0)},m.prototype.insertLeaf=function(t){if(n&&o.assert(c.isValid(t.aabb)),null==this.m_root)return this.m_root=t,void(this.m_root.parent=null);for(var e=t.aabb,r=this.m_root;0==r.isLeaf();){var i=r.child1,s=r.child2,a=r.aabb.getPerimeter(),l=new c;l.combine(r.aabb,e);var m,h,f=l.getPerimeter(),_=2*f,p=2*(f-a);if(i.isLeaf()){(y=new c).combine(e,i.aabb),m=y.getPerimeter()+p}else{(y=new c).combine(e,i.aabb);var d=i.aabb.getPerimeter();m=y.getPerimeter()-d+p}if(s.isLeaf()){(y=new c).combine(e,s.aabb),h=y.getPerimeter()+p}else{var y;(y=new c).combine(e,s.aabb);d=s.aabb.getPerimeter();h=y.getPerimeter()-d+p}if(_<m&&_<h)break;r=m<h?i:s}var v=r,b=v.parent,g=this.allocateNode();for(g.parent=b,g.userData=null,g.aabb.combine(e,v.aabb),g.height=v.height+1,null!=b?(b.child1==v?b.child1=g:b.child2=g,g.child1=v,g.child2=t,v.parent=g,t.parent=g):(g.child1=v,g.child2=t,v.parent=g,t.parent=g,this.m_root=g),r=t.parent;null!=r;){i=(r=this.balance(r)).child1,s=r.child2;n&&o.assert(null!=i),n&&o.assert(null!=s),r.height=1+u.max(i.height,s.height),r.aabb.combine(i.aabb,s.aabb),r=r.parent}},m.prototype.removeLeaf=function(t){if(t!=this.m_root){var e,r=t.parent,n=r.parent;if(e=r.child1==t?r.child2:r.child1,null!=n){n.child1==r?n.child1=e:n.child2=e,e.parent=n,this.freeNode(r);for(var i=n;null!=i;){var o=(i=this.balance(i)).child1,s=i.child2;i.aabb.combine(o.aabb,s.aabb),i.height=1+u.max(o.height,s.height),i=i.parent}}else this.m_root=e,e.parent=null,this.freeNode(r)}else this.m_root=null},m.prototype.balance=function(t){n&&o.assert(null!=t);var e=t;if(e.isLeaf()||e.height<2)return t;var r=e.child1,i=e.child2,s=i.height-r.height;if(s>1){var a=i.child1,c=i.child2;return i.child1=e,i.parent=e.parent,e.parent=i,null!=i.parent?i.parent.child1==t?i.parent.child1=i:i.parent.child2=i:this.m_root=i,a.height>c.height?(i.child2=a,e.child2=c,c.parent=e,e.aabb.combine(r.aabb,c.aabb),i.aabb.combine(e.aabb,a.aabb),e.height=1+u.max(r.height,c.height),i.height=1+u.max(e.height,a.height)):(i.child2=c,e.child2=a,a.parent=e,e.aabb.combine(r.aabb,a.aabb),i.aabb.combine(e.aabb,c.aabb),e.height=1+u.max(r.height,a.height),i.height=1+u.max(e.height,c.height)),i}if(s<-1){var l=r.child1,m=r.child2;return r.child1=e,r.parent=e.parent,e.parent=r,null!=r.parent?r.parent.child1==e?r.parent.child1=r:r.parent.child2=r:this.m_root=r,l.height>m.height?(r.child2=l,e.child1=m,m.parent=e,e.aabb.combine(i.aabb,m.aabb),r.aabb.combine(e.aabb,l.aabb),e.height=1+u.max(i.height,m.height),r.height=1+u.max(e.height,l.height)):(r.child2=m,e.child1=l,l.parent=e,e.aabb.combine(i.aabb,l.aabb),r.aabb.combine(e.aabb,m.aabb),e.height=1+u.max(i.height,l.height),r.height=1+u.max(e.height,m.height)),r}return e},m.prototype.getHeight=function(){return null==this.m_root?0:this.m_root.height},m.prototype.getAreaRatio=function(){if(null==this.m_root)return 0;for(var t,e=this.m_root.aabb.getPerimeter(),r=0,n=_.allocate().preorder();t=n.next();)t.height<0||(r+=t.aabb.getPerimeter());return _.release(n),r/e},m.prototype.computeHeight=function(t){var e;if((e=void 0!==t?this.m_nodes[t]:this.m_root).isLeaf())return 0;var r=ComputeHeight(e.child1),n=ComputeHeight(e.child2);return 1+u.max(r,n)},m.prototype.validateStructure=function(t){if(null!=t){t==this.m_root&&n&&o.assert(null==t.parent);var e=t.child1,r=t.child2;if(t.isLeaf())return n&&o.assert(null==e),n&&o.assert(null==r),void(n&&o.assert(0==t.height));n&&o.assert(e.parent==t),n&&o.assert(r.parent==t),this.validateStructure(e),this.validateStructure(r)}},m.prototype.validateMetrics=function(t){if(null!=t){var e=t.child1,r=t.child2;if(t.isLeaf())return n&&o.assert(null==e),n&&o.assert(null==r),void(n&&o.assert(0==t.height));var i=this.m_nodes[e].height,s=this.m_nodes[r].height,a=1+u.max(i,s);n&&o.assert(t.height==a);var l=new c;l.combine(e.aabb,r.aabb),n&&o.assert(c.areEqual(l,t.aabb)),this.validateMetrics(e),this.validateMetrics(r)}},m.prototype.validate=function(){ValidateStructure(this.m_root),ValidateMetrics(this.m_root),n&&o.assert(this.getHeight()==this.computeHeight())},m.prototype.getMaxBalance=function(){for(var t,e=0,r=_.allocate().preorder();t=r.next();)if(!(t.height<=1)){n&&o.assert(0==t.isLeaf());var i=u.abs(t.child2.height-t.child1.height);e=u.max(e,i)}return _.release(r),e},m.prototype.rebuildBottomUp=function(){for(var t,e=[],r=0,n=_.allocate().preorder();t=n.next();)t.height<0||(t.isLeaf()?(t.parent=null,e[r]=t,++r):this.freeNode(t));for(_.release(n);r>1;){for(var i=1/0,o=-1,s=-1,a=0;a<r;++a)for(var l=e[a].aabb,m=a+1;m<r;++m){var h=e[m].aabb,f=new c;f.combine(l,h);var p=f.getPerimeter();p<i&&(o=a,s=m,i=p)}var d=e[o],y=e[s],v=this.allocateNode();v.child1=d,v.child2=y,v.height=1+u.max(d.height,y.height),v.aabb.combine(d.aabb,y.aabb),v.parent=null,d.parent=v,y.parent=v,e[s]=e[r-1],e[o]=v,--r}this.m_root=e[0],this.validate()},m.prototype.shiftOrigin=function(t){for(var e,r=_.allocate().preorder();e=r.next();){var n=e.aabb;n.lowerBound.x-=t.x,n.lowerBound.y-=t.y,n.lowerBound.x-=t.x,n.lowerBound.y-=t.y}_.release(r)},m.prototype.query=function(t,e){n&&o.assert("function"==typeof e);var r=f.allocate();for(r.push(this.m_root);r.length>0;){var i=r.pop();if(null!=i)if(c.testOverlap(i.aabb,t))if(i.isLeaf()){if(0==e(i.id))return}else r.push(i.child1),r.push(i.child2)}f.release(r)},m.prototype.rayCast=function(t,e){n&&o.assert("function"==typeof e);var r=t.p1,i=t.p2,s=a.sub(i,r);n&&o.assert(s.lengthSquared()>0),s.normalize();var l=a.cross(1,s),m=a.abs(l),_=t.maxFraction,p=new c,d=a.wAdd(1-_,r,_,i);p.combinePoints(r,d);var y=f.allocate(),v=h.allocate();for(y.push(this.m_root);y.length>0;){var b=y.pop();if(null!=b&&0!=c.testOverlap(b.aabb,p)){var g=b.aabb.getCenter(),x=b.aabb.getExtents();if(!(u.abs(a.dot(l,a.sub(r,g)))-a.dot(m,x)>0))if(b.isLeaf()){v.p1=a.clone(t.p1),v.p2=a.clone(t.p2),v.maxFraction=_;var A=e(v,b.id);if(0==A)return;A>0&&(_=A,d=a.wAdd(1-_,r,_,i),p.combinePoints(r,d))}else y.push(b.child1),y.push(b.child2)}}f.release(y),h.release(v)};var h=new s({create:function(){return{}},release:function(t){}}),f=new s({create:function(){return[]},release:function(t){t.length=0}}),_=new s({create:function(){return new function(){var t=[],e=[];return{preorder:function(r){return t.length=0,t.push(r),e.length=0,e.push(0),this},next:function(){for(;t.length>0;){var r=t.length-1,n=t[r];if(0===e[r])return e[r]=1,n;if(1===e[r]&&(e[r]=2,n.child1))return t.push(n.child1),e.push(1),n.child1;if(2===e[r]&&(e[r]=3,n.child2))return t.push(n.child2),e.push(1),n.child2;t.pop(),e.pop()}},close:function(){t.length=0}}}},release:function(t){t.close()}})},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=h;var i=r(28),o=r(7),s=r(3),a=r(260),u=r(258),c=r(135),l=r(73),m={gravity:s.zero(),allowSleep:!0,warmStarting:!0,continuousPhysics:!0,subStepping:!1,blockSolve:!0,velocityIterations:8,positionIterations:3};function h(t){if(!(this instanceof h))return new h(t);t&&s.isValid(t)&&(t={gravity:t}),t=i(t,m),this.m_solver=new u(this),this.m_broadPhase=new a,this.m_contactList=null,this.m_contactCount=0,this.m_bodyList=null,this.m_bodyCount=0,this.m_jointList=null,this.m_jointCount=0,this.m_stepComplete=!0,this.m_allowSleep=t.allowSleep,this.m_gravity=s.clone(t.gravity),this.m_clearForces=!0,this.m_newFixture=!1,this.m_locked=!1,this.m_warmStarting=t.warmStarting,this.m_continuousPhysics=t.continuousPhysics,this.m_subStepping=t.subStepping,this.m_blockSolve=t.blockSolve,this.m_velocityIterations=t.velocityIterations,this.m_positionIterations=t.positionIterations,this.m_t=0,this.m_stepCount=0,this.addPair=this.createContact.bind(this)}h.prototype.getBodyList=function(){return this.m_bodyList},h.prototype.getJointList=function(){return this.m_jointList},h.prototype.getContactList=function(){return this.m_contactList},h.prototype.getBodyCount=function(){return this.m_bodyCount},h.prototype.getJointCount=function(){return this.m_jointCount},h.prototype.getContactCount=function(){return this.m_contactCount},h.prototype.setGravity=function(t){this.m_gravity=t},h.prototype.getGravity=function(){return this.m_gravity},h.prototype.isLocked=function(){return this.m_locked},h.prototype.setAllowSleeping=function(t){if(t!=this.m_allowSleep&&(this.m_allowSleep=t,0==this.m_allowSleep))for(var e=this.m_bodyList;e;e=e.m_next)e.setAwake(!0)},h.prototype.getAllowSleeping=function(){return this.m_allowSleep},h.prototype.setWarmStarting=function(t){this.m_warmStarting=t},h.prototype.getWarmStarting=function(){return this.m_warmStarting},h.prototype.setContinuousPhysics=function(t){this.m_continuousPhysics=t},h.prototype.getContinuousPhysics=function(){return this.m_continuousPhysics},h.prototype.setSubStepping=function(t){this.m_subStepping=t},h.prototype.getSubStepping=function(){return this.m_subStepping},h.prototype.setAutoClearForces=function(t){this.m_clearForces=t},h.prototype.getAutoClearForces=function(){return this.m_clearForces},h.prototype.clearForces=function(){for(var t=this.m_bodyList;t;t=t.getNext())t.m_force.setZero(),t.m_torque=0},h.prototype.queryAABB=function(t,e){n&&o.assert("function"==typeof e);var r=this.m_broadPhase;this.m_broadPhase.query(t,function(t){var n=r.getUserData(t);return e(n.fixture)})},h.prototype.rayCast=function(t,e,r){n&&o.assert("function"==typeof r);var i=this.m_broadPhase;this.m_broadPhase.rayCast({maxFraction:1,p1:t,p2:e},function(t,e){var n=i.getUserData(e),o=n.fixture,a=n.childIndex,u={};if(o.rayCast(u,t,a)){var c=u.fraction,l=s.add(s.mul(1-c,t.p1),s.mul(c,t.p2));return r(o,l,u.normal,c)}return t.maxFraction})},h.prototype.getProxyCount=function(){return this.m_broadPhase.getProxyCount()},h.prototype.getTreeHeight=function(){return this.m_broadPhase.getTreeHeight()},h.prototype.getTreeBalance=function(){return this.m_broadPhase.getTreeBalance()},h.prototype.getTreeQuality=function(){return this.m_broadPhase.getTreeQuality()},h.prototype.shiftOrigin=function(t){if(n&&o.assert(0==this.m_locked),!this.m_locked){for(var e=this.m_bodyList;e;e=e.m_next)e.m_xf.p.sub(t),e.m_sweep.c0.sub(t),e.m_sweep.c.sub(t);for(var r=this.m_jointList;r;r=r.m_next)r.shiftOrigin(t);this.m_broadPhase.shiftOrigin(t)}},h.prototype.createBody=function(t,e){if(n&&o.assert(0==this.isLocked()),this.isLocked())return null;t&&s.isValid(t)&&(t={position:t,angle:e});var r=new c(this,t);return r.m_prev=null,r.m_next=this.m_bodyList,this.m_bodyList&&(this.m_bodyList.m_prev=r),this.m_bodyList=r,++this.m_bodyCount,r},h.prototype.createDynamicBody=function(t,e){return t?s.isValid(t)&&(t={position:t,angle:e}):t={},t.type="dynamic",this.createBody(t)},h.prototype.createKinematicBody=function(t,e){return t?s.isValid(t)&&(t={position:t,angle:e}):t={},t.type="kinematic",this.createBody(t)},h.prototype.destroyBody=function(t){if(n&&o.assert(this.m_bodyCount>0),n&&o.assert(0==this.isLocked()),!this.isLocked()){if(t.m_destroyed)return!1;for(var e=t.m_jointList;e;){var r=e;e=e.next,this.publish("remove-joint",r.joint),this.destroyJoint(r.joint),t.m_jointList=e}t.m_jointList=null;for(var i=t.m_contactList;i;){var s=i;i=i.next,this.destroyContact(s.contact),t.m_contactList=i}t.m_contactList=null;for(var a=t.m_fixtureList;a;){var u=a;a=a.m_next,this.publish("remove-fixture",u),u.destroyProxies(this.m_broadPhase),t.m_fixtureList=a}return t.m_fixtureList=null,t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_bodyList&&(this.m_bodyList=t.m_next),t.m_destroyed=!0,--this.m_bodyCount,!0}},h.prototype.createJoint=function(t){if(n&&o.assert(!!t.m_bodyA),n&&o.assert(!!t.m_bodyB),n&&o.assert(0==this.isLocked()),this.isLocked())return null;if(t.m_prev=null,t.m_next=this.m_jointList,this.m_jointList&&(this.m_jointList.m_prev=t),this.m_jointList=t,++this.m_jointCount,t.m_edgeA.joint=t,t.m_edgeA.other=t.m_bodyB,t.m_edgeA.prev=null,t.m_edgeA.next=t.m_bodyA.m_jointList,t.m_bodyA.m_jointList&&(t.m_bodyA.m_jointList.prev=t.m_edgeA),t.m_bodyA.m_jointList=t.m_edgeA,t.m_edgeB.joint=t,t.m_edgeB.other=t.m_bodyA,t.m_edgeB.prev=null,t.m_edgeB.next=t.m_bodyB.m_jointList,t.m_bodyB.m_jointList&&(t.m_bodyB.m_jointList.prev=t.m_edgeB),t.m_bodyB.m_jointList=t.m_edgeB,0==t.m_collideConnected)for(var e=t.m_bodyB.getContactList();e;e=e.next)e.other==t.m_bodyA&&e.contact.flagForFiltering();return t},h.prototype.destroyJoint=function(t){if(n&&o.assert(0==this.isLocked()),!this.isLocked()){t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_jointList&&(this.m_jointList=t.m_next);var e=t.m_bodyA,r=t.m_bodyB;if(e.setAwake(!0),r.setAwake(!0),t.m_edgeA.prev&&(t.m_edgeA.prev.next=t.m_edgeA.next),t.m_edgeA.next&&(t.m_edgeA.next.prev=t.m_edgeA.prev),t.m_edgeA==e.m_jointList&&(e.m_jointList=t.m_edgeA.next),t.m_edgeA.prev=null,t.m_edgeA.next=null,t.m_edgeB.prev&&(t.m_edgeB.prev.next=t.m_edgeB.next),t.m_edgeB.next&&(t.m_edgeB.next.prev=t.m_edgeB.prev),t.m_edgeB==r.m_jointList&&(r.m_jointList=t.m_edgeB.next),t.m_edgeB.prev=null,t.m_edgeB.next=null,n&&o.assert(this.m_jointCount>0),--this.m_jointCount,0==t.m_collideConnected)for(var i=r.getContactList();i;)i.other==e&&i.contact.flagForFiltering(),i=i.next;this.publish("remove-joint",t)}};var f=new u.TimeStep;h.prototype.step=function(t,e,r){if((0|e)!==e&&(e=0),e=e||this.m_velocityIterations,r=r||this.m_positionIterations,this.m_stepCount++,this.m_newFixture&&(this.findNewContacts(),this.m_newFixture=!1),this.m_locked=!0,f.reset(t),f.velocityIterations=e,f.positionIterations=r,f.warmStarting=this.m_warmStarting,f.blockSolve=this.m_blockSolve,this.updateContacts(),this.m_stepComplete&&t>0){this.m_solver.solveWorld(f);for(var n=this.m_bodyList;n;n=n.getNext())0!=n.m_islandFlag&&(n.isStatic()||n.synchronizeFixtures());this.findNewContacts()}this.m_continuousPhysics&&t>0&&this.m_solver.solveWorldTOI(f),this.m_clearForces&&this.clearForces(),this.m_locked=!1},h.prototype.findNewContacts=function(){this.m_broadPhase.updatePairs(this.addPair)},h.prototype.createContact=function(t,e){var r=t.fixture,n=e.fixture,i=t.childIndex,o=e.childIndex,s=r.getBody(),a=n.getBody();if(s!=a){for(var u=a.getContactList();u;){if(u.other==s){var c=u.contact.getFixtureA(),m=u.contact.getFixtureB(),h=u.contact.getChildIndexA(),f=u.contact.getChildIndexB();if(c==r&&m==n&&h==i&&f==o)return;if(c==n&&m==r&&h==o&&f==i)return}u=u.next}if(0!=a.shouldCollide(s)&&0!=n.shouldCollide(r)){var _=l.create(r,i,n,o);null!=_&&(_.m_prev=null,null!=this.m_contactList&&(_.m_next=this.m_contactList,this.m_contactList.m_prev=_),this.m_contactList=_,++this.m_contactCount)}}},h.prototype.updateContacts=function(){for(var t,e=this.m_contactList;t=e;){e=t.getNext();var r=t.getFixtureA(),n=t.getFixtureB(),i=t.getChildIndexA(),o=t.getChildIndexB(),s=r.getBody(),a=n.getBody();if(t.m_filterFlag){if(0==a.shouldCollide(s)){this.destroyContact(t);continue}if(0==n.shouldCollide(r)){this.destroyContact(t);continue}t.m_filterFlag=!1}var u=s.isAwake()&&!s.isStatic(),c=a.isAwake()&&!a.isStatic();if(0!=u||0!=c){var l=r.m_proxies[i].proxyId,m=n.m_proxies[o].proxyId;0!=this.m_broadPhase.testOverlap(l,m)?t.update(this):this.destroyContact(t)}}},h.prototype.destroyContact=function(t){l.destroy(t,this),t.m_prev&&(t.m_prev.m_next=t.m_next),t.m_next&&(t.m_next.m_prev=t.m_prev),t==this.m_contactList&&(this.m_contactList=t.m_next),--this.m_contactCount},h.prototype._listeners=null,h.prototype.on=function(t,e){return"string"!=typeof t||"function"!=typeof e?this:(this._listeners||(this._listeners={}),this._listeners[t]||(this._listeners[t]=[]),this._listeners[t].push(e),this)},h.prototype.off=function(t,e){if("string"!=typeof t||"function"!=typeof e)return this;var r=this._listeners&&this._listeners[t];if(!r||!r.length)return this;var n=r.indexOf(e);return n>=0&&r.splice(n,1),this},h.prototype.publish=function(t,e,r,n){var i=this._listeners&&this._listeners[t];if(!i||!i.length)return 0;for(var o=0;o<i.length;o++)i[o].call(this,e,r,n);return i.length},h.prototype.beginContact=function(t){this.publish("begin-contact",t)},h.prototype.endContact=function(t){this.publish("end-contact",t)},h.prototype.preSolve=function(t,e){this.publish("pre-solve",t,e)},h.prototype.postSolve=function(t,e){this.publish("post-solve",t,e)}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=m;var i=r(7),o=r(28),s=r(4),a=r(3),u=r(62),c={userData:null,friction:.2,restitution:0,density:0,isSensor:!1,filterGroupIndex:0,filterCategoryBits:1,filterMaskBits:65535};function l(t,e){this.aabb=new u,this.fixture=t,this.childIndex=e,this.proxyId}function m(t,e,r){e.shape?(r=e,e=e.shape):"number"==typeof r&&(r={density:r}),r=o(r,c),this.m_body=t,this.m_friction=r.friction,this.m_restitution=r.restitution,this.m_density=r.density,this.m_isSensor=r.isSensor,this.m_filterGroupIndex=r.filterGroupIndex,this.m_filterCategoryBits=r.filterCategoryBits,this.m_filterMaskBits=r.filterMaskBits,this.m_shape=e,this.m_next=null,this.m_proxies=[],this.m_proxyCount=0;for(var n=this.m_shape.getChildCount(),i=0;i<n;++i)this.m_proxies[i]=new l(this,i);this.m_userData=r.userData}m.prototype.getType=function(){return this.m_shape.getType()},m.prototype.getShape=function(){return this.m_shape},m.prototype.isSensor=function(){return this.m_isSensor},m.prototype.setSensor=function(t){t!=this.m_isSensor&&(this.m_body.setAwake(!0),this.m_isSensor=t)},m.prototype.getUserData=function(){return this.m_userData},m.prototype.setUserData=function(t){this.m_userData=t},m.prototype.getBody=function(){return this.m_body},m.prototype.getNext=function(){return this.m_next},m.prototype.getDensity=function(){return this.m_density},m.prototype.setDensity=function(t){n&&i.assert(s.isFinite(t)&&t>=0),this.m_density=t},m.prototype.getFriction=function(){return this.m_friction},m.prototype.setFriction=function(t){this.m_friction=t},m.prototype.getRestitution=function(){return this.m_restitution},m.prototype.setRestitution=function(t){this.m_restitution=t},m.prototype.testPoint=function(t){return this.m_shape.testPoint(this.m_body.getTransform(),t)},m.prototype.rayCast=function(t,e,r){return this.m_shape.rayCast(t,e,this.m_body.getTransform(),r)},m.prototype.getMassData=function(t){this.m_shape.computeMass(t,this.m_density)},m.prototype.getAABB=function(t){return n&&i.assert(0<=t&&t<this.m_proxyCount),this.m_proxies[t].aabb},m.prototype.createProxies=function(t,e){n&&i.assert(0==this.m_proxyCount),this.m_proxyCount=this.m_shape.getChildCount();for(var r=0;r<this.m_proxyCount;++r){var o=this.m_proxies[r];this.m_shape.computeAABB(o.aabb,e,r),o.proxyId=t.createProxy(o.aabb,o)}},m.prototype.destroyProxies=function(t){for(var e=0;e<this.m_proxyCount;++e){var r=this.m_proxies[e];t.destroyProxy(r.proxyId),r.proxyId=null}this.m_proxyCount=0},m.prototype.synchronize=function(t,e,r){for(var n=0;n<this.m_proxyCount;++n){var i=this.m_proxies[n],o=new u,s=new u;this.m_shape.computeAABB(o,e,i.childIndex),this.m_shape.computeAABB(s,r,i.childIndex),i.aabb.combine(o,s);var c=a.sub(r.p,e.p);t.moveProxy(i.proxyId,i.aabb,c)}},m.prototype.setFilterData=function(t){this.m_filterGroupIndex=t.groupIndex,this.m_filterCategoryBits=t.categoryBits,this.m_filterMaskBits=t.maskBits,this.refilter()},m.prototype.getFilterGroupIndex=function(){return this.m_filterGroupIndex},m.prototype.getFilterCategoryBits=function(){return this.m_filterCategoryBits},m.prototype.getFilterMaskBits=function(){return this.m_filterMaskBits},m.prototype.refilter=function(){if(null!=this.m_body){for(var t=this.m_body.getContactList();t;){var e=t.contact,r=e.getFixtureA(),n=e.getFixtureB();r!=this&&n!=this||e.flagForFiltering(),t=t.next}var i=this.m_body.getWorld();if(null!=i)for(var o=i.m_broadPhase,s=0;s<this.m_proxyCount;++s)o.touchProxy(this.m_proxies[s].proxyId)}},m.prototype.shouldCollide=function(t){return t.m_filterGroupIndex==this.m_filterGroupIndex&&0!=t.m_filterGroupIndex?t.m_filterGroupIndex>0:0!=(t.m_filterMaskBits&this.m_filterCategoryBits)&&0!=(t.m_filterCategoryBits&this.m_filterMaskBits)}},function(t,e,r){e.internal={},e.Math=r(4),e.Vec2=r(3),e.Transform=r(14),e.Rot=r(12),e.AABB=r(62),e.Shape=r(56),e.Fixture=r(180),e.Body=r(135),e.Contact=r(73),e.Joint=r(46),e.World=r(179),e.Circle=r(106),e.Edge=r(105),e.Polygon=r(99),e.Chain=r(133),e.Box=r(256),r(255),r(254),e.internal.CollidePolygons=r(253),r(252),r(251),e.DistanceJoint=r(250),e.FrictionJoint=r(249),e.GearJoint=r(248),e.MotorJoint=r(247),e.MouseJoint=r(246),e.PrismaticJoint=r(175),e.PulleyJoint=r(245),e.RevoluteJoint=r(176),e.RopeJoint=r(244),e.WeldJoint=r(243),e.WheelJoint=r(242),e.internal.Sweep=r(40),e.internal.stats=r(134),e.internal.Manifold=r(78),e.internal.Distance=r(107),e.internal.TimeOfImpact=r(177),e.internal.DynamicTree=r(178),e.internal.Settings=r(13)},,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,,function(t,e,r){"use strict";Object.defineProperty(e,"__esModule",{value:!0}),e.WorldRenderer=void 0;var n=r(2),i=r(181),o=r(138);function s(t){return function(t){if(Array.isArray(t)){for(var e=0,r=new Array(t.length);e<t.length;e++)r[e]=t[e];return r}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function a(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function u(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c={game:null,pixelScale:20},l=function(){function t(e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t);var r=function(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){a(t,e,r[e])})}return t}({},c,e);this.game=r.game,this.pixelScale=r.pixelScale,this.lineRenderer=r.lineRenderer||new o.LineRenderer({game:r.game})}return function(t,e,r){e&&u(t.prototype,e),r&&u(t,r)}(t,[{key:"transformVertices",value:function(t,e){return t.map(function(t){var r=n.vec2.fromValues(t.x,t.y);return n.vec2.transformMat3(r,r,e),{x:r[0],y:r[1]}})}},{key:"circle",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:10,n=t.m_radius,o=[];o.push((0,i.Vec2)(0,0)),o.push((0,i.Vec2)(n,0));for(var s=1;s<r;s++){var a=n*Math.cos(2*Math.PI/r*s),u=n*Math.sin(2*Math.PI/r*s);o.push((0,i.Vec2)(a,u))}var c=this.transformVertices(o,e);o.length=0,c.forEach(function(t,e){o.push(t.x,t.y),e>0&&o.push(t.x,t.y)});var l=c[1];return o.push(l.x,l.y),o}},{key:"edge",value:function(t,e){var r=[],n=this.transformVertices([t.m_vertex1,t.m_vertex2],e);return n.forEach(function(t,e){r.push(t.x,t.y),e>0&&e<n.length-1&&r.push(t.x,t.y)}),r}},{key:"polygon",value:function(t,e){var r=[],n=this.transformVertices(t.m_vertices,e);n.forEach(function(t,e){r.push(t.x,t.y),e>0&&r.push(t.x,t.y)});var i=n[0];return r.push(i.x,i.y),r}},{key:"polygon",value:function(t,e){var r=[],n=this.transformVertices(t.m_vertices,e);n.forEach(function(t,e){r.push(t.x,t.y),e>0&&r.push(t.x,t.y)});var i=n[0];return r.push(i.x,i.y),r}},{key:"chain",value:function(t,e){var r=[],n=this.transformVertices(t.m_vertices,e);return n.forEach(function(t,e){r.push(t.x,t.y),e>0&&e<n.length-1&&r.push(t.x,t.y)}),r}},{key:"render",value:function(t,e,r){for(var i=[],o=t.getBodyList();o;o=o.getNext()){var a=o.getPosition(),u=o.getAngle(),c=n.mat3.fromScaling(n.mat3.create(),[this.pixelScale,this.pixelScale]);n.mat3.translate(c,c,[a.x,a.y]),n.mat3.rotate(c,c,u);for(var l=o.getFixtureList();l;l=l.getNext()){var m=l.getType(),h=l.getShape();"circle"===m&&i.push.apply(i,s(this.circle(h,c))),"edge"===m&&i.push.apply(i,s(this.edge(h,c))),"polygon"===m&&i.push.apply(i,s(this.polygon(h,c))),"chain"===m&&i.push.apply(i,s(this.chain(h,c)))}}this.lineRenderer.render(i,void 0)}}]),t}();e.WorldRenderer=l},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports=m;var n=r(28),i=r(22),o=r(13),s=r(4),a=r(3),u=(r(42),r(43),r(47),r(12)),c=(r(40),r(14),r(45),r(44),r(46));m.TYPE="wheel-joint",m._super=c,m.prototype=i(m._super.prototype);var l={enableMotor:!1,maxMotorTorque:0,motorSpeed:0,frequencyHz:2,dampingRatio:.7};function m(t,e,r,i,o){if(!(this instanceof m))return new m(t,e,r,i,o);t=n(t,l),c.call(this,t,e,r),this.m_type=m.TYPE,this.m_localAnchorA=e.getLocalPoint(i),this.m_localAnchorB=r.getLocalPoint(i),this.m_localXAxisA=e.getLocalVector(o||a.neo(1,0)),this.m_localYAxisA=a.cross(1,this.m_localXAxisA),this.m_mass=0,this.m_impulse=0,this.m_motorMass=0,this.m_motorImpulse=0,this.m_springMass=0,this.m_springImpulse=0,this.m_maxMotorTorque=t.maxMotorTorque,this.m_motorSpeed=t.motorSpeed,this.m_enableMotor=t.enableMotor,this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_bias=0,this.m_gamma=0,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_ax=a.zero(),this.m_ay=a.zero(),this.m_sAx,this.m_sBx,this.m_sAy,this.m_sBy}m.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},m.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},m.prototype.getLocalAxisA=function(){return this.m_localXAxisA},m.prototype.getJointTranslation=function(){var t=this.m_bodyA,e=this.m_bodyB,r=t.getWorldPoint(this.m_localAnchorA),n=e.getWorldPoint(this.m_localAnchorB)-r,i=t.getWorldVector(this.m_localXAxisA);return Dot(n,i)},m.prototype.getJointSpeed=function(){var t=this.m_bodyA.m_angularVelocity;return this.m_bodyB.m_angularVelocity-t},m.prototype.isMotorEnabled=function(){return this.m_enableMotor},m.prototype.enableMotor=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_enableMotor=t},m.prototype.setMotorSpeed=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_motorSpeed=t},m.prototype.getMotorSpeed=function(){return this.m_motorSpeed},m.prototype.setMaxMotorTorque=function(t){this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_maxMotorTorque=t},m.prototype.getMaxMotorTorque=function(){return this.m_maxMotorTorque},m.prototype.getMotorTorque=function(t){return t*this.m_motorImpulse},m.prototype.setSpringFrequencyHz=function(t){this.m_frequencyHz=t},m.prototype.getSpringFrequencyHz=function(){return this.m_frequencyHz},m.prototype.setSpringDampingRatio=function(t){this.m_dampingRatio=t},m.prototype.getSpringDampingRatio=function(){return this.m_dampingRatio},m.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},m.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},m.prototype.getReactionForce=function(t){return t*(this.m_impulse*this.m_ay+this.m_springImpulse*this.m_ax)},m.prototype.getReactionTorque=function(t){return t*this.m_motorImpulse},m.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_invMassA,r=this.m_invMassB,n=this.m_invIA,i=this.m_invIB,o=this.m_bodyA.c_position.c,c=this.m_bodyA.c_position.a,l=this.m_bodyA.c_velocity.v,m=this.m_bodyA.c_velocity.w,h=this.m_bodyB.c_position.c,f=this.m_bodyB.c_position.a,_=this.m_bodyB.c_velocity.v,p=this.m_bodyB.c_velocity.w,d=u.neo(c),y=u.neo(f),v=u.mul(d,a.sub(this.m_localAnchorA,this.m_localCenterA)),b=u.mul(y,a.sub(this.m_localAnchorB,this.m_localCenterB));if((w=a.zero()).wAdd(1,h,1,b),w.wSub(1,o,1,v),this.m_ay=u.mul(d,this.m_localYAxisA),this.m_sAy=a.cross(a.add(w,v),this.m_ay),this.m_sBy=a.cross(b,this.m_ay),this.m_mass=e+r+n*this.m_sAy*this.m_sAy+i*this.m_sBy*this.m_sBy,this.m_mass>0&&(this.m_mass=1/this.m_mass),this.m_springMass=0,this.m_bias=0,this.m_gamma=0,this.m_frequencyHz>0){this.m_ax=u.mul(d,this.m_localXAxisA),this.m_sAx=a.cross(a.add(w,v),this.m_ax),this.m_sBx=a.cross(b,this.m_ax);var g=e+r+n*this.m_sAx*this.m_sAx+i*this.m_sBx*this.m_sBx;if(g>0){this.m_springMass=1/g;var x=a.dot(w,this.m_ax),A=2*s.PI*this.m_frequencyHz,w=2*this.m_springMass*this.m_dampingRatio*A,B=this.m_springMass*A*A,E=t.dt;this.m_gamma=E*(w+E*B),this.m_gamma>0&&(this.m_gamma=1/this.m_gamma),this.m_bias=x*E*B*this.m_gamma,this.m_springMass=g+this.m_gamma,this.m_springMass>0&&(this.m_springMass=1/this.m_springMass)}}else this.m_springImpulse=0;if(this.m_enableMotor?(this.m_motorMass=n+i,this.m_motorMass>0&&(this.m_motorMass=1/this.m_motorMass)):(this.m_motorMass=0,this.m_motorImpulse=0),t.warmStarting){this.m_impulse*=t.dtRatio,this.m_springImpulse*=t.dtRatio,this.m_motorImpulse*=t.dtRatio;var M=a.wAdd(this.m_impulse,this.m_ay,this.m_springImpulse,this.m_ax),S=this.m_impulse*this.m_sAy+this.m_springImpulse*this.m_sAx+this.m_motorImpulse,T=this.m_impulse*this.m_sBy+this.m_springImpulse*this.m_sBx+this.m_motorImpulse;l.wSub(this.m_invMassA,M),m-=this.m_invIA*S,_.wAdd(this.m_invMassB,M),p+=this.m_invIB*T}else this.m_impulse=0,this.m_springImpulse=0,this.m_motorImpulse=0;this.m_bodyA.c_velocity.v.set(l),this.m_bodyA.c_velocity.w=m,this.m_bodyB.c_velocity.v.set(_),this.m_bodyB.c_velocity.w=p},m.prototype.solveVelocityConstraints=function(t){var e=this.m_invMassA,r=this.m_invMassB,n=this.m_invIA,i=this.m_invIB,o=this.m_bodyA.c_velocity.v,u=this.m_bodyA.c_velocity.w,c=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,m=a.dot(this.m_ax,c)-a.dot(this.m_ax,o)+this.m_sBx*l-this.m_sAx*u,h=-this.m_springMass*(m+this.m_bias+this.m_gamma*this.m_springImpulse);this.m_springImpulse+=h;var f=a.zero().wSet(h,this.m_ax),_=h*this.m_sAx,p=h*this.m_sBx;o.wSub(e,f),u-=n*_,c.wAdd(r,f);m=(l+=i*p)-u-this.m_motorSpeed,h=-this.m_motorMass*m;var d=this.m_motorImpulse,y=t.dt*this.m_maxMotorTorque;this.m_motorImpulse=s.clamp(this.m_motorImpulse+h,-y,y),u-=n*(h=this.m_motorImpulse-d),l+=i*h;m=a.dot(this.m_ay,c)-a.dot(this.m_ay,o)+this.m_sBy*l-this.m_sAy*u,h=-this.m_mass*m;this.m_impulse+=h;f=a.zero().wSet(h,this.m_ay),_=h*this.m_sAy,p=h*this.m_sBy;o.wSub(e,f),u-=n*_,c.wAdd(r,f),l+=i*p,this.m_bodyA.c_velocity.v.set(o),this.m_bodyA.c_velocity.w=u,this.m_bodyB.c_velocity.v.set(c),this.m_bodyB.c_velocity.w=l},m.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,i=this.m_bodyB.c_position.a,c=u.neo(r),l=u.neo(i),m=u.mul(c,a.sub(this.m_localAnchorA,this.m_localCenterA)),h=u.mul(l,a.sub(this.m_localAnchorB,this.m_localCenterB)),f=a.zero();f.wAdd(1,n,1,h),f.wSub(1,e,1,m);var _,p=u.mul(c,this.m_localYAxisA),d=a.cross(a.add(f,m),p),y=a.cross(h,p),v=a.dot(f,p),b=this.m_invMassA+this.m_invMassB+this.m_invIA*this.m_sAy*this.m_sAy+this.m_invIB*this.m_sBy*this.m_sBy;_=0!=b?-v/b:0;var g=a.zero().wSet(_,p),x=_*d,A=_*y;return e.wSub(this.m_invMassA,g),r-=this.m_invIA*x,n.wAdd(this.m_invMassB,g),i+=this.m_invIB*A,this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.set(n),this.m_bodyB.c_position.a=i,s.abs(v)<=o.linearSlop}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports=f;var n=r(28),i=r(22),o=r(13),s=r(4),a=r(3),u=r(42),c=(r(43),r(47)),l=r(12),m=(r(40),r(14),r(45),r(44),r(46));f.TYPE="weld-joint",f._super=m,f.prototype=i(f._super.prototype);var h={frequencyHz:0,dampingRatio:0};function f(t,e,r,i){if(!(this instanceof f))return new f(t,e,r,i);t=n(t,h),m.call(this,t,e,r),this.m_type=f.TYPE,this.m_localAnchorA=e.getLocalPoint(i),this.m_localAnchorB=r.getLocalPoint(i),this.m_referenceAngle=r.getAngle()-e.getAngle(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=u(),this.m_bias=0,this.m_gamma=0,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass=new c}f.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},f.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},f.prototype.getReferenceAngle=function(){return this.m_referenceAngle},f.prototype.setFrequency=function(t){this.m_frequencyHz=t},f.prototype.getFrequency=function(){return this.m_frequencyHz},f.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},f.prototype.getDampingRatio=function(){return this.m_dampingRatio},f.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},f.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},f.prototype.getReactionForce=function(t){return t*a.neo(this.m_impulse.x,this.m_impulse.y)},f.prototype.getReactionTorque=function(t){return t*this.m_impulse.z},f.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,u=this.m_bodyB.c_velocity.w,m=l.neo(e),h=l.neo(i);this.m_rA=l.mul(m,a.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=l.mul(h,a.sub(this.m_localAnchorB,this.m_localCenterB));var f=this.m_invMassA,_=this.m_invMassB,p=this.m_invIA,d=this.m_invIB,y=new c;if(y.ex.x=f+_+this.m_rA.y*this.m_rA.y*p+this.m_rB.y*this.m_rB.y*d,y.ey.x=-this.m_rA.y*this.m_rA.x*p-this.m_rB.y*this.m_rB.x*d,y.ez.x=-this.m_rA.y*p-this.m_rB.y*d,y.ex.y=y.ey.x,y.ey.y=f+_+this.m_rA.x*this.m_rA.x*p+this.m_rB.x*this.m_rB.x*d,y.ez.y=this.m_rA.x*p+this.m_rB.x*d,y.ex.z=y.ez.x,y.ey.z=y.ez.y,y.ez.z=p+d,this.m_frequencyHz>0){y.getInverse22(this.m_mass);var v=p+d,b=v>0?1/v:0,g=i-e-this.m_referenceAngle,x=2*s.PI*this.m_frequencyHz,A=2*b*this.m_dampingRatio*x,w=b*x*x,B=t.dt;this.m_gamma=B*(A+B*w),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=g*B*w*this.m_gamma,v+=this.m_gamma,this.m_mass.ez.z=0!=v?1/v:0}else 0==y.ez.z?(y.getInverse22(this.m_mass),this.m_gamma=0,this.m_bias=0):(y.getSymInverse33(this.m_mass),this.m_gamma=0,this.m_bias=0);if(t.warmStarting){this.m_impulse.mul(t.dtRatio);var E=a.neo(this.m_impulse.x,this.m_impulse.y);r.wSub(f,E),n-=p*(a.cross(this.m_rA,E)+this.m_impulse.z),o.wAdd(_,E),u+=d*(a.cross(this.m_rB,E)+this.m_impulse.z)}else this.m_impulse.setZero();this.m_bodyA.c_velocity.v=r,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=u},f.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,i=this.m_bodyB.c_velocity.w,o=this.m_invMassA,s=this.m_invMassB,l=this.m_invIA,m=this.m_invIB;if(this.m_frequencyHz>0){var h=i-r,f=-this.m_mass.ez.z*(h+this.m_bias+this.m_gamma*this.m_impulse.z);this.m_impulse.z+=f,r-=l*f,i+=m*f,(d=a.zero()).wAdd(1,n,1,a.cross(i,this.m_rB)),d.wSub(1,e,1,a.cross(r,this.m_rA));var _=a.neg(c.mul(this.m_mass,d));this.m_impulse.x+=_.x,this.m_impulse.y+=_.y;var p=a.clone(_);e.wSub(o,p),r-=l*a.cross(this.m_rA,p),n.wAdd(s,p),i+=m*a.cross(this.m_rB,p)}else{var d;(d=a.zero()).wAdd(1,n,1,a.cross(i,this.m_rB)),d.wSub(1,e,1,a.cross(r,this.m_rA));h=i-r;var y=u(d.x,d.y,h),v=u.neg(c.mul(this.m_mass,y));this.m_impulse.add(v);p=a.neo(v.x,v.y);e.wSub(o,p),r-=l*(a.cross(this.m_rA,p)+v.z),n.wAdd(s,p),i+=m*(a.cross(this.m_rB,p)+v.z)}this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=i},f.prototype.solvePositionConstraints=function(t){var e,r,n=this.m_bodyA.c_position.c,i=this.m_bodyA.c_position.a,m=this.m_bodyB.c_position.c,h=this.m_bodyB.c_position.a,f=l.neo(i),_=l.neo(h),p=this.m_invMassA,d=this.m_invMassB,y=this.m_invIA,v=this.m_invIB,b=l.mul(f,a.sub(this.m_localAnchorA,this.m_localCenterA)),g=l.mul(_,a.sub(this.m_localAnchorB,this.m_localCenterB)),x=new c;if(x.ex.x=p+d+b.y*b.y*y+g.y*g.y*v,x.ey.x=-b.y*b.x*y-g.y*g.x*v,x.ez.x=-b.y*y-g.y*v,x.ex.y=x.ey.x,x.ey.y=p+d+b.x*b.x*y+g.x*g.x*v,x.ez.y=b.x*y+g.x*v,x.ex.z=x.ez.x,x.ey.z=x.ez.y,x.ez.z=y+v,this.m_frequencyHz>0){(w=a.zero()).wAdd(1,m,1,g),w.wSub(1,n,1,b),e=w.length(),r=0;var A=a.neg(x.solve22(w));n.wSub(p,A),i-=y*a.cross(b,A),m.wAdd(d,A),h+=v*a.cross(g,A)}else{var w;(w=a.zero()).wAdd(1,m,1,g),w.wSub(1,n,1,b);var B=h-i-this.m_referenceAngle;e=w.length(),r=s.abs(B);var E=u(w.x,w.y,B),M=u();if(x.ez.z>0)M=u.neg(x.solve33(E));else{var S=a.neg(x.solve22(w));M.set(S.x,S.y,0)}A=a.neo(M.x,M.y);n.wSub(p,A),i-=y*(a.cross(b,A)+M.z),m.wAdd(d,A),h+=v*(a.cross(g,A)+M.z)}return this.m_bodyA.c_position.c=n,this.m_bodyA.c_position.a=i,this.m_bodyB.c_position.c=m,this.m_bodyB.c_position.a=h,e<=o.linearSlop&&r<=o.angularSlop}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports=h;var n=r(28),i=r(22),o=r(13),s=r(4),a=r(3),u=(r(42),r(43),r(47),r(12)),c=(r(40),r(14),r(45),r(44),r(46)),l=0;h.TYPE="rope-joint",h._super=c,h.prototype=i(h._super.prototype);var m={maxLength:0};function h(t,e,r,i){if(!(this instanceof h))return new h(t,e,r,i);t=n(t,m),c.call(this,t,e,r),this.m_type=h.TYPE,this.m_localAnchorA=t.localAnchorA||e.getLocalPoint(i),this.m_localAnchorB=t.localAnchorB||r.getLocalPoint(i),this.m_maxLength=t.maxLength,this.m_mass=0,this.m_impulse=0,this.m_length=0,this.m_state=l,this.m_u,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}h.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},h.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},h.prototype.setMaxLength=function(t){this.m_maxLength=t},h.prototype.getMaxLength=function(){return this.m_maxLength},h.prototype.getLimitState=function(){return this.m_state},h.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},h.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},h.prototype.getReactionForce=function(t){return t*this.m_impulse*this.m_u},h.prototype.getReactionTorque=function(t){return 0},h.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,s=this.m_bodyB.c_position.c,c=this.m_bodyB.c_position.a,m=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,f=u.neo(r),_=u.neo(c);this.m_rA=u.mulSub(f,this.m_localAnchorA,this.m_localCenterA),this.m_rB=u.mulSub(_,this.m_localAnchorB,this.m_localCenterB),this.m_u=a.zero(),this.m_u.wAdd(1,s,1,this.m_rB),this.m_u.wSub(1,e,1,this.m_rA),this.m_length=this.m_u.length();var p=this.m_length-this.m_maxLength;if(this.m_state=p>0?2:l,!(this.m_length>o.linearSlop))return this.m_u.setZero(),this.m_mass=0,void(this.m_impulse=0);this.m_u.mul(1/this.m_length);var d=a.cross(this.m_rA,this.m_u),y=a.cross(this.m_rB,this.m_u),v=this.m_invMassA+this.m_invIA*d*d+this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=0!=v?1/v:0,t.warmStarting){this.m_impulse*=t.dtRatio;var b=a.mul(this.m_impulse,this.m_u);n.wSub(this.m_invMassA,b),i-=this.m_invIA*a.cross(this.m_rA,b),m.wAdd(this.m_invMassB,b),h+=this.m_invIB*a.cross(this.m_rB,b)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(n),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(m),this.m_bodyB.c_velocity.w=h},h.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,i=this.m_bodyB.c_velocity.w,o=a.addCross(e,r,this.m_rA),u=a.addCross(n,i,this.m_rB),c=this.m_length-this.m_maxLength,l=a.dot(this.m_u,a.sub(u,o));c<0&&(l+=t.inv_dt*c);var m=-this.m_mass*l,h=this.m_impulse;this.m_impulse=s.min(0,this.m_impulse+m),m=this.m_impulse-h;var f=a.mul(m,this.m_u);e.wSub(this.m_invMassA,f),r-=this.m_invIA*a.cross(this.m_rA,f),n.wAdd(this.m_invMassB,f),i+=this.m_invIB*a.cross(this.m_rB,f),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=i},h.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,i=this.m_bodyB.c_position.a,c=u.neo(r),l=u.neo(i),m=u.mulSub(c,this.m_localAnchorA,this.m_localCenterA),h=u.mulSub(l,this.m_localAnchorB,this.m_localCenterB),f=a.zero();f.wAdd(1,n,1,h),f.wSub(1,e,1,m);var _=f.normalize(),p=_-this.m_maxLength;p=s.clamp(p,0,o.maxLinearCorrection);var d=-this.m_mass*p,y=a.mul(d,f);return e.wSub(this.m_invMassA,y),r-=this.m_invIA*a.cross(m,y),n.wAdd(this.m_invMassB,y),i+=this.m_invIB*a.cross(h,y),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.set(n),this.m_bodyB.c_position.a=i,_-this.m_maxLength<o.linearSlop}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=_;var i=r(7),o=r(28),s=r(22),a=r(13),u=r(4),c=r(3),l=r(42),m=(r(43),r(47),r(12)),h=(r(40),r(14),r(45),r(44),r(46));_.TYPE="pulley-joint",_.MIN_PULLEY_LENGTH=2,_._super=h,_.prototype=s(_._super.prototype);var f={collideConnected:!0};function _(t,e,r,s,a,l,m,p){if(!(this instanceof _))return new _(t,e,r,s,a,l,m,p);t=o(t,f),h.call(this,t,e,r),this.m_type=_.TYPE,this.m_groundAnchorA=s,this.m_groundAnchorB=a,this.m_localAnchorA=e.getLocalPoint(l),this.m_localAnchorB=r.getLocalPoint(m),this.m_lengthA=c.distance(l,s),this.m_lengthB=c.distance(m,a),this.m_ratio=t.ratio||p,n&&i.assert(p>u.EPSILON),this.m_constant=this.m_lengthA+this.m_ratio*this.m_lengthB,this.m_impulse=0,this.m_uA,this.m_uB,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}_.prototype.getGroundAnchorA=function(){return this.m_groundAnchorA},_.prototype.getGroundAnchorB=function(){return this.m_groundAnchorB},_.prototype.getLengthA=function(){return this.m_lengthA},_.prototype.getLengthB=function(){return this.m_lengthB},_.prototype.getRatio=function(){return this.m_ratio},_.prototype.getCurrentLengthA=function(){var t=this.m_bodyA.getWorldPoint(this.m_localAnchorA),e=this.m_groundAnchorA;return c.distance(t,e)},_.prototype.getCurrentLengthB=function(){var t=this.m_bodyB.getWorldPoint(this.m_localAnchorB),e=this.m_groundAnchorB;return c.distance(t,e)},_.prototype.shiftOrigin=function(t){this.m_groundAnchorA-=t,this.m_groundAnchorB-=t},_.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(t){return l.mul(t*this.m_impulse,this.m_uB)},_.prototype.getReactionTorque=function(t){return 0},_.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,u=this.m_bodyB.c_velocity.v,l=this.m_bodyB.c_velocity.w,h=m.neo(r),f=m.neo(s);this.m_rA=m.mul(h,c.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=m.mul(f,c.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_uA=c.sub(c.add(e,this.m_rA),this.m_groundAnchorA),this.m_uB=c.sub(c.add(o,this.m_rB),this.m_groundAnchorB);var _=this.m_uA.length(),p=this.m_uB.length();_>10*a.linearSlop?this.m_uA.mul(1/_):this.m_uA.setZero(),p>10*a.linearSlop?this.m_uB.mul(1/p):this.m_uB.setZero();var d=c.cross(this.m_rA,this.m_uA),y=c.cross(this.m_rB,this.m_uB),v=this.m_invMassA+this.m_invIA*d*d,b=this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=v+this.m_ratio*this.m_ratio*b,this.m_mass>0&&(this.m_mass=1/this.m_mass),t.warmStarting){this.m_impulse*=t.dtRatio;var g=c.mul(-this.m_impulse,this.m_uA),x=c.mul(-this.m_ratio*this.m_impulse,this.m_uB);n.wAdd(this.m_invMassA,g),i+=this.m_invIA*c.cross(this.m_rA,g),u.wAdd(this.m_invMassB,x),l+=this.m_invIB*c.cross(this.m_rB,x)}else this.m_impulse=0;this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=u,this.m_bodyB.c_velocity.w=l},_.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,i=this.m_bodyB.c_velocity.w,o=c.add(e,c.cross(r,this.m_rA)),s=c.add(n,c.cross(i,this.m_rB)),a=-c.dot(this.m_uA,o)-this.m_ratio*c.dot(this.m_uB,s),u=-this.m_mass*a;this.m_impulse+=u;var l=c.zero().wSet(-u,this.m_uA),m=c.zero().wSet(-this.m_ratio*u,this.m_uB);e.wAdd(this.m_invMassA,l),r+=this.m_invIA*c.cross(this.m_rA,l),n.wAdd(this.m_invMassB,m),i+=this.m_invIB*c.cross(this.m_rB,m),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=i},_.prototype.solvePositionConstraints=function(t){var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,i=this.m_bodyB.c_position.a,o=m.neo(r),s=m.neo(i),l=m.mul(o,c.sub(this.m_localAnchorA,this.m_localCenterA)),h=m.mul(s,c.sub(this.m_localAnchorB,this.m_localCenterB)),f=c.sub(c.add(e,this.m_rA),this.m_groundAnchorA),_=c.sub(c.add(n,this.m_rB),this.m_groundAnchorB),p=f.length(),d=_.length();p>10*a.linearSlop?f.mul(1/p):f.setZero(),d>10*a.linearSlop?_.mul(1/d):_.setZero();var y=c.cross(l,f),v=c.cross(h,_),b=this.m_invMassA+this.m_invIA*y*y,g=this.m_invMassB+this.m_invIB*v*v,x=b+this.m_ratio*this.m_ratio*g;x>0&&(x=1/x);var A=this.m_constant-p-this.m_ratio*d,w=u.abs(A),B=-x*A,E=c.zero().wSet(-B,f),M=c.zero().wSet(-this.m_ratio*B,_);return e.wAdd(this.m_invMassA,E),r+=this.m_invIA*c.cross(l,E),n.wAdd(this.m_invMassB,M),i+=this.m_invIB*c.cross(h,M),this.m_bodyA.c_position.c=e,this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c=n,this.m_bodyB.c_position.a=i,w<a.linearSlop}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=_;var i=r(7),o=r(28),s=r(22),a=r(4),u=r(3),c=(r(42),r(43)),l=(r(47),r(12)),m=(r(40),r(14)),h=(r(45),r(44),r(46));_.TYPE="mouse-joint",_._super=h,_.prototype=s(_._super.prototype);var f={maxForce:0,frequencyHz:5,dampingRatio:.7};function _(t,e,r,s){if(!(this instanceof _))return new _(t,e,r,s);t=o(t,f),h.call(this,t,e,r),this.m_type=_.TYPE,n&&i.assert(a.isFinite(t.maxForce)&&t.maxForce>=0),n&&i.assert(a.isFinite(t.frequencyHz)&&t.frequencyHz>=0),n&&i.assert(a.isFinite(t.dampingRatio)&&t.dampingRatio>=0),this.m_targetA=u.clone(s),this.m_localAnchorB=m.mulT(this.m_bodyB.getTransform(),this.m_targetA),this.m_maxForce=t.maxForce,this.m_impulse=u.zero(),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_beta=0,this.m_gamma=0,this.m_rB=u.zero(),this.m_localCenterB=u.zero(),this.m_invMassB=0,this.m_invIB=0,this.mass=new c,this.m_C=u.zero()}_.prototype.setTarget=function(t){0==this.m_bodyB.isAwake()&&this.m_bodyB.setAwake(!0),this.m_targetA=u.clone(t)},_.prototype.getTarget=function(){return this.m_targetA},_.prototype.setMaxForce=function(t){this.m_maxForce=t},_.getMaxForce=function(){return this.m_maxForce},_.prototype.setFrequency=function(t){this.m_frequencyHz=t},_.prototype.getFrequency=function(){return this.m_frequencyHz},_.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},_.prototype.getDampingRatio=function(){return this.m_dampingRatio},_.prototype.getAnchorA=function(){return u.clone(this.m_targetA)},_.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},_.prototype.getReactionForce=function(t){return u.mul(t,this.m_impulse)},_.prototype.getReactionTorque=function(t){return 0*t},_.prototype.shiftOrigin=function(t){this.m_targetA.sub(t)},_.prototype.initVelocityConstraints=function(t){this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyB.c_position,r=this.m_bodyB.c_velocity,o=e.c,s=e.a,m=r.v,h=r.w,f=l.neo(s),_=this.m_bodyB.getMass(),p=2*a.PI*this.m_frequencyHz,d=2*_*this.m_dampingRatio*p,y=_*(p*p),v=t.dt;n&&i.assert(d+v*y>a.EPSILON),this.m_gamma=v*(d+v*y),0!=this.m_gamma&&(this.m_gamma=1/this.m_gamma),this.m_beta=v*y*this.m_gamma,this.m_rB=l.mul(f,u.sub(this.m_localAnchorB,this.m_localCenterB));var b=new c;b.ex.x=this.m_invMassB+this.m_invIB*this.m_rB.y*this.m_rB.y+this.m_gamma,b.ex.y=-this.m_invIB*this.m_rB.x*this.m_rB.y,b.ey.x=b.ex.y,b.ey.y=this.m_invMassB+this.m_invIB*this.m_rB.x*this.m_rB.x+this.m_gamma,this.m_mass=b.getInverse(),this.m_C.set(o),this.m_C.wAdd(1,this.m_rB,-1,this.m_targetA),this.m_C.mul(this.m_beta),h*=.98,t.warmStarting?(this.m_impulse.mul(t.dtRatio),m.wAdd(this.m_invMassB,this.m_impulse),h+=this.m_invIB*u.cross(this.m_rB,this.m_impulse)):this.m_impulse.setZero(),r.v.set(m),r.w=h},_.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyB.c_velocity,r=u.clone(e.v),n=e.w,i=u.cross(n,this.m_rB);i.add(r),i.wAdd(1,this.m_C,this.m_gamma,this.m_impulse),i.neg();var o=c.mul(this.m_mass,i),s=u.clone(this.m_impulse);this.m_impulse.add(o);var a=t.dt*this.m_maxForce;this.m_impulse.clamp(a),o=u.sub(this.m_impulse,s),r.wAdd(this.m_invMassB,o),n+=this.m_invIB*u.cross(this.m_rB,o),e.v.set(r),e.w=n},_.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=f;var i=r(7),o=r(28),s=r(22),a=(r(13),r(4)),u=r(3),c=(r(42),r(43)),l=(r(47),r(12)),m=(r(40),r(14),r(45),r(44),r(46));f.TYPE="motor-joint",f._super=m,f.prototype=s(f._super.prototype);var h={maxForce:1,maxTorque:1,correctionFactor:.3};function f(t,e,r){if(!(this instanceof f))return new f(t,e,r);t=o(t,h),m.call(this,t,e,r),this.m_type=f.TYPE;var n=r.getPosition();this.m_linearOffset=e.getLocalPoint(n);var i=e.getAngle(),s=r.getAngle();this.m_angularOffset=s-i,this.m_linearImpulse=u.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_correctionFactor=t.correctionFactor,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_linearError,this.m_angularError,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}f.prototype.setMaxForce=function(t){n&&i.assert(IsValid(t)&&t>=0),this.m_maxForce=t},f.prototype.getMaxForce=function(){return this.m_maxForce},f.prototype.setMaxTorque=function(t){n&&i.assert(IsValid(t)&&t>=0),this.m_maxTorque=t},f.prototype.getMaxTorque=function(){return this.m_maxTorque},f.prototype.setCorrectionFactor=function(t){n&&i.assert(IsValid(t)&&0<=t&&t<=1),this.m_correctionFactor=t},f.prototype.getCorrectionFactor=function(){return this.m_correctionFactor},f.prototype.setLinearOffset=function(t){t.x==this.m_linearOffset.x&&t.y==this.m_linearOffset.y||(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_linearOffset=t)},f.prototype.getLinearOffset=function(){return this.m_linearOffset},f.prototype.setAngularOffset=function(t){t!=this.m_angularOffset&&(this.m_bodyA.setAwake(!0),this.m_bodyB.setAwake(!0),this.m_angularOffset=t)},f.prototype.getAngularOffset=function(){return this.m_angularOffset},f.prototype.getAnchorA=function(){return this.m_bodyA.getPosition()},f.prototype.getAnchorB=function(){return this.m_bodyB.getPosition()},f.prototype.getReactionForce=function(t){return t*this.m_linearImpulse},f.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},f.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,o=this.m_bodyB.c_position.c,s=this.m_bodyB.c_position.a,a=this.m_bodyB.c_velocity.v,m=this.m_bodyB.c_velocity.w,h=l.neo(r),f=l.neo(s);this.m_rA=l.mul(h,u.neg(this.m_localCenterA)),this.m_rB=l.mul(f,u.neg(this.m_localCenterB));var _=this.m_invMassA,p=this.m_invMassB,d=this.m_invIA,y=this.m_invIB,v=new c;if(v.ex.x=_+p+d*this.m_rA.y*this.m_rA.y+y*this.m_rB.y*this.m_rB.y,v.ex.y=-d*this.m_rA.x*this.m_rA.y-y*this.m_rB.x*this.m_rB.y,v.ey.x=v.ex.y,v.ey.y=_+p+d*this.m_rA.x*this.m_rA.x+y*this.m_rB.x*this.m_rB.x,this.m_linearMass=v.getInverse(),this.m_angularMass=d+y,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),this.m_linearError=u.zero(),this.m_linearError.wAdd(1,o,1,this.m_rB),this.m_linearError.wSub(1,e,1,this.m_rA),this.m_linearError.sub(l.mul(h,this.m_linearOffset)),this.m_angularError=s-r-this.m_angularOffset,t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var b=u.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);n.wSub(_,b),i-=d*(u.cross(this.m_rA,b)+this.m_angularImpulse),a.wAdd(p,b),m+=y*(u.cross(this.m_rB,b)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=n,this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v=a,this.m_bodyB.c_velocity.w=m},f.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,i=this.m_bodyB.c_velocity.w,o=this.m_invMassA,s=this.m_invMassB,l=this.m_invIA,m=this.m_invIB,h=t.dt,f=t.inv_dt,_=i-r+f*this.m_correctionFactor*this.m_angularError,p=-this.m_angularMass*_,d=this.m_angularImpulse,y=h*this.m_maxTorque;this.m_angularImpulse=a.clamp(this.m_angularImpulse+p,-y,y),r-=l*(p=this.m_angularImpulse-d),i+=m*p,(_=u.zero()).wAdd(1,n,1,u.cross(i,this.m_rB)),_.wSub(1,e,1,u.cross(r,this.m_rA)),_.wAdd(f*this.m_correctionFactor,this.m_linearError);p=u.neg(c.mul(this.m_linearMass,_)),d=u.clone(this.m_linearImpulse);this.m_linearImpulse.add(p);y=h*this.m_maxForce;this.m_linearImpulse.clamp(y),p=u.sub(this.m_linearImpulse,d),e.wSub(o,p),r-=l*u.cross(this.m_rA,p),n.wAdd(s,p),i+=m*u.cross(this.m_rB,p),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=i},f.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=p;var i=r(7),o=r(28),s=r(22),a=r(13),u=r(4),c=r(3),l=(r(42),r(43),r(47),r(12)),m=(r(40),r(14),r(45),r(44),r(46)),h=r(176),f=r(175);p.TYPE="gear-joint",p._super=m,p.prototype=s(p._super.prototype);var _={ratio:1};function p(t,e,r,s,a,u){if(!(this instanceof p))return new p(t,e,r,s,a,u);var d,y;t=o(t,_),m.call(this,t,e,r),this.m_type=p.TYPE,n&&i.assert(s.m_type==h.TYPE||s.m_type==f.TYPE),n&&i.assert(a.m_type==h.TYPE||a.m_type==f.TYPE),this.m_joint1=s,this.m_joint2=a,this.m_type1=this.m_joint1.getType(),this.m_type2=this.m_joint2.getType(),this.m_bodyC=this.m_joint1.getBodyA(),this.m_bodyA=this.m_joint1.getBodyB();var v=this.m_bodyA.m_xf,b=this.m_bodyA.m_sweep.a,g=this.m_bodyC.m_xf,x=this.m_bodyC.m_sweep.a;if(this.m_type1==h.TYPE){var A=s;this.m_localAnchorC=A.m_localAnchorA,this.m_localAnchorA=A.m_localAnchorB,this.m_referenceAngleA=A.m_referenceAngle,this.m_localAxisC=c.zero(),d=b-x-this.m_referenceAngleA}else{var w=s;this.m_localAnchorC=w.m_localAnchorA,this.m_localAnchorA=w.m_localAnchorB,this.m_referenceAngleA=w.m_referenceAngle,this.m_localAxisC=w.m_localXAxisA;var B=this.m_localAnchorC,E=l.mulT(g.q,c.add(l.mul(v.q,this.m_localAnchorA),c.sub(v.p,g.p)));d=c.dot(E,this.m_localAxisC)-c.dot(B,this.m_localAxisC)}this.m_bodyD=this.m_joint2.getBodyA(),this.m_bodyB=this.m_joint2.getBodyB();var M=this.m_bodyB.m_xf,S=this.m_bodyB.m_sweep.a,T=this.m_bodyD.m_xf,I=this.m_bodyD.m_sweep.a;if(this.m_type2==h.TYPE){A=a;this.m_localAnchorD=A.m_localAnchorA,this.m_localAnchorB=A.m_localAnchorB,this.m_referenceAngleB=A.m_referenceAngle,this.m_localAxisD=c.zero(),y=S-I-this.m_referenceAngleB}else{w=a;this.m_localAnchorD=w.m_localAnchorA,this.m_localAnchorB=w.m_localAnchorB,this.m_referenceAngleB=w.m_referenceAngle,this.m_localAxisD=w.m_localXAxisA;var P=this.m_localAnchorD,C=l.mulT(T.q,c.add(l.mul(M.q,this.m_localAnchorB),c.sub(M.p,T.p)));y=c.dot(C,this.m_localAxisD)-c.dot(P,this.m_localAxisD)}this.m_ratio=u||t.ratio,this.m_constant=d+this.m_ratio*y,this.m_impulse=0,this.m_lcA,this.m_lcB,this.m_lcC,this.m_lcD,this.m_mA,this.m_mB,this.m_mC,this.m_mD,this.m_iA,this.m_iB,this.m_iC,this.m_iD,this.m_JvAC,this.m_JvBD,this.m_JwA,this.m_JwB,this.m_JwC,this.m_JwD,this.m_mass}p.prototype.getJoint1=function(){return this.m_joint1},p.prototype.getJoint2=function(){return this.m_joint2},p.prototype.setRatio=function(t){n&&i.assert(u.isFinite(t)),this.m_ratio=t},p.prototype.getRatio=function(){return this.m_ratio},p.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},p.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},p.prototype.getReactionForce=function(t){return t*(this.m_impulse*this.m_JvAC)},p.prototype.getReactionTorque=function(t){return t*(this.m_impulse*this.m_JwA)},p.prototype.initVelocityConstraints=function(t){this.m_lcA=this.m_bodyA.m_sweep.localCenter,this.m_lcB=this.m_bodyB.m_sweep.localCenter,this.m_lcC=this.m_bodyC.m_sweep.localCenter,this.m_lcD=this.m_bodyD.m_sweep.localCenter,this.m_mA=this.m_bodyA.m_invMass,this.m_mB=this.m_bodyB.m_invMass,this.m_mC=this.m_bodyC.m_invMass,this.m_mD=this.m_bodyD.m_invMass,this.m_iA=this.m_bodyA.m_invI,this.m_iB=this.m_bodyB.m_invI,this.m_iC=this.m_bodyC.m_invI,this.m_iD=this.m_bodyD.m_invI;var e=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=this.m_bodyC.c_position.a,u=this.m_bodyC.c_velocity.v,m=this.m_bodyC.c_velocity.w,f=this.m_bodyD.c_position.a,_=this.m_bodyD.c_velocity.v,p=this.m_bodyD.c_velocity.w,d=l.neo(e),y=l.neo(i),v=l.neo(a),b=l.neo(f);if(this.m_mass=0,this.m_type1==h.TYPE)this.m_JvAC=c.zero(),this.m_JwA=1,this.m_JwC=1,this.m_mass+=this.m_iA+this.m_iC;else{var g=l.mul(v,this.m_localAxisC),x=l.mulSub(v,this.m_localAnchorC,this.m_lcC),A=l.mulSub(d,this.m_localAnchorA,this.m_lcA);this.m_JvAC=g,this.m_JwC=c.cross(x,g),this.m_JwA=c.cross(A,g),this.m_mass+=this.m_mC+this.m_mA+this.m_iC*this.m_JwC*this.m_JwC+this.m_iA*this.m_JwA*this.m_JwA}if(this.m_type2==h.TYPE)this.m_JvBD=c.zero(),this.m_JwB=this.m_ratio,this.m_JwD=this.m_ratio,this.m_mass+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD);else{g=l.mul(b,this.m_localAxisD);var w=l.mulSub(b,this.m_localAnchorD,this.m_lcD),B=l.mulSub(y,this.m_localAnchorB,this.m_lcB);this.m_JvBD=c.mul(this.m_ratio,g),this.m_JwD=this.m_ratio*c.cross(w,g),this.m_JwB=this.m_ratio*c.cross(B,g),this.m_mass+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*this.m_JwD*this.m_JwD+this.m_iB*this.m_JwB*this.m_JwB}this.m_mass=this.m_mass>0?1/this.m_mass:0,t.warmStarting?(r.wAdd(this.m_mA*this.m_impulse,this.m_JvAC),n+=this.m_iA*this.m_impulse*this.m_JwA,o.wAdd(this.m_mB*this.m_impulse,this.m_JvBD),s+=this.m_iB*this.m_impulse*this.m_JwB,u.wSub(this.m_mC*this.m_impulse,this.m_JvAC),m-=this.m_iC*this.m_impulse*this.m_JwC,_.wSub(this.m_mD*this.m_impulse,this.m_JvBD),p-=this.m_iD*this.m_impulse*this.m_JwD):this.m_impulse=0,this.m_bodyA.c_velocity.v.set(r),this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v.set(o),this.m_bodyB.c_velocity.w=s,this.m_bodyC.c_velocity.v.set(u),this.m_bodyC.c_velocity.w=m,this.m_bodyD.c_velocity.v.set(_),this.m_bodyD.c_velocity.w=p},p.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,i=this.m_bodyB.c_velocity.w,o=this.m_bodyC.c_velocity.v,s=this.m_bodyC.c_velocity.w,a=this.m_bodyD.c_velocity.v,u=this.m_bodyD.c_velocity.w,l=c.dot(this.m_JvAC,e)-c.dot(this.m_JvAC,o)+c.dot(this.m_JvBD,n)-c.dot(this.m_JvBD,a);l+=this.m_JwA*r-this.m_JwC*s+(this.m_JwB*i-this.m_JwD*u);var m=-this.m_mass*l;this.m_impulse+=m,e.wAdd(this.m_mA*m,this.m_JvAC),r+=this.m_iA*m*this.m_JwA,n.wAdd(this.m_mB*m,this.m_JvBD),i+=this.m_iB*m*this.m_JwB,o.wSub(this.m_mC*m,this.m_JvAC),s-=this.m_iC*m*this.m_JwC,a.wSub(this.m_mD*m,this.m_JvBD),u-=this.m_iD*m*this.m_JwD,this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v.set(n),this.m_bodyB.c_velocity.w=i,this.m_bodyC.c_velocity.v.set(o),this.m_bodyC.c_velocity.w=s,this.m_bodyD.c_velocity.v.set(a),this.m_bodyD.c_velocity.w=u},p.prototype.solvePositionConstraints=function(t){var e,r,n,i,o,s,u,m,f=this.m_bodyA.c_position.c,_=this.m_bodyA.c_position.a,p=this.m_bodyB.c_position.c,d=this.m_bodyB.c_position.a,y=this.m_bodyC.c_position.c,v=this.m_bodyC.c_position.a,b=this.m_bodyD.c_position.c,g=this.m_bodyD.c_position.a,x=l.neo(_),A=l.neo(d),w=l.neo(v),B=l.neo(g),E=0;if(this.m_type1==h.TYPE)n=c.zero(),o=1,u=1,E+=this.m_iA+this.m_iC,e=_-v-this.m_referenceAngleA;else{var M=l.mul(w,this.m_localAxisC),S=l.mulSub(w,this.m_localAnchorC,this.m_lcC),T=l.mulSub(x,this.m_localAnchorA,this.m_lcA);n=M,u=c.cross(S,M),o=c.cross(T,M),E+=this.m_mC+this.m_mA+this.m_iC*u*u+this.m_iA*o*o;var I=c.sub(this.m_localAnchorC,this.m_lcC),P=l.mulT(w,c.add(T,c.sub(f,y)));e=c.dot(c.sub(P,I),this.m_localAxisC)}if(this.m_type2==h.TYPE)i=c.zero(),s=this.m_ratio,m=this.m_ratio,E+=this.m_ratio*this.m_ratio*(this.m_iB+this.m_iD),r=d-g-this.m_referenceAngleB;else{M=l.mul(B,this.m_localAxisD);var C=l.mulSub(B,this.m_localAnchorD,this.m_lcD),R=l.mulSub(A,this.m_localAnchorB,this.m_lcB);i=c.mul(this.m_ratio,M),m=this.m_ratio*c.cross(C,M),s=this.m_ratio*c.cross(R,M),E+=this.m_ratio*this.m_ratio*(this.m_mD+this.m_mB)+this.m_iD*m*m+this.m_iB*s*s;var F=c.sub(this.m_localAnchorD,this.m_lcD),D=l.mulT(B,c.add(R,c.sub(p,b)));r=c.dot(D,this.m_localAxisD)-c.dot(F,this.m_localAxisD)}var L=e+this.m_ratio*r-this.m_constant,O=0;return E>0&&(O=-L/E),f.wAdd(this.m_mA*O,n),_+=this.m_iA*O*o,p.wAdd(this.m_mB*O,i),d+=this.m_iB*O*s,y.wSub(this.m_mC*O,n),v-=this.m_iC*O*u,b.wSub(this.m_mD*O,i),g-=this.m_iD*O*m,this.m_bodyA.c_position.c.set(f),this.m_bodyA.c_position.a=_,this.m_bodyB.c_position.c.set(p),this.m_bodyB.c_position.a=d,this.m_bodyC.c_position.c.set(y),this.m_bodyC.c_position.a=v,this.m_bodyD.c_position.c.set(b),this.m_bodyD.c_position.a=g,0<a.linearSlop}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT;t.exports=f;var i=r(7),o=r(28),s=r(22),a=(r(13),r(4)),u=r(3),c=(r(42),r(43)),l=(r(47),r(12)),m=(r(40),r(14),r(45),r(44),r(46));f.TYPE="friction-joint",f._super=m,f.prototype=s(f._super.prototype);var h={maxForce:0,maxTorque:0};function f(t,e,r,n){if(!(this instanceof f))return new f(t,e,r,n);t=o(t,h),m.call(this,t,e,r),this.m_type=f.TYPE,n?(this.m_localAnchorA=e.getLocalPoint(n),this.m_localAnchorB=r.getLocalPoint(n)):(this.m_localAnchorA=u.zero(),this.m_localAnchorB=u.zero()),this.m_linearImpulse=u.zero(),this.m_angularImpulse=0,this.m_maxForce=t.maxForce,this.m_maxTorque=t.maxTorque,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_linearMass,this.m_angularMass}f.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},f.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},f.prototype.setMaxForce=function(t){n&&i.assert(IsValid(t)&&t>=0),this.m_maxForce=t},f.prototype.getMaxForce=function(){return this.m_maxForce},f.prototype.setMaxTorque=function(t){n&&i.assert(IsValid(t)&&t>=0),this.m_maxTorque=t},f.prototype.getMaxTorque=function(){return this.m_maxTorque},f.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},f.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},f.prototype.getReactionForce=function(t){return t*this.m_linearImpulse},f.prototype.getReactionTorque=function(t){return t*this.m_angularImpulse},f.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.a,r=this.m_bodyA.c_velocity.v,n=this.m_bodyA.c_velocity.w,i=this.m_bodyB.c_position.a,o=this.m_bodyB.c_velocity.v,s=this.m_bodyB.c_velocity.w,a=l.neo(e),m=l.neo(i);this.m_rA=l.mul(a,u.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=l.mul(m,u.sub(this.m_localAnchorB,this.m_localCenterB));var h=this.m_invMassA,f=this.m_invMassB,_=this.m_invIA,p=this.m_invIB,d=new c;if(d.ex.x=h+f+_*this.m_rA.y*this.m_rA.y+p*this.m_rB.y*this.m_rB.y,d.ex.y=-_*this.m_rA.x*this.m_rA.y-p*this.m_rB.x*this.m_rB.y,d.ey.x=d.ex.y,d.ey.y=h+f+_*this.m_rA.x*this.m_rA.x+p*this.m_rB.x*this.m_rB.x,this.m_linearMass=d.getInverse(),this.m_angularMass=_+p,this.m_angularMass>0&&(this.m_angularMass=1/this.m_angularMass),t.warmStarting){this.m_linearImpulse.mul(t.dtRatio),this.m_angularImpulse*=t.dtRatio;var y=u.neo(this.m_linearImpulse.x,this.m_linearImpulse.y);r.wSub(h,y),n-=_*(u.cross(this.m_rA,y)+this.m_angularImpulse),o.wAdd(f,y),s+=p*(u.cross(this.m_rB,y)+this.m_angularImpulse)}else this.m_linearImpulse.setZero(),this.m_angularImpulse=0;this.m_bodyA.c_velocity.v=r,this.m_bodyA.c_velocity.w=n,this.m_bodyB.c_velocity.v=o,this.m_bodyB.c_velocity.w=s},f.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,i=this.m_bodyB.c_velocity.w,o=this.m_invMassA,s=this.m_invMassB,l=this.m_invIA,m=this.m_invIB,h=t.dt,f=i-r,_=-this.m_angularMass*f,p=this.m_angularImpulse,d=h*this.m_maxTorque;this.m_angularImpulse=a.clamp(this.m_angularImpulse+_,-d,d),r-=l*(_=this.m_angularImpulse-p),i+=m*_;f=u.sub(u.add(n,u.cross(i,this.m_rB)),u.add(e,u.cross(r,this.m_rA))),_=u.neg(c.mul(this.m_linearMass,f)),p=this.m_linearImpulse;this.m_linearImpulse.add(_);d=h*this.m_maxForce;this.m_linearImpulse.lengthSquared()>d*d&&(this.m_linearImpulse.normalize(),this.m_linearImpulse.mul(d)),_=u.sub(this.m_linearImpulse,p),e.wSub(o,_),r-=l*u.cross(this.m_rA,_),n.wAdd(s,_),i+=m*u.cross(this.m_rB,_),this.m_bodyA.c_velocity.v=e,this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v=n,this.m_bodyB.c_velocity.w=i},f.prototype.solvePositionConstraints=function(t){return!0}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports=m;var n=r(28),i=r(22),o=r(13),s=r(4),a=r(3),u=(r(42),r(43),r(47),r(12)),c=(r(40),r(14),r(45),r(44),r(46));m.TYPE="distance-joint",m._super=c,m.prototype=i(m._super.prototype);var l={frequencyHz:0,dampingRatio:0};function m(t,e,r,i,o){if(!(this instanceof m))return new m(t,e,r,i,o);t=n(t,l),c.call(this,t,e,i),this.m_type=m.TYPE,this.m_localAnchorA=t.localAnchorA||e.getLocalPoint(r),this.m_localAnchorB=t.localAnchorB||i.getLocalPoint(o),this.m_length=a.distance(o,r),this.m_frequencyHz=t.frequencyHz,this.m_dampingRatio=t.dampingRatio,this.m_impulse=0,this.m_gamma=0,this.m_bias=0,this.m_u,this.m_rA,this.m_rB,this.m_localCenterA,this.m_localCenterB,this.m_invMassA,this.m_invMassB,this.m_invIA,this.m_invIB,this.m_mass}m.prototype.getLocalAnchorA=function(){return this.m_localAnchorA},m.prototype.getLocalAnchorB=function(){return this.m_localAnchorB},m.prototype.setLength=function(t){this.m_length=t},m.prototype.getLength=function(){return this.m_length},m.prototype.setFrequency=function(t){this.m_frequencyHz=t},m.prototype.getFrequency=function(){return this.m_frequencyHz},m.prototype.setDampingRatio=function(t){this.m_dampingRatio=t},m.prototype.getDampingRatio=function(){return this.m_dampingRatio},m.prototype.getAnchorA=function(){return this.m_bodyA.getWorldPoint(this.m_localAnchorA)},m.prototype.getAnchorB=function(){return this.m_bodyB.getWorldPoint(this.m_localAnchorB)},m.prototype.getReactionForce=function(t){return a.mul(t*this.m_impulse,this.m_u)},m.prototype.getReactionTorque=function(t){return 0},m.prototype.initVelocityConstraints=function(t){this.m_localCenterA=this.m_bodyA.m_sweep.localCenter,this.m_localCenterB=this.m_bodyB.m_sweep.localCenter,this.m_invMassA=this.m_bodyA.m_invMass,this.m_invMassB=this.m_bodyB.m_invMass,this.m_invIA=this.m_bodyA.m_invI,this.m_invIB=this.m_bodyB.m_invI;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,n=this.m_bodyA.c_velocity.v,i=this.m_bodyA.c_velocity.w,c=this.m_bodyB.c_position.c,l=this.m_bodyB.c_position.a,m=this.m_bodyB.c_velocity.v,h=this.m_bodyB.c_velocity.w,f=u.neo(r),_=u.neo(l);this.m_rA=u.mul(f,a.sub(this.m_localAnchorA,this.m_localCenterA)),this.m_rB=u.mul(_,a.sub(this.m_localAnchorB,this.m_localCenterB)),this.m_u=a.sub(a.add(c,this.m_rB),a.add(e,this.m_rA));var p=this.m_u.length();p>o.linearSlop?this.m_u.mul(1/p):this.m_u.set(0,0);var d=a.cross(this.m_rA,this.m_u),y=a.cross(this.m_rB,this.m_u),v=this.m_invMassA+this.m_invIA*d*d+this.m_invMassB+this.m_invIB*y*y;if(this.m_mass=0!=v?1/v:0,this.m_frequencyHz>0){var b=p-this.m_length,g=2*s.PI*this.m_frequencyHz,x=2*this.m_mass*this.m_dampingRatio*g,A=this.m_mass*g*g,w=t.dt;this.m_gamma=w*(x+w*A),this.m_gamma=0!=this.m_gamma?1/this.m_gamma:0,this.m_bias=b*w*A*this.m_gamma,v+=this.m_gamma,this.m_mass=0!=v?1/v:0}else this.m_gamma=0,this.m_bias=0;if(t.warmStarting){this.m_impulse*=t.dtRatio;var B=a.mul(this.m_impulse,this.m_u);n.wSub(this.m_invMassA,B),i-=this.m_invIA*a.cross(this.m_rA,B),m.wAdd(this.m_invMassB,B),h+=this.m_invIB*a.cross(this.m_rB,B)}else this.m_impulse=0;this.m_bodyA.c_velocity.v.set(n),this.m_bodyA.c_velocity.w=i,this.m_bodyB.c_velocity.v.set(m),this.m_bodyB.c_velocity.w=h},m.prototype.solveVelocityConstraints=function(t){var e=this.m_bodyA.c_velocity.v,r=this.m_bodyA.c_velocity.w,n=this.m_bodyB.c_velocity.v,i=this.m_bodyB.c_velocity.w,o=a.add(e,a.cross(r,this.m_rA)),s=a.add(n,a.cross(i,this.m_rB)),u=a.dot(this.m_u,s)-a.dot(this.m_u,o),c=-this.m_mass*(u+this.m_bias+this.m_gamma*this.m_impulse);this.m_impulse+=c;var l=a.mul(c,this.m_u);e.wSub(this.m_invMassA,l),r-=this.m_invIA*a.cross(this.m_rA,l),n.wAdd(this.m_invMassB,l),i+=this.m_invIB*a.cross(this.m_rB,l),this.m_bodyA.c_velocity.v.set(e),this.m_bodyA.c_velocity.w=r,this.m_bodyB.c_velocity.v.set(n),this.m_bodyB.c_velocity.w=i},m.prototype.solvePositionConstraints=function(t){if(this.m_frequencyHz>0)return!0;var e=this.m_bodyA.c_position.c,r=this.m_bodyA.c_position.a,n=this.m_bodyB.c_position.c,i=this.m_bodyB.c_position.a,c=u.neo(r),l=u.neo(i),m=u.mulSub(c,this.m_localAnchorA,this.m_localCenterA),h=u.mulSub(l,this.m_localAnchorB,this.m_localCenterB),f=a.sub(a.add(n,h),a.add(e,m)),_=f.normalize()-this.m_length;_=s.clamp(_,-o.maxLinearCorrection,o.maxLinearCorrection);var p=-this.m_mass*_,d=a.mul(p,f);return e.wSub(this.m_invMassA,d),r-=this.m_invIA*a.cross(m,d),n.wAdd(this.m_invMassB,d),i+=this.m_invIB*a.cross(h,d),this.m_bodyA.c_position.c.set(e),this.m_bodyA.c_position.a=r,this.m_bodyB.c_position.c.set(n),this.m_bodyB.c_position.a=i,s.abs(_)<o.linearSlop}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,i=r(7),o=(r(22),r(4)),s=r(14),a=r(3),u=r(12),c=r(13),l=(r(56),r(73)),m=r(78),h=r(105),f=r(133),_=r(99);l.addType(h.TYPE,_.TYPE,function(t,e,r,o,s,a,u){n&&i.assert(r.getType()==h.TYPE),n&&i.assert(a.getType()==_.TYPE),w(t,r.getShape(),e,a.getShape(),s)}),l.addType(f.TYPE,_.TYPE,function(t,e,r,o,s,a,u){n&&i.assert(r.getType()==f.TYPE),n&&i.assert(a.getType()==_.TYPE);var c=r.getShape(),l=new h;c.getChildEdge(l,o),w(t,l,e,a.getShape(),s)});var p=-1,d=1,y=2;function v(){this.type,this.index,this.separation}var b=new v,g=new v,x=new function(){this.vertices=[],this.normals=[],this.count=0},A=new function(){this.i1,this.i2,this.v1,this.v2,this.normal=a.zero(),this.sideNormal1=a.zero(),this.sideOffset1,this.sideNormal2=a.zero(),this.sideOffset2};function w(t,e,r,n,i){var l=s.mulT(r,i),h=s.mul(l,n.m_centroid),f=e.m_vertex0,_=e.m_vertex1,v=e.m_vertex2,w=e.m_vertex3,B=e.m_hasVertex0,E=e.m_hasVertex3,M=a.sub(v,_);M.normalize();var S,T=a.neo(M.y,-M.x),I=a.dot(T,a.sub(h,_)),P=0,C=0,R=!1,F=!1;if(B){var D=a.sub(_,f);D.normalize();var L=a.neo(D.y,-D.x);R=a.cross(D,M)>=0,P=a.dot(L,h)-a.dot(L,f)}if(E){var O=a.sub(w,v);O.normalize();var k=a.neo(O.y,-O.x);F=a.cross(M,O)>0,C=a.dot(k,h)-a.dot(k,v)}var U=a.zero(),z=a.zero(),j=a.zero();B&&E?R&&F?(S=P>=0||I>=0||C>=0)?(U.set(T),z.set(L),j.set(k)):(U.wSet(-1,T),z.wSet(-1,T),j.wSet(-1,T)):R?(S=P>=0||I>=0&&C>=0)?(U.set(T),z.set(L),j.set(T)):(U.wSet(-1,T),z.wSet(-1,k),j.wSet(-1,T)):F?(S=C>=0||P>=0&&I>=0)?(U.set(T),z.set(T),j.set(k)):(U.wSet(-1,T),z.wSet(-1,T),j.wSet(-1,L)):(S=P>=0&&I>=0&&C>=0)?(U.set(T),z.set(T),j.set(T)):(U.wSet(-1,T),z.wSet(-1,k),j.wSet(-1,L)):B?R?(S=P>=0||I>=0)?(U.set(T),z.set(L),j.wSet(-1,T)):(U.wSet(-1,T),z.set(T),j.wSet(-1,T)):(S=P>=0&&I>=0)?(U.set(T),z.set(T),j.wSet(-1,T)):(U.wSet(-1,T),z.set(T),j.wSet(-1,L)):E?F?(S=I>=0||C>=0)?(U.set(T),z.wSet(-1,T),j.set(k)):(U.wSet(-1,T),z.wSet(-1,T),j.set(T)):(S=I>=0&&C>=0)?(U.set(T),z.wSet(-1,T),j.set(T)):(U.wSet(-1,T),z.wSet(-1,k),j.set(T)):(S=I>=0)?(U.set(T),z.wSet(-1,T),j.wSet(-1,T)):(U.wSet(-1,T),z.set(T),j.set(T)),x.count=n.m_count;for(var V=0;V<n.m_count;++V)x.vertices[V]=s.mul(l,n.m_vertices[V]),x.normals[V]=u.mul(l.q,n.m_normals[V]);var N=2*c.polygonRadius;t.pointCount=0,b.type=d,b.index=S?0:1,b.separation=1/0;for(V=0;V<x.count;++V){(G=a.dot(U,a.sub(x.vertices[V],_)))<b.separation&&(b.separation=G)}if(b.type!=p&&!(b.separation>N)){g.type=p,g.index=-1,g.separation=-1/0;var q=a.neo(-U.y,U.x);for(V=0;V<x.count;++V){var G,W=a.neg(x.normals[V]),Y=a.dot(W,a.sub(x.vertices[V],_)),X=a.dot(W,a.sub(x.vertices[V],v));if((G=o.min(Y,X))>N){g.type=y,g.index=V,g.separation=G;break}if(a.dot(W,q)>=0){if(a.dot(a.sub(W,j),U)<-c.angularSlop)continue}else if(a.dot(a.sub(W,z),U)<-c.angularSlop)continue;G>g.separation&&(g.type=y,g.index=V,g.separation=G)}if(!(g.type!=p&&g.separation>N)){var K;K=g.type==p?b:g.separation>.98*b.separation+.001?g:b;var H=[new m.clipVertex,new m.clipVertex];if(K.type==d){t.type=m.e_faceA;var J=0,Z=a.dot(U,x.normals[0]);for(V=1;V<x.count;++V){var Q=a.dot(U,x.normals[V]);Q<Z&&(Z=Q,J=V)}var $=J,tt=$+1<x.count?$+1:0;H[0].v=x.vertices[$],H[0].id.cf.indexA=0,H[0].id.cf.indexB=$,H[0].id.cf.typeA=m.e_face,H[0].id.cf.typeB=m.e_vertex,H[1].v=x.vertices[tt],H[1].id.cf.indexA=0,H[1].id.cf.indexB=tt,H[1].id.cf.typeA=m.e_face,H[1].id.cf.typeB=m.e_vertex,S?(A.i1=0,A.i2=1,A.v1=_,A.v2=v,A.normal.set(T)):(A.i1=1,A.i2=0,A.v1=v,A.v2=_,A.normal.wSet(-1,T))}else t.type=m.e_faceB,H[0].v=_,H[0].id.cf.indexA=0,H[0].id.cf.indexB=K.index,H[0].id.cf.typeA=m.e_vertex,H[0].id.cf.typeB=m.e_face,H[1].v=v,H[1].id.cf.indexA=0,H[1].id.cf.indexB=K.index,H[1].id.cf.typeA=m.e_vertex,H[1].id.cf.typeB=m.e_face,A.i1=K.index,A.i2=A.i1+1<x.count?A.i1+1:0,A.v1=x.vertices[A.i1],A.v2=x.vertices[A.i2],A.normal.set(x.normals[A.i1]);A.sideNormal1.set(A.normal.y,-A.normal.x),A.sideNormal2.wSet(-1,A.sideNormal1),A.sideOffset1=a.dot(A.sideNormal1,A.v1),A.sideOffset2=a.dot(A.sideNormal2,A.v2);var et=[new m.clipVertex,new m.clipVertex],rt=[new m.clipVertex,new m.clipVertex];if(!(m.clipSegmentToLine(et,H,A.sideNormal1,A.sideOffset1,A.i1)<c.maxManifoldPoints||m.clipSegmentToLine(rt,et,A.sideNormal2,A.sideOffset2,A.i2)<c.maxManifoldPoints)){K.type==d?(t.localNormal=a.clone(A.normal),t.localPoint=a.clone(A.v1)):(t.localNormal=a.clone(n.m_normals[A.i1]),t.localPoint=a.clone(n.m_vertices[A.i1]));var nt=0;for(V=0;V<c.maxManifoldPoints;++V){if(a.dot(A.normal,a.sub(rt[V].v,A.v1))<=N){var it=t.points[nt];K.type==d?(it.localPoint=s.mulT(l,rt[V].v),it.id=rt[V].id):(it.localPoint=rt[V].v,it.id.cf.typeA=rt[V].id.cf.typeB,it.id.cf.typeB=rt[V].id.cf.typeA,it.id.cf.indexA=rt[V].id.cf.indexB,it.id.cf.indexB=rt[V].id.cf.indexA),++nt}}t.pointCount=nt}}}}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,i=r(7),o=r(4),s=r(14),a=(r(12),r(3)),u=(r(62),r(13),r(78)),c=r(73),l=(r(56),r(106)),m=r(99);c.addType(m.TYPE,l.TYPE,function(t,e,r,c,h,f,_){n&&i.assert(r.getType()==m.TYPE),n&&i.assert(f.getType()==l.TYPE),function(t,e,r,n,i){t.pointCount=0;for(var c=s.mul(i,n.m_p),l=s.mulT(r,c),m=0,h=-1/0,f=e.m_radius+n.m_radius,_=e.m_count,p=e.m_vertices,d=e.m_normals,y=0;y<_;++y){var v=a.dot(d[y],a.sub(l,p[y]));if(v>f)return;v>h&&(h=v,m=y)}var b=m,g=b+1<_?b+1:0,x=p[b],A=p[g];if(h<o.EPSILON)return t.pointCount=1,t.type=u.e_faceA,t.localNormal.set(d[m]),t.localPoint.wSet(.5,x,.5,A),t.points[0].localPoint=n.m_p,void(t.points[0].id.key=0);var w=a.dot(a.sub(l,x),a.sub(A,x)),B=a.dot(a.sub(l,A),a.sub(x,A));if(w<=0){if(a.distanceSquared(l,x)>f*f)return;t.pointCount=1,t.type=u.e_faceA,t.localNormal.wSet(1,l,-1,x),t.localNormal.normalize(),t.localPoint=x,t.points[0].localPoint.set(n.m_p),t.points[0].id.key=0}else if(B<=0){if(a.distanceSquared(l,A)>f*f)return;t.pointCount=1,t.type=u.e_faceA,t.localNormal.wSet(1,l,-1,A),t.localNormal.normalize(),t.localPoint.set(A),t.points[0].localPoint.set(n.m_p),t.points[0].id.key=0}else{var E=a.mid(x,A),h=a.dot(l,d[b])-a.dot(E,d[b]);if(h>f)return;t.pointCount=1,t.type=u.e_faceA,t.localNormal.set(d[b]),t.localPoint.set(E),t.points[0].localPoint.set(n.m_p),t.points[0].id.key=0}}(t,r.getShape(),e,f.getShape(),h)})},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,i=r(7),o=(r(4),r(14)),s=r(12),a=r(3),u=(r(62),r(13)),c=r(78),l=r(73),m=(r(56),r(99));function h(t,e,r,n){for(var i=t.m_count,u=r.m_count,c=t.m_normals,l=t.m_vertices,m=r.m_vertices,f=o.mulT(n,e),_=0,p=-1/0,d=0;d<i;++d){for(var y=s.mul(f.q,c[d]),v=o.mul(f,l[d]),b=1/0,g=0;g<u;++g){var x=a.dot(y,m[g])-a.dot(y,v);x<b&&(b=x)}b>p&&(p=b,_=d)}h._maxSeparation=p,h._bestIndex=_}function f(t,e,r,l,m){t.pointCount=0;var f=e.m_radius+l.m_radius;h(e,r,l,m);var _=h._bestIndex,p=h._maxSeparation;if(!(p>f)){h(l,m,e,r);var d=h._bestIndex,y=h._maxSeparation;if(!(y>f)){var v,b,g,x,A,w;y>p+.1*u.linearSlop?(v=l,b=e,g=m,x=r,A=d,t.type=c.e_faceB,w=1):(v=e,b=l,g=r,x=m,A=_,t.type=c.e_faceA,w=0);var B=[new c.clipVertex,new c.clipVertex];!function(t,e,r,u,l,m){var h=e.m_normals,f=l.m_count,_=l.m_vertices,p=l.m_normals;n&&i.assert(0<=u&&u<e.m_count);for(var d=s.mulT(m.q,s.mul(r.q,h[u])),y=0,v=1/0,b=0;b<f;++b){var g=a.dot(d,p[b]);g<v&&(v=g,y=b)}var x=y,A=x+1<f?x+1:0;t[0].v=o.mul(m,_[x]),t[0].id.cf.indexA=u,t[0].id.cf.indexB=x,t[0].id.cf.typeA=c.e_face,t[0].id.cf.typeB=c.e_vertex,t[1].v=o.mul(m,_[A]),t[1].id.cf.indexA=u,t[1].id.cf.indexB=A,t[1].id.cf.typeA=c.e_face,t[1].id.cf.typeB=c.e_vertex}(B,v,g,A,b,x);var E=v.m_count,M=v.m_vertices,S=A,T=A+1<E?A+1:0,I=M[S],P=M[T],C=a.sub(P,I);C.normalize();var R=a.cross(C,1),F=a.wAdd(.5,I,.5,P),D=s.mul(g.q,C),L=a.cross(D,1);I=o.mul(g,I),P=o.mul(g,P);var O=a.dot(L,I),k=-a.dot(D,I)+f,U=a.dot(D,P)+f,z=[new c.clipVertex,new c.clipVertex],j=[new c.clipVertex,new c.clipVertex];if(!(c.clipSegmentToLine(z,B,a.neg(D),k,S)<2||c.clipSegmentToLine(j,z,D,U,T)<2)){t.localNormal=R,t.localPoint=F;for(var V=0,N=0;N<j.length;++N){if(a.dot(L,j[N].v)-O<=f){var q=t.points[V];if(q.localPoint.set(o.mulT(x,j[N].v)),q.id=j[N].id,w){var G=q.id.cf,W=G.indexA,Y=G.indexB,X=G.typeA,K=G.typeB;G.indexA=Y,G.indexB=W,G.typeA=K,G.typeB=X}++V}}t.pointCount=V}}}}t.exports=f,l.addType(m.TYPE,m.TYPE,function(t,e,r,o,s,a,u){n&&i.assert(r.getType()==m.TYPE),n&&i.assert(a.getType()==m.TYPE),f(t,r.getShape(),e,a.getShape(),s)})},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,i=r(7),o=(r(22),r(4),r(14)),s=r(3),a=(r(12),r(13),r(56),r(73)),u=r(78),c=r(105),l=r(133),m=r(106);function h(t,e,r,a,c){t.pointCount=0;var l=o.mulT(r,o.mul(c,a.m_p)),m=e.m_vertex1,h=e.m_vertex2,f=s.sub(h,m),_=s.dot(f,s.sub(h,l)),p=s.dot(f,s.sub(l,m)),d=e.m_radius+a.m_radius;if(p<=0){var y=s.clone(m),v=s.sub(l,y);if(s.dot(v,v)>d*d)return;if(e.m_hasVertex0){var b=e.m_vertex0,g=m,x=s.sub(g,b);if(s.dot(x,s.sub(g,l))>0)return}return t.type=u.e_circles,t.localNormal.setZero(),t.localPoint.set(y),t.pointCount=1,t.points[0].localPoint.set(a.m_p),t.points[0].id.key=0,t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=u.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=u.e_vertex)}if(_<=0){y=s.clone(h),v=s.sub(l,y);if(s.dot(v,v)>d*d)return;if(e.m_hasVertex3){var A=e.m_vertex3,w=h,B=s.sub(A,w);if(s.dot(B,s.sub(l,w))>0)return}return t.type=u.e_circles,t.localNormal.setZero(),t.localPoint.set(y),t.pointCount=1,t.points[0].localPoint.set(a.m_p),t.points[0].id.key=0,t.points[0].id.cf.indexA=1,t.points[0].id.cf.typeA=u.e_vertex,t.points[0].id.cf.indexB=0,void(t.points[0].id.cf.typeB=u.e_vertex)}var E=s.dot(f,f);n&&i.assert(E>0);y=s.wAdd(_/E,m,p/E,h),v=s.sub(l,y);if(!(s.dot(v,v)>d*d)){var M=s.neo(-f.y,f.x);s.dot(M,s.sub(l,m))<0&&M.set(-M.x,-M.y),M.normalize(),t.type=u.e_faceA,t.localNormal=M,t.localPoint.set(m),t.pointCount=1,t.points[0].localPoint.set(a.m_p),t.points[0].id.key=0,t.points[0].id.cf.indexA=0,t.points[0].id.cf.typeA=u.e_face,t.points[0].id.cf.indexB=0,t.points[0].id.cf.typeB=u.e_vertex}}a.addType(c.TYPE,m.TYPE,function(t,e,r,o,s,a,u){n&&i.assert(r.getType()==c.TYPE),n&&i.assert(a.getType()==m.TYPE);var l=r.getShape(),f=a.getShape();h(t,l,e,f,s)}),a.addType(l.TYPE,m.TYPE,function(t,e,r,o,s,a,u){n&&i.assert(r.getType()==l.TYPE),n&&i.assert(a.getType()==m.TYPE);var f=r.getShape(),_=new c;f.getChildEdge(_,o);var p=_,d=a.getShape();h(t,p,e,d,s)})},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,i=r(7),o=(r(22),r(4),r(14)),s=r(3),a=(r(13),r(56),r(73)),u=r(78),c=r(106);function l(t,e,r,n,i){t.pointCount=0;var a=o.mul(r,e.m_p),c=o.mul(i,n.m_p),l=s.distanceSquared(c,a),m=e.m_radius+n.m_radius;l>m*m||(t.type=u.e_circles,t.localPoint.set(e.m_p),t.localNormal.setZero(),t.pointCount=1,t.points[0].localPoint.set(n.m_p),t.points[0].id.key=0)}a.addType(c.TYPE,c.TYPE,function(t,e,r,o,s,a,u){n&&i.assert(r.getType()==c.TYPE),n&&i.assert(a.getType()==c.TYPE),l(t,r.getShape(),e,a.getShape(),s)}),e.CollideCircles=l},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports=o;r(7);var n=r(22),i=r(99);function o(t,e,r,n){if(!(this instanceof o))return new o(t,e,r,n);o._super.call(this),this._setAsBox(t,e,r,n)}o._super=i,o.prototype=n(o._super.prototype),o.TYPE="polygon"},function(t,e){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports.now=function(){return Date.now()},t.exports.diff=function(t){return Date.now()-t}},function(t,e,r){var n="undefined"!=typeof DEBUG&&DEBUG,i="undefined"!=typeof ASSERT&&ASSERT;t.exports=y,t.exports.TimeStep=d;var o=r(13),s=r(7),a=r(3),u=r(4),c=r(135),l=r(73),m=r(46),h=r(177),f=h.Input,_=h.Output,p=r(107);p.Input,p.Output,p.Proxy,p.Cache;function d(t){this.dt=0,this.inv_dt=0,this.velocityIterations=0,this.positionIterations=0,this.warmStarting=!1,this.blockSolve=!0,this.inv_dt0=0,this.dtRatio=1}function y(t){this.m_world=t,this.m_stack=[],this.m_bodies=[],this.m_contacts=[],this.m_joints=[]}d.prototype.reset=function(t){this.dt>0&&(this.inv_dt0=this.inv_dt),this.dt=t,this.inv_dt=0==t?0:1/t,this.dtRatio=t*this.inv_dt0},y.prototype.clear=function(){this.m_stack.length=0,this.m_bodies.length=0,this.m_contacts.length=0,this.m_joints.length=0},y.prototype.addBody=function(t){i&&s.assert(t instanceof c,"Not a Body!",t),this.m_bodies.push(t)},y.prototype.addContact=function(t){i&&s.assert(t instanceof l,"Not a Contact!",t),this.m_contacts.push(t)},y.prototype.addJoint=function(t){i&&s.assert(t instanceof m,"Not a Joint!",t),this.m_joints.push(t)},y.prototype.solveWorld=function(t){for(var e=this.m_world,r=e.m_bodyList;r;r=r.m_next)r.m_islandFlag=!1;for(var n=e.m_contactList;n;n=n.m_next)n.m_islandFlag=!1;for(var o=e.m_jointList;o;o=o.m_next)o.m_islandFlag=!1;for(var a=this.m_stack,u=e.m_bodyList;u;u=u.m_next)if(0,!u.m_islandFlag&&0!=u.isAwake()&&0!=u.isActive()&&!u.isStatic()){for(this.clear(),a.push(u),u.m_islandFlag=!0;a.length>0;){r=a.pop();if(i&&s.assert(1==r.isActive()),this.addBody(r),r.setAwake(!0),!r.isStatic()){for(var c=r.m_contactList;c;c=c.next){var l=c.contact;if(!l.m_islandFlag&&(0!=l.isEnabled()&&0!=l.isTouching())){var m=l.m_fixtureA.m_isSensor,h=l.m_fixtureB.m_isSensor;if(!m&&!h)this.addContact(l),l.m_islandFlag=!0,(_=c.other).m_islandFlag||(a.push(_),_.m_islandFlag=!0)}}for(var f=r.m_jointList;f;f=f.next){var _;if(1!=f.joint.m_islandFlag)0!=(_=f.other).isActive()&&(this.addJoint(f.joint),f.joint.m_islandFlag=!0,_.m_islandFlag||(a.push(_),_.m_islandFlag=!0))}}}this.solveIsland(t);for(var p=0;p<this.m_bodies.length;++p){(r=this.m_bodies[p]).isStatic()&&(r.m_islandFlag=!1)}}},y.prototype.solveIsland=function(t){for(var e=this.m_world,r=e.m_gravity,i=e.m_allowSleep,s=t.dt,c=0;c<this.m_bodies.length;++c){var l=this.m_bodies[c],m=a.clone(l.m_sweep.c),h=l.m_sweep.a,f=a.clone(l.m_linearVelocity),_=l.m_angularVelocity;l.m_sweep.c0.set(l.m_sweep.c),l.m_sweep.a0=l.m_sweep.a,l.isDynamic()&&(f.wAdd(s*l.m_gravityScale,r),f.wAdd(s*l.m_invMass,l.m_force),_+=s*l.m_invI*l.m_torque,f.mul(1/(1+s*l.m_linearDamping)),_*=1/(1+s*l.m_angularDamping)),l.c_position.c=m,l.c_position.a=h,l.c_velocity.v=f,l.c_velocity.w=_}for(c=0;c<this.m_contacts.length;++c){this.m_contacts[c].initConstraint(t)}n&&this.printBodies("M: ");for(c=0;c<this.m_contacts.length;++c){this.m_contacts[c].initVelocityConstraint(t)}if(n&&this.printBodies("R: "),t.warmStarting)for(c=0;c<this.m_contacts.length;++c){this.m_contacts[c].warmStartConstraint(t)}n&&this.printBodies("Q: ");for(c=0;c<this.m_joints.length;++c){this.m_joints[c].initVelocityConstraints(t)}n&&this.printBodies("E: ");for(c=0;c<t.velocityIterations;++c){for(var p=0;p<this.m_joints.length;++p){this.m_joints[p].solveVelocityConstraints(t)}for(p=0;p<this.m_contacts.length;++p){this.m_contacts[p].solveVelocityConstraint(t)}}n&&this.printBodies("D: ");for(c=0;c<this.m_contacts.length;++c){this.m_contacts[c].storeConstraintImpulses(t)}n&&this.printBodies("C: ");for(c=0;c<this.m_bodies.length;++c){l=this.m_bodies[c],m=a.clone(l.c_position.c),h=l.c_position.a,f=a.clone(l.c_velocity.v),_=l.c_velocity.w;var d=a.mul(s,f);if(a.lengthSquared(d)>o.maxTranslationSquared){var y=o.maxTranslation/d.length();f.mul(y)}var v=s*_;if(v*v>o.maxRotationSquared)_*=y=o.maxRotation/u.abs(v);m.wAdd(s,f),h+=s*_,l.c_position.c.set(m),l.c_position.a=h,l.c_velocity.v.set(f),l.c_velocity.w=_}n&&this.printBodies("B: ");var b=!1;for(c=0;c<t.positionIterations;++c){var g=0;for(p=0;p<this.m_contacts.length;++p){var x=this.m_contacts[p].solvePositionConstraint(t);g=u.min(g,x)}var A=g>=-3*o.linearSlop,w=!0;for(p=0;p<this.m_joints.length;++p){var B=this.m_joints[p].solvePositionConstraints(t);w=w&&B}if(A&&w){b=!0;break}}n&&this.printBodies("L: ");for(c=0;c<this.m_bodies.length;++c){(l=this.m_bodies[c]).m_sweep.c.set(l.c_position.c),l.m_sweep.a=l.c_position.a,l.m_linearVelocity.set(l.c_velocity.v),l.m_angularVelocity=l.c_velocity.w,l.synchronizeTransform()}if(this.postSolveIsland(),i){var E=1/0,M=o.linearSleepToleranceSqr,S=o.angularSleepToleranceSqr;for(c=0;c<this.m_bodies.length;++c){(l=this.m_bodies[c]).isStatic()||(0==l.m_autoSleepFlag||l.m_angularVelocity*l.m_angularVelocity>S||a.lengthSquared(l.m_linearVelocity)>M?(l.m_sleepTime=0,E=0):(l.m_sleepTime+=s,E=u.min(E,l.m_sleepTime)))}if(E>=o.timeToSleep&&b)for(c=0;c<this.m_bodies.length;++c){(l=this.m_bodies[c]).setAwake(!1)}}},y.prototype.printBodies=function(t){for(var e=0;e<this.m_bodies.length;++e){var r=this.m_bodies[e];s.debug(t,r.c_position.a,r.c_position.c.x,r.c_position.c.y,r.c_velocity.w,r.c_velocity.v.x,r.c_velocity.v.y)}};var v=new d;y.prototype.solveWorldTOI=function(t){var e=this.m_world;if(e.m_stepComplete){for(var r=e.m_bodyList;r;r=r.m_next)r.m_islandFlag=!1,r.m_sweep.alpha0=0;for(var a=e.m_contactList;a;a=a.m_next)a.m_toiFlag=!1,a.m_islandFlag=!1,a.m_toiCount=0,a.m_toi=1}for(;;){var c=null,l=1;for(a=e.m_contactList;a;a=a.m_next)if(0!=a.isEnabled()&&!(a.m_toiCount>o.maxSubSteps)){var m=1;if(a.m_toiFlag)m=a.m_toi;else{var p=a.getFixtureA(),d=a.getFixtureB();if(p.isSensor()||d.isSensor())continue;var y=p.getBody(),b=d.getBody();i&&s.assert(y.isDynamic()||b.isDynamic());var g=y.isAwake()&&!y.isStatic(),x=b.isAwake()&&!b.isStatic();if(0==g&&0==x)continue;var A=y.isBullet()||!y.isDynamic(),w=b.isBullet()||!b.isDynamic();if(0==A&&0==w)continue;var B=y.m_sweep.alpha0;y.m_sweep.alpha0<b.m_sweep.alpha0?(B=b.m_sweep.alpha0,y.m_sweep.advance(B)):b.m_sweep.alpha0<y.m_sweep.alpha0&&(B=y.m_sweep.alpha0,b.m_sweep.advance(B)),i&&s.assert(B<1);var E=a.getChildIndexA(),M=a.getChildIndexB(),S=(y.m_sweep,b.m_sweep,new f);S.proxyA.set(p.getShape(),E),S.proxyB.set(d.getShape(),M),S.sweepA.set(y.m_sweep),S.sweepB.set(b.m_sweep),S.tMax=1;var T=new _;h(T,S);var I=T.t;m=T.state==_.e_touching?u.min(B+(1-B)*I,1):1,a.m_toi=m,a.m_toiFlag=!0}m<l&&(c=a,l=m)}if(null==c||1-10*u.EPSILON<l){e.m_stepComplete=!0;break}p=c.getFixtureA(),d=c.getFixtureB(),y=p.getBody(),b=d.getBody();var P=y.m_sweep.clone(),C=b.m_sweep.clone();if(y.advance(l),b.advance(l),c.update(e),c.m_toiFlag=!1,++c.m_toiCount,0!=c.isEnabled()&&0!=c.isTouching()){y.setAwake(!0),b.setAwake(!0),this.clear(),this.addBody(y),this.addBody(b),this.addContact(c),y.m_islandFlag=!0,b.m_islandFlag=!0,c.m_islandFlag=!0;for(var R=[y,b],F=0;F<R.length;++F){if((j=R[F]).isDynamic())for(var D=j.m_contactList;D;D=D.next){var L=D.contact;if(!L.m_islandFlag){var O=D.other;if(!O.isDynamic()||j.isBullet()||O.isBullet()){var k=L.m_fixtureA.m_isSensor,U=L.m_fixtureB.m_isSensor;if(!k&&!U){var z=O.m_sweep.clone();0==O.m_islandFlag&&O.advance(l),L.update(e),0!=L.isEnabled()&&0!=L.isTouching()?(L.m_islandFlag=!0,this.addContact(L),O.m_islandFlag||(O.m_islandFlag=!0,O.isStatic()||O.setAwake(!0),this.addBody(O))):(O.m_sweep.set(z),O.synchronizeTransform())}}}}}v.reset((1-l)*t.dt),v.dtRatio=1,v.positionIterations=20,v.velocityIterations=t.velocityIterations,v.warmStarting=!1,this.solveIslandTOI(v,y,b);for(F=0;F<this.m_bodies.length;++F){var j;if((j=this.m_bodies[F]).m_islandFlag=!1,j.isDynamic()){j.synchronizeFixtures();for(D=j.m_contactList;D;D=D.next)D.contact.m_toiFlag=!1,D.contact.m_islandFlag=!1}}if(e.findNewContacts(),e.m_subStepping){e.m_stepComplete=!1;break}}else c.setEnabled(!1),y.m_sweep.set(P),b.m_sweep.set(C),y.synchronizeTransform(),b.synchronizeTransform()}if(n)for(r=e.m_bodyList;r;r=r.m_next)a=r.m_sweep.c,r.m_sweep.a,r.m_linearVelocity,r.m_angularVelocity},y.prototype.solveIslandTOI=function(t,e,r){this.m_world;for(var n=0;n<this.m_bodies.length;++n){(m=this.m_bodies[n]).c_position.c.set(m.m_sweep.c),m.c_position.a=m.m_sweep.a,m.c_velocity.v.set(m.m_linearVelocity),m.c_velocity.w=m.m_angularVelocity}for(var n=0;n<this.m_contacts.length;++n){this.m_contacts[n].initConstraint(t)}for(n=0;n<t.positionIterations;++n){for(var i=0,s=0;s<this.m_contacts.length;++s){var c=this.m_contacts[s].solvePositionConstraintTOI(t,e,r);i=u.min(i,c)}if(i>=-1.5*o.linearSlop)break}e.m_sweep.c0.set(e.c_position.c),e.m_sweep.a0=e.c_position.a,r.m_sweep.c0.set(r.c_position.c),r.m_sweep.a0=r.c_position.a;for(n=0;n<this.m_contacts.length;++n){this.m_contacts[n].initVelocityConstraint(t)}for(n=0;n<t.velocityIterations;++n)for(s=0;s<this.m_contacts.length;++s){this.m_contacts[s].solveVelocityConstraint(t)}var l=t.dt;for(n=0;n<this.m_bodies.length;++n){var m=this.m_bodies[n],h=a.clone(m.c_position.c),f=m.c_position.a,_=a.clone(m.c_velocity.v),p=m.c_velocity.w,d=a.mul(l,_);if(a.dot(d,d)>o.maxTranslationSquared){var y=o.maxTranslation/d.length();_.mul(y)}var v=l*p;if(v*v>o.maxRotationSquared)p*=y=o.maxRotation/u.abs(v);h.wAdd(l,_),f+=l*p,m.c_position.c=h,m.c_position.a=f,m.c_velocity.v=_,m.c_velocity.w=p,m.m_sweep.c=h,m.m_sweep.a=f,m.m_linearVelocity=_,m.m_angularVelocity=p,m.synchronizeTransform()}this.postSolveIsland()},y.prototype.postSolveIsland=function(){for(var t=new function(){this.normalImpulses=[],this.tangentImpulses=[]},e=0;e<this.m_contacts.length;++e){for(var r=this.m_contacts[e],n=0;n<r.v_points.length;++n)t.normalImpulses.push(r.v_points[n].normalImpulse),t.tangentImpulses.push(r.v_points[n].tangentImpulse);this.m_world.postSolve(r,t)}}},function(t,e){"undefined"!=typeof DEBUG&&DEBUG,"undefined"!=typeof ASSERT&&ASSERT;t.exports=function(t){var e=[],r=t.max||1/0,n=t.create,i=t.allocate,o=t.release,s=t.discard,a=0,u=0,c=0,l=0;this.max=function(t){return"number"==typeof t?(r=t,this):r},this.size=function(){return e.length},this.allocate=function(){var t;return e.length>0?t=e.shift():(a++,t="function"==typeof n?n():{}),u++,"function"==typeof i&&i(t),t},this.release=function(t){e.length<r?(c++,"function"==typeof o&&o(t),e.push(t)):(l++,"function"==typeof s&&(t=s(t)))},this.toString=function(){return" +"+a+" >"+u+" <"+c+" -"+l+" ="+e.length+"/"+r}}},function(t,e,r){"undefined"!=typeof DEBUG&&DEBUG;var n="undefined"!=typeof ASSERT&&ASSERT,i=(r(13),r(7)),o=r(4),s=r(62),a=r(178);function u(){this.m_tree=new a,this.m_proxyCount=0,this.m_moveBuffer=[],this.queryCallback=this.queryCallback.bind(this)}t.exports=u,u.prototype.getUserData=function(t){return this.m_tree.getUserData(t)},u.prototype.testOverlap=function(t,e){var r=this.m_tree.getFatAABB(t),n=this.m_tree.getFatAABB(e);return s.testOverlap(r,n)},u.prototype.getFatAABB=function(t){return this.m_tree.getFatAABB(t)},u.prototype.getProxyCount=function(){return this.m_proxyCount},u.prototype.getTreeHeight=function(){return this.m_tree.getHeight()},u.prototype.getTreeBalance=function(){return this.m_tree.getMaxBalance()},u.prototype.getTreeQuality=function(){return this.m_tree.getAreaRatio()},u.prototype.query=function(t,e){this.m_tree.query(t,e)},u.prototype.rayCast=function(t,e){this.m_tree.rayCast(t,e)},u.prototype.shiftOrigin=function(t){this.m_tree.shiftOrigin(t)},u.prototype.createProxy=function(t,e){n&&i.assert(s.isValid(t));var r=this.m_tree.createProxy(t,e);return this.m_proxyCount++,this.bufferMove(r),r},u.prototype.destroyProxy=function(t){this.unbufferMove(t),this.m_proxyCount--,this.m_tree.destroyProxy(t)},u.prototype.moveProxy=function(t,e,r){n&&i.assert(s.isValid(e)),this.m_tree.moveProxy(t,e,r)&&this.bufferMove(t)},u.prototype.touchProxy=function(t){this.bufferMove(t)},u.prototype.bufferMove=function(t){this.m_moveBuffer.push(t)},u.prototype.unbufferMove=function(t){for(var e=0;e<this.m_moveBuffer.length;++e)this.m_moveBuffer[e]==t&&(this.m_moveBuffer[e]=null)},u.prototype.updatePairs=function(t){for(n&&i.assert("function"==typeof t),this.m_callback=t;this.m_moveBuffer.length>0;)if(this.m_queryProxyId=this.m_moveBuffer.pop(),null!==this.m_queryProxyId){var e=this.m_tree.getFatAABB(this.m_queryProxyId);this.m_tree.query(e,this.queryCallback)}},u.prototype.queryCallback=function(t){if(t==this.m_queryProxyId)return!0;var e=o.min(t,this.m_queryProxyId),r=o.max(t,this.m_queryProxyId),n=this.m_tree.getUserData(e),i=this.m_tree.getUserData(r);return this.m_callback(n,i),!0}},function(t,e,r){"use strict";r(2);var n=function(t){if(t&&t.__esModule)return t;var e={};if(null!=t)for(var r in t)if(Object.prototype.hasOwnProperty.call(t,r)){var n=Object.defineProperty&&Object.getOwnPropertyDescriptor?Object.getOwnPropertyDescriptor(t,r):{};n.get||n.set?Object.defineProperty(e,r,n):e[r]=t[r]}return e.default=t,e}(r(181)),i=r(39),o=(r(51),r(100)),s=r(18),a=r(17),u=r(241);function c(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){l(t,e,r[e])})}return t}function l(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function m(t,e,r,n,i,o,s){try{var a=t[o](s),u=a.value}catch(t){return void r(t)}a.done?e(u):Promise.resolve(u).then(n,i)}r(32);var h=new i.App({el:(0,i.initCanvas)("content","game"),debug:!1,clearColor:[.1,.1,.1,1],resolution:{width:1400,height:728},pixelMultiplier:1}),f=(new o.CameraPan(h),10);var _=n.default.World((0,n.Vec2)(0,-10)),p=_.createBody();function d(){return(d=function(t){return function(){var e=this,r=arguments;return new Promise(function(n,i){var o=t.apply(e,r);function s(t){m(o,n,i,s,a,"next",t)}function a(t){m(o,n,i,s,a,"throw",t)}s(void 0)})}}(regeneratorRuntime.mark(function t(){var e,r;return regeneratorRuntime.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,h.loader.loading;case 2:e=new s.SpriteRenderer({game:h,textureInfo:c({texture:h.framebuffer.texture},h.resolution)}),r=new u.WorldRenderer({game:h,pixelScale:f}),h.camera.centerAt(0,0),requestAnimationFrame(function t(){_.step(1/60,void 0,20),h.adjustViewport(),h.clear(),h.framebuffer.attach(),h.clear(),h.enableCamera(),r.render(_,h.viewMatrix),h.framebuffer.detach(),h.disableCamera(),h.adjustViewport(),e.render([new a.Sprite({position:[0,0],size:[h.resolution.width,h.resolution.height]})],h.projection),requestAnimationFrame(t)});case 6:case"end":return t.stop()}},t,this)}))).apply(this,arguments)}p.createFixture(n.default.Chain([(0,n.Vec2)(-50,-50),(0,n.Vec2)(50,-50),(0,n.Vec2)(50,50),(0,n.Vec2)(-50,50)],!0)),function(){var t=_.createBody().setDynamic();t.createFixture(n.default.Box(.5,.5)),t.setPosition((0,n.Vec2)(2,10)),t.setAngle(10),t.setAngularVelocity(1),t.setMassData({mass:1,center:(0,n.Vec2)(),I:1}),(t=_.createBody().setDynamic()).createFixture(n.default.Box(1,1)),t.setPosition((0,n.Vec2)(0,-5)),t.setAngularVelocity(-500),t.setMassData({mass:1,center:(0,n.Vec2)(),I:1}),(t=_.createBody().setDynamic()).createFixture(n.default.Box(1,1)),t.setPosition((0,n.Vec2)(8,10)),t.setAngularVelocity(2),t.setMassData({mass:1,center:(0,n.Vec2)(),I:1});var e=_.createBody().setDynamic();e.createFixture(n.default.Circle(3),{friction:1,density:.5,linearVelocityDampingRatio:.5}),e.setPosition((0,n.Vec2)(0,-5)),e.setMassData({mass:10,center:(0,n.Vec2)(),I:1});var r=function(t){var e=t.endpointA,r=t.endpointB,i=t.segmentLength||5,o=t.thickness||.25,s=t.chainLength||n.Vec2.distance(e,r),a=Math.ceil(s/i),u=r.clone().sub(e);u.normalize(),Math.atan(u.y/u.x);for(var c=[],l=[],m=n.Vec2.distance(e,r)>0,h=0;h<a;h++){var f=_.createBody().setDynamic();f.createFixture(n.default.Box(i/2,o/2),{density:1}),f.resetMassData(),m?f.setPosition(n.Vec2.add(e,u.clone().mul(h*i).add(n.Vec2.mul(u,i/2)))):f.setPosition(e),c.push(f)}for(var p={localAnchorA:(0,n.Vec2)(3*i/8,0),localAnchorB:(0,n.Vec2)(3*-i/8,0),frequency:0,dampingRatio:0,maxLength:i/4},d=1;d<c.length;d++){var y=c[d-1],v=c[d];l.push(_.createJoint(n.default.RopeJoint(p,y,v)))}return{segments:c,joints:l}}({endpointA:(0,n.Vec2)(0,0),endpointB:(0,n.Vec2)(0,0),chainLength:20,segmentLength:1});_.createJoint(n.default.RevoluteJoint({collideConnected:!1,localAnchorA:(0,n.Vec2)(3,0),localAnchorB:(0,n.Vec2)(-.5,0)},e,r.segments[0])),_.createJoint(n.default.RevoluteJoint({collideConnected:!1,localAnchorA:(0,n.Vec2)(.5,0),localAnchorB:(0,n.Vec2)(0,0)},r.segments[r.segments.length-1],p))}(),function(){d.apply(this,arguments)}()}]);
//# sourceMappingURL=physics.bundle.js.map